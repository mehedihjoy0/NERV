From 6f46f7c537c8af87cb49f05271cb4a8fea2b97ea Mon Sep 17 00:00:00 2001
From: Salvo Giangreco <giangrecosalvo9@gmail.com>
Date: Fri, 13 Sep 2024 22:46:36 +0200
Subject: [PATCH] Nuke Knox DualDAR

---
 .../server/am/ActivityManagerService.smali    |  217 +-
 smali/com/android/server/am/ProcessList.smali |  165 +-
 .../android/server/am/UserController.smali    |  454 +--
 .../DevicePolicyManagerService.smali          |  164 +-
 .../DualDarProvisioningHelper$1.smali         |   20 -
 .../DualDarProvisioningHelper$2.smali         |  166 -
 .../DualDarProvisioningHelper$3.smali         |   20 -
 .../DualDarProvisioningHelper$4.smali         |  145 -
 .../DualDarProvisioningHelper.smali           | 1353 +-------
 .../EnterpriseDeviceManagerServiceImpl.smali  |  367 +--
 .../container/KnoxMUMContainerPolicy.smali    |  110 +-
 .../enterprise/security/PasswordPolicy.smali  |    4 +-
 .../server/knox/dar/DarManagerService.smali   |   32 -
 .../server/knox/dar/ddar/DDLog$Logger$2.smali |   12 -
 .../server/knox/dar/ddar/DDLog$Logger.smali   |  158 -
 .../knox/dar/ddar/DDLog$LoggerProxy.smali     |   61 -
 .../android/server/knox/dar/ddar/DDLog.smali  |   36 -
 .../core/DualDarManagerImpl$Injector.smali    |   12 -
 .../dar/ddar/core/DualDarManagerImpl.smali    |   12 -
 .../dar/ddar/core/DualDarManagerProxy.smali   |   65 -
 .../knox/dar/ddar/fsm/StateMachineImpl.smali  |   77 -
 .../knox/dar/ddar/fsm/StateMachineProxy.smali |   65 -
 .../dar/ddar/proxy/DualDARComnService.smali   |  179 +-
 .../dar/ddar/proxy/DualDARPlatformProxy.smali |   82 +-
 .../dar/ddar/proxy/SystemProxyAgent.smali     |   78 -
 .../server/knox/dar/ddar/ta/TAProxy.smali     |   67 -
 .../android/server/knox/dar/sdp/SDPLog.smali  |   12 -
 ...gsService$$ExternalSyntheticLambda10.smali |   26 +-
 ...gsService$$ExternalSyntheticLambda11.smali |   16 +-
 ...gsService$$ExternalSyntheticLambda12.smali |    2 +-
 ...gsService$$ExternalSyntheticLambda13.smali |    2 +-
 ...gsService$$ExternalSyntheticLambda14.smali |   16 +-
 ...gsService$$ExternalSyntheticLambda15.smali |   16 +-
 ...gsService$$ExternalSyntheticLambda16.smali |   20 +-
 ...gsService$$ExternalSyntheticLambda17.smali |   20 +-
 ...gsService$$ExternalSyntheticLambda18.smali |   40 -
 ...ngsService$$ExternalSyntheticLambda4.smali |   10 +-
 ...ngsService$$ExternalSyntheticLambda5.smali |   30 +-
 ...ngsService$$ExternalSyntheticLambda6.smali |   16 +-
 ...ngsService$$ExternalSyntheticLambda7.smali |    2 +-
 ...ngsService$$ExternalSyntheticLambda8.smali |   18 +-
 ...ngsService$$ExternalSyntheticLambda9.smali |   22 +-
 .../locksettings/LockSettingsService$3.smali  |  129 +-
 .../LockSettingsService$DarLockSettings.smali |  138 -
 .../LockSettingsService$DarVirtualLock.smali  | 1225 +------
 ...kSettingsService$DualDarLockSettings.smali | 1226 +------
 .../LockSettingsService$Injector$1.smali      |    2 +-
 .../LockSettingsService$Injector.smali        |   10 -
 ...$Lifecycle$$ExternalSyntheticLambda1.smali |   28 -
 .../LockSettingsService$Lifecycle.smali       |   43 +-
 .../locksettings/LockSettingsService.smali    | 2887 +++++------------
 .../LockSettingsShellCommand.smali            |   27 +-
 .../LockSettingsStorage$DatabaseHelper.smali  |    2 +-
 .../locksettings/LockSettingsStorage.smali    |  163 +-
 ...dManager$SdpSyntheticPasswordManager.smali |   44 +-
 .../SyntheticPasswordManager.smali            |  257 +-
 .../locksettings/SyntheticPasswordMdfpp.smali |   47 -
 .../android/server/pm/ComputerEngine.smali    |   67 +-
 ...viceHelper$$ExternalSyntheticLambda0.smali |    2 +-
 ...viceHelper$$ExternalSyntheticLambda1.smali |    2 +-
 ...viceHelper$$ExternalSyntheticLambda2.smali |    2 +-
 ...viceHelper$$ExternalSyntheticLambda3.smali |   36 -
 ...viceHelper$$ExternalSyntheticLambda4.smali |   38 -
 ...viceHelper$$ExternalSyntheticLambda5.smali |   38 -
 ...viceHelper$$ExternalSyntheticLambda6.smali |   36 -
 .../server/pm/PersonaServiceHelper.smali      |  909 +-----
 .../pm/UserManagerService$LocalService.smali  |   40 +-
 .../server/pm/UserManagerService.smali        | 1482 +++------
 .../server/trust/TrustManagerService$1.smali  |  156 +-
 .../server/trust/TrustManagerService$2.smali  |   16 +-
 .../server/trust/TrustManagerService.smali    |  542 +---
 71 files changed, 2026 insertions(+), 11957 deletions(-)
 delete mode 100644 smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$2.smali
 delete mode 100644 smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$4.smali
 delete mode 100644 smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18.smali
 delete mode 100644 smali_classes2/com/android/server/locksettings/LockSettingsService$Lifecycle$$ExternalSyntheticLambda1.smali
 delete mode 100644 smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali
 delete mode 100644 smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali
 delete mode 100644 smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda5.smali
 delete mode 100644 smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda6.smali

diff --git a/smali/com/android/server/am/ActivityManagerService.smali b/smali/com/android/server/am/ActivityManagerService.smali
index bbcb9a2d..efc53f23 100644
--- a/smali/com/android/server/am/ActivityManagerService.smali
+++ b/smali/com/android/server/am/ActivityManagerService.smali
@@ -38181,46 +38181,6 @@
     throw p0
 .end method
 
-.method public final ensureAgentBinding()V
-    .locals 2
-
-    const-class v0, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManagerInternal;
-
-    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManagerInternal;
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    const-string v1, "KNOXCORE_PROXY_AGENT"
-
-    invoke-virtual {v0, v1}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManagerInternal;->ensureProxyAgentBindingIfRequired(Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
-
-    move-result-object p0
-
-    const/4 v1, 0x0
-
-    invoke-virtual {p0, v1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getClientPackage(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_1
-
-    invoke-virtual {v0, p0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManagerInternal;->ensureProxyAgentBindingIfRequired(Ljava/lang/String;)V
-
-    :cond_1
-    return-void
-.end method
-
 .method public final ensureAllowedAssociations()V
     .locals 8
 
@@ -39661,7 +39621,7 @@
 
     monitor-exit p0
     :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_2
+    .catchall {:try_start_0 .. :try_end_0} :catchall_1
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
@@ -39673,7 +39633,7 @@
 
     monitor-exit p0
     :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_2
+    .catchall {:try_start_1 .. :try_end_1} :catchall_1
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
@@ -39754,12 +39714,6 @@
 
     invoke-virtual {v1}, Lcom/android/server/wm/ActivityTaskManagerService;->initActivityManagerPerformance()V
 
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_4
-
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->boostPriorityForLockedSection()V
 
     monitor-enter p0
@@ -39781,111 +39735,8 @@
 
     move v7, v3
 
-    move v8, v7
-
     :goto_1
-    if-ge v7, v1, :cond_3
-
-    const-string v9, "com.samsung.android.knox.containercore"
-
-    invoke-virtual {v6, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v10
-
-    check-cast v10, Lcom/android/server/am/ProcessRecord;
-
-    iget-object v10, v10, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;
-
-    invoke-virtual {v9, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v9
-
-    if-eqz v9, :cond_1
-
-    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mProcessList:Lcom/android/server/am/ProcessList;
-
-    invoke-virtual {v6, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
-
-    move-result-object v9
-
-    check-cast v9, Lcom/android/server/am/ProcessRecord;
-
-    new-instance v10, Lcom/android/server/am/HostingRecord;
-
-    const-string/jumbo v11, "on-hold"
-
-    invoke-direct {v10, v11}, Lcom/android/server/am/HostingRecord;-><init>(Ljava/lang/String;)V
-
-    invoke-virtual {v8, v9, v10, v2}, Lcom/android/server/am/ProcessList;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HostingRecord;I)V
-
-    move v8, v5
-
-    :cond_1
-    add-int/lit8 v7, v7, 0x1
-
-    goto :goto_1
-
-    :cond_2
-    move v8, v3
-
-    :cond_3
-    monitor-exit p0
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
-
-    if-eqz v8, :cond_4
-
-    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->ensureAgentBinding()V
-
-    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->ensureDataUnlockedIfRequired()V
-
-    goto :goto_2
-
-    :catchall_0
-    move-exception v0
-
-    :try_start_4
-    monitor-exit p0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_0
-
-    invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
-
-    throw v0
-
-    :cond_4
-    :goto_2
-    invoke-static {}, Lcom/android/server/am/ActivityManagerService;->boostPriorityForLockedSection()V
-
-    monitor-enter p0
-
-    :try_start_5
-    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;
-
-    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I
-
-    move-result v1
-
-    if-lez v1, :cond_6
-
-    new-instance v6, Ljava/util/ArrayList;
-
-    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;
-
-    invoke-direct {v6, v7}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
-
-    move v7, v3
-
-    :goto_3
-    if-ge v7, v1, :cond_6
+    if-ge v7, v1, :cond_2
 
     invoke-virtual {v6, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
@@ -39909,7 +39760,7 @@
 
     move-result v8
 
-    if-eqz v8, :cond_5
+    if-eqz v8, :cond_1
 
     const-string v8, "ActivityManager"
 
@@ -39949,7 +39800,7 @@
 
     invoke-virtual {v8}, Lcom/android/server/wm/WindowProcessController;->updateGlobalConfiguration()V
 
-    :cond_5
+    :cond_1
     iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mProcessList:Lcom/android/server/am/ProcessList;
 
     invoke-virtual {v6, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
@@ -39968,23 +39819,23 @@
 
     add-int/lit8 v7, v7, 0x1
 
-    goto :goto_3
+    goto :goto_1
 
-    :cond_6
+    :cond_2
     iget v1, p0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I
 
-    if-ne v1, v5, :cond_7
+    if-ne v1, v5, :cond_3
 
     monitor-exit p0
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
     return-void
 
-    :cond_7
-    :try_start_6
+    :cond_3
+    :try_start_4
     iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$MainHandler;
 
     const/16 v6, 0x1b
@@ -40017,11 +39868,11 @@
 
     move-result v1
 
-    if-eqz v1, :cond_8
+    if-eqz v1, :cond_4
 
     invoke-static {}, Lcom/android/server/UserspaceRebootLogger;->noteUserspaceRebootSuccess()V
 
-    :cond_8
+    :cond_4
     const-string/jumbo v1, "sys.boot_completed"
 
     const-string v6, "1"
@@ -40050,7 +39901,7 @@
 
     sget-boolean v1, Lcom/samsung/android/rune/CoreRune;->MNO_TMO_DEVICE_REPORTING:Z
 
-    if-eqz v1, :cond_9
+    if-eqz v1, :cond_5
 
     const-string v1, "ActivityManager"
 
@@ -40072,10 +39923,10 @@
 
     invoke-static {v6, v1}, Lcom/android/server/am/AppStateBroadcaster;->enableIntentBroadcast(Landroid/content/Context;Lcom/android/internal/app/ProcessMap;)V
 
-    :cond_9
+    :cond_5
     monitor-exit p0
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_1
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_0
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
@@ -40133,17 +39984,17 @@
 
     move-result v1
 
-    if-ne v1, v5, :cond_a
+    if-ne v1, v5, :cond_6
 
     move v1, v5
 
-    goto :goto_4
+    goto :goto_2
 
-    :cond_a
+    :cond_6
     move v1, v3
 
-    :goto_4
-    if-nez v1, :cond_b
+    :goto_2
+    if-nez v1, :cond_7
 
     new-instance v1, Lcom/samsung/android/fontutil/FlipFontOptimizer;
 
@@ -40163,7 +40014,7 @@
 
     invoke-static {v1, v6, v5}, Landroid/provider/Settings$Secure;->putInt(Landroid/content/ContentResolver;Ljava/lang/String;I)Z
 
-    :cond_b
+    :cond_7
     const-string v1, "ActivityManager"
 
     const-string v5, "!@Boot: bootcomplete"
@@ -40230,7 +40081,7 @@
 
     sget-boolean v1, Lcom/samsung/android/rune/CoreRune;->FW_APPLOCK:Z
 
-    if-eqz v1, :cond_c
+    if-eqz v1, :cond_8
 
     iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Lcom/android/server/am/ActivityManagerService$MainHandler;
 
@@ -40240,30 +40091,30 @@
 
     invoke-virtual {v1, v2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :cond_c
+    :cond_8
     invoke-virtual {v0}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     return-void
 
-    :catchall_1
+    :catchall_0
     move-exception v0
 
-    :try_start_7
+    :try_start_5
     monitor-exit p0
-    :try_end_7
-    .catchall {:try_start_7 .. :try_end_7} :catchall_1
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_0
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
     throw v0
 
-    :catchall_2
+    :catchall_1
     move-exception v0
 
-    :try_start_8
+    :try_start_6
     monitor-exit p0
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_2
+    :try_end_6
+    .catchall {:try_start_6 .. :try_end_6} :catchall_1
 
     invoke-static {}, Lcom/android/server/am/ActivityManagerService;->resetPriorityAfterLockedSection()V
 
diff --git a/smali/com/android/server/am/ProcessList.smali b/smali/com/android/server/am/ProcessList.smali
index 5b404a91..634f075d 100644
--- a/smali/com/android/server/am/ProcessList.smali
+++ b/smali/com/android/server/am/ProcessList.smali
@@ -15968,7 +15968,7 @@
 
     move-result v1
     :try_end_0
-    .catch Ljava/lang/RuntimeException; {:try_start_0 .. :try_end_0} :catch_7
+    .catch Ljava/lang/RuntimeException; {:try_start_0 .. :try_end_0} :catch_6
 
     :try_start_1
     invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
@@ -15981,15 +15981,15 @@
 
     invoke-interface {v3, v4, v1}, Landroid/content/pm/IPackageManager;->checkPackageStartable(Ljava/lang/String;I)V
     :try_end_1
-    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_5
-    .catch Ljava/lang/RuntimeException; {:try_start_1 .. :try_end_1} :catch_7
+    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_4
+    .catch Ljava/lang/RuntimeException; {:try_start_1 .. :try_end_1} :catch_6
 
     :try_start_2
     iget v3, v15, Lcom/android/server/am/ProcessRecord;->uid:I
 
     iget-boolean v4, v15, Lcom/android/server/am/ProcessRecord;->isolated:Z
     :try_end_2
-    .catch Ljava/lang/RuntimeException; {:try_start_2 .. :try_end_2} :catch_7
+    .catch Ljava/lang/RuntimeException; {:try_start_2 .. :try_end_2} :catch_6
 
     if-nez v4, :cond_7
 
@@ -16049,7 +16049,7 @@
     const-string v9, "android.permission.INSTALL_PACKAGES"
     :try_end_3
     .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0
-    .catch Ljava/lang/RuntimeException; {:try_start_3 .. :try_end_3} :catch_7
+    .catch Ljava/lang/RuntimeException; {:try_start_3 .. :try_end_3} :catch_6
 
     :try_start_4
     iget-object v11, v15, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
@@ -16118,7 +16118,7 @@
     invoke-virtual {v4, v2}, Lcom/android/server/am/ProcessCachedOptimizerRecord;->setFreezeExempt(Z)V
     :try_end_4
     .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_0
-    .catch Ljava/lang/RuntimeException; {:try_start_4 .. :try_end_4} :catch_4
+    .catch Ljava/lang/RuntimeException; {:try_start_4 .. :try_end_4} :catch_3
 
     :cond_4
     :try_start_5
@@ -16408,7 +16408,7 @@
 
     move-result v6
     :try_end_5
-    .catch Ljava/lang/RuntimeException; {:try_start_5 .. :try_end_5} :catch_4
+    .catch Ljava/lang/RuntimeException; {:try_start_5 .. :try_end_5} :catch_3
 
     const-string/jumbo v8, "true"
 
@@ -16659,7 +16659,7 @@
 
     move-result-object v3
     :try_end_6
-    .catch Ljava/lang/RuntimeException; {:try_start_6 .. :try_end_6} :catch_4
+    .catch Ljava/lang/RuntimeException; {:try_start_6 .. :try_end_6} :catch_3
 
     :try_start_7
     new-instance v6, Ljava/io/File;
@@ -16726,7 +16726,7 @@
 
     sget-object v3, Landroid/os/Build;->SUPPORTED_ABIS:[Ljava/lang/String;
     :try_end_8
-    .catch Ljava/lang/RuntimeException; {:try_start_8 .. :try_end_8} :catch_4
+    .catch Ljava/lang/RuntimeException; {:try_start_8 .. :try_end_8} :catch_3
 
     const/4 v6, 0x0
 
@@ -16745,7 +16745,7 @@
     :goto_c
     move-object/from16 v22, v10
 
-    goto/16 :goto_14
+    goto/16 :goto_12
 
     :cond_22
     :goto_d
@@ -16913,143 +16913,36 @@
 
     array-length v3, v2
     :try_end_a
-    .catch Ljava/lang/RuntimeException; {:try_start_a .. :try_end_a} :catch_4
+    .catch Ljava/lang/RuntimeException; {:try_start_a .. :try_end_a} :catch_3
 
-    const/4 v4, 0x0
+    const/4 v8, 0x0
 
     :try_start_b
-    invoke-static {v2, v4, v1, v4, v3}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
+    invoke-static {v2, v8, v1, v8, v3}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
 
     array-length v2, v2
 
-    invoke-static {v4}, Landroid/os/UserHandle;->getUserGid(I)I
+    invoke-static {v8}, Landroid/os/UserHandle;->getUserGid(I)I
 
     move-result v3
-    :try_end_b
-    .catch Ljava/lang/RuntimeException; {:try_start_b .. :try_end_b} :catch_2
 
-    :try_start_c
     aput v3, v1, v2
 
     invoke-virtual {v15, v1}, Lcom/android/server/am/ProcessRecord;->setGids([I)V
 
-    move-object v2, v1
+    move-object v6, v1
 
     goto :goto_11
 
-    :catch_2
-    move-exception v0
-
-    move/from16 v19, v4
-
-    goto/16 :goto_c
-
     :cond_27
-    :goto_11
-    iget v1, v15, Lcom/android/server/am/ProcessRecord;->userId:I
-
-    invoke-static {v1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_29
-
-    iget v1, v15, Lcom/android/server/am/ProcessRecord;->userId:I
-
-    invoke-static {v1}, Lcom/android/server/pm/PersonaServiceHelper;->isDERestrictionEnforced(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_29
-
-    iget-object v1, v14, Lcom/android/server/am/ProcessList;->mService:Lcom/android/server/am/ActivityManagerService;
-
-    iget-object v1, v1, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;
-
-    iget-object v3, v15, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
-
-    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
-
-    iget v4, v15, Lcom/android/server/am/ProcessRecord;->userId:I
-
-    invoke-static {v1, v3, v4}, Lcom/android/server/pm/PersonaServiceHelper;->isPackageAllowlistedForDEAccessForDualDAR(Landroid/content/Context;Ljava/lang/String;I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_29
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v3, "DE Restriction for package "
-
-    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    iget-object v3, v15, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
-
-    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
-
-    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v10, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    if-nez v2, :cond_28
-
-    const/4 v1, 0x1
-
-    new-array v2, v1, [I
-
-    const/4 v8, 0x0
-
-    goto :goto_12
-
-    :cond_28
-    const/4 v1, 0x1
-
-    array-length v3, v2
-
-    add-int/2addr v3, v1
-
-    new-array v3, v3, [I
-
-    array-length v4, v2
-    :try_end_c
-    .catch Ljava/lang/RuntimeException; {:try_start_c .. :try_end_c} :catch_4
-
     const/4 v8, 0x0
 
-    :try_start_d
-    invoke-static {v2, v8, v3, v8, v4}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
-
-    move-object v2, v3
-
-    :goto_12
-    array-length v3, v2
-
-    sub-int/2addr v3, v1
-
-    const/16 v1, 0x14b4
-
-    aput v1, v2, v3
-
-    invoke-virtual {v15, v2}, Lcom/android/server/am/ProcessRecord;->setGids([I)V
-
-    goto :goto_13
-
-    :cond_29
-    const/4 v8, 0x0
-
-    :goto_13
     move-object v6, v2
 
+    :goto_11
     const-string v3, "android.app.ActivityThread"
-    :try_end_d
-    .catch Ljava/lang/RuntimeException; {:try_start_d .. :try_end_d} :catch_3
+    :try_end_b
+    .catch Ljava/lang/RuntimeException; {:try_start_b .. :try_end_b} :catch_2
 
     move-object/from16 v1, p0
 
@@ -17075,30 +16968,30 @@
 
     move-wide/from16 v14, v20
 
-    :try_start_e
+    :try_start_c
     invoke-virtual/range {v1 .. v17}, Lcom/android/server/am/ProcessList;->startProcessLocked(Lcom/android/server/am/HostingRecord;Ljava/lang/String;Lcom/android/server/am/ProcessRecord;I[IIIILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;JJ)Z
 
     move-result v0
 
     return v0
 
-    :catch_3
+    :catch_2
     move-exception v0
 
     move/from16 v19, v8
 
     goto/16 :goto_c
 
-    :catch_4
+    :catch_3
     move-exception v0
 
     move-object/from16 v22, v10
 
     const/16 v19, 0x0
 
-    goto :goto_14
+    goto :goto_12
 
-    :catch_5
+    :catch_4
     move-exception v0
 
     move-object/from16 v22, v10
@@ -17110,22 +17003,22 @@
     move-result-object v0
 
     throw v0
-    :try_end_e
-    .catch Ljava/lang/RuntimeException; {:try_start_e .. :try_end_e} :catch_6
+    :try_end_c
+    .catch Ljava/lang/RuntimeException; {:try_start_c .. :try_end_c} :catch_5
 
-    :catch_6
+    :catch_5
     move-exception v0
 
-    goto :goto_14
+    goto :goto_12
 
-    :catch_7
+    :catch_6
     move-exception v0
 
     move-object/from16 v22, v10
 
     move/from16 v19, v11
 
-    :goto_14
+    :goto_12
     new-instance v1, Ljava/lang/StringBuilder;
 
     invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
diff --git a/smali/com/android/server/am/UserController.smali b/smali/com/android/server/am/UserController.smali
index 0d6d2c97..7b4740fc 100644
--- a/smali/com/android/server/am/UserController.smali
+++ b/smali/com/android/server/am/UserController.smali
@@ -3206,69 +3206,6 @@
     return-object p0
 .end method
 
-.method public final fetchOuterLayerKey(I)[B
-    .locals 4
-
-    const/4 v0, 0x0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    const-string v2, "ActivityManager"
-
-    const-string v3, "fetchOuterLayerKey()"
-
-    invoke-static {v2, v3, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    invoke-virtual {p0}, Lcom/android/server/am/UserController$Injector;->getContext()Landroid/content/Context;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->fetchOuterLayerKey(I)[B
-
-    move-result-object p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "Exception in fetchOuterLayerKey() : "
-
-    invoke-virtual {p1, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v0, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    const/4 p0, 0x0
-
-    :goto_0
-    return-object p0
-.end method
-
 .method public final finishUserBoot(Lcom/android/server/am/UserState;)V
     .locals 1
 
@@ -3483,7 +3420,7 @@
 
     move-result p2
 
-    if-eqz p2, :cond_7
+    if-eqz p2, :cond_6
 
     iget-object p2, p0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
@@ -3495,7 +3432,7 @@
 
     move-result-object p2
 
-    if-eqz p2, :cond_5
+    if-eqz p2, :cond_4
 
     iget v1, p2, Landroid/content/pm/UserInfo;->id:I
 
@@ -3503,7 +3440,7 @@
 
     move-result v1
 
-    if-eqz v1, :cond_5
+    if-eqz v1, :cond_4
 
     const-string v1, "ActivityManager"
 
@@ -3521,45 +3458,32 @@
 
     invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget v3, p2, Landroid/content/pm/UserInfo;->id:I
+    iget p2, p2, Landroid/content/pm/UserInfo;->id:I
 
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v3, "): attempting unlock because parent is unlocked"
+    const-string p2, "): attempting unlock because parent is unlocked"
 
-    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
-
-    invoke-static {v1, v2}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-static {v0}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_4
-
-    iget p2, p2, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-virtual {p0, v0, p2}, Lcom/android/server/am/UserController;->maybeUnlockDualDARUser(II)Z
+    move-result-object p2
 
-    goto :goto_1
+    invoke-static {v1, p2}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_4
     invoke-virtual {p0, v0}, Lcom/android/server/am/UserController;->maybeUnlockUser(I)Z
 
     goto :goto_1
 
-    :cond_5
-    if-nez p2, :cond_6
+    :cond_4
+    if-nez p2, :cond_5
 
     const-string p2, "<null>"
 
     goto :goto_0
 
-    :cond_6
+    :cond_5
     iget p2, p2, Landroid/content/pm/UserInfo;->id:I
 
     invoke-static {p2}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
@@ -3597,7 +3521,7 @@
 
     goto :goto_1
 
-    :cond_7
+    :cond_6
     invoke-virtual {p0, v0}, Lcom/android/server/am/UserController;->maybeUnlockUser(I)Z
 
     :goto_1
@@ -3930,31 +3854,12 @@
 
     if-eqz p1, :cond_b
 
-    iget-object v1, p0, Lcom/android/server/am/UserController;->mHandler:Landroid/os/Handler;
+    iget-object p0, p0, Lcom/android/server/am/UserController;->mHandler:Landroid/os/Handler;
 
-    invoke-virtual {v1, p2, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
+    invoke-virtual {p0, p2, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V
 
     :cond_b
     :goto_3
-    invoke-static {v0}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_c
-
-    iget-object p0, p0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    invoke-virtual {p0}, Lcom/android/server/am/UserController$Injector;->getContext()Landroid/content/Context;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    invoke-virtual {p0, v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onUserStopped(I)V
-
-    :cond_c
     return-void
 
     :catchall_0
@@ -7462,184 +7367,6 @@
     return-void
 .end method
 
-.method public final maybeUnlockDualDARUser(II)Z
-    .locals 5
-
-    iget-object v0, p0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    invoke-virtual {v0}, Lcom/android/server/am/UserController$Injector;->getKeyguardManager()Landroid/app/KeyguardManager;
-
-    move-result-object v0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/am/UserController;->fetchOuterLayerKey(I)[B
-
-    move-result-object v1
-
-    const-string v2, "ActivityManager"
-
-    const/4 v3, 0x0
-
-    if-eqz v1, :cond_3
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "Trying to unlock DualDAR user after userStart "
-
-    invoke-virtual {p2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    new-array v1, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, p2, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sget-object p2, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    move-result-object v1
-
-    sget-object v4, Lcom/samsung/android/knox/dar/ddar/fsm/State;->DEVICE_UNLOCK_DATA_UNLOCK:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    if-ne v1, v4, :cond_0
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v0, "Password2Auth has already been completed for: "
-
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    new-array v0, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, p2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sget-object p2, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    goto :goto_0
-
-    :cond_0
-    invoke-virtual {v0, p1}, Landroid/app/KeyguardManager;->isDeviceSecure(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v0, "Do Password2Auth with null credential for: "
-
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    new-array v0, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, p2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-virtual {p0, p1}, Lcom/android/server/am/UserController;->onPassword2Auth(I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p2
-
-    :cond_1
-    :goto_0
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    if-ne p2, v0, :cond_2
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p2
-
-    if-nez p2, :cond_2
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v0, "fetch outer layer key and unlock DualDAR user "
-
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    new-array v0, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, p2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    const/4 p2, 0x0
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/am/UserController;->maybeUnlockUser(ILandroid/os/IProgressListener;)Z
-
-    move-result p0
-
-    return p0
-
-    :cond_2
-    const-string p0, "Default Authentication Failure by DualDAR client"
-
-    new-array p1, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    return v3
-
-    :cond_3
-    invoke-virtual {v0, p2}, Landroid/app/KeyguardManager;->isDeviceLocked(I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_4
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string p2, "This should theoretically never happen. Failed to unlock DualDAR user: "
-
-    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string p1, " something went wrong while fetching OLK event though user0 is unlocked."
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    :cond_4
-    return v3
-.end method
-
 .method public final maybeUnlockUser(I)Z
     .locals 6
 
@@ -8081,92 +7808,6 @@
     throw p0
 .end method
 
-.method public final onPassword2Auth(I)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 4
-
-    const/4 v0, 0x0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    const-string v2, "ActivityManager"
-
-    const-string/jumbo v3, "onPassword2Auth()"
-
-    invoke-static {v2, v3, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "User is not DualDAR eligible. so no need to verify DualDAR Passwords"
-
-    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v0, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    invoke-virtual {p0}, Lcom/android/server/am/UserController$Injector;->getContext()Landroid/content/Context;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    const/4 v1, 0x0
-
-    invoke-virtual {p0, p1, v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Auth(I[B)Z
-
-    move-result p0
-
-    if-nez p0, :cond_1
-
-    const-string p0, "Authentication Failure by dual dar client"
-
-    new-array p1, v0, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_1
-    const-string/jumbo p0, "onPassword2Auth completed successfully"
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sget-object p0, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {p1, p0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-.end method
-
 .method public onSystemReady()V
     .locals 2
 
@@ -11038,42 +10679,11 @@
 
     invoke-virtual {v3, v1, v8, v2}, Lcom/android/server/wm/MultiTaskingController;->startUser(IZZ)V
 
-    invoke-static/range {p1 .. p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_16
-
-    invoke-static/range {p1 .. p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncrypted(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_16
-
-    invoke-virtual {v6}, Landroid/content/pm/UserInfo;->isInitialized()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_16
-
-    iget-object v3, v0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
-
-    invoke-virtual {v3}, Lcom/android/server/am/UserController$Injector;->getContext()Landroid/content/Context;
-
-    move-result-object v3
-
-    invoke-static {v3}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v3
-
-    invoke-virtual {v3, v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onUserStart(I)V
-
-    :cond_16
     const-string/jumbo v3, "sendMessages"
 
     invoke-virtual {v5, v3}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    if-eqz v8, :cond_17
+    if-eqz v8, :cond_16
 
     iget-object v3, v0, Lcom/android/server/am/UserController;->mHandler:Landroid/os/Handler;
 
@@ -11119,15 +10729,15 @@
 
     invoke-virtual {v3, v4, v9, v10}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z
 
-    :cond_17
+    :cond_16
     iget-boolean v3, v6, Landroid/content/pm/UserInfo;->preCreated:Z
 
-    if-eqz v3, :cond_18
+    if-eqz v3, :cond_17
 
     const/4 v2, 0x0
 
-    :cond_18
-    if-nez v1, :cond_19
+    :cond_17
+    if-nez v1, :cond_18
 
     iget-object v3, v0, Lcom/android/server/am/UserController;->mInjector:Lcom/android/server/am/UserController$Injector;
 
@@ -11135,27 +10745,27 @@
 
     move-result v3
 
-    if-eqz v3, :cond_19
+    if-eqz v3, :cond_18
 
     const/4 v6, 0x1
 
     goto :goto_8
 
-    :cond_19
+    :cond_18
     const/4 v6, 0x0
 
     :goto_8
-    if-nez v2, :cond_1a
+    if-nez v2, :cond_19
 
-    if-eqz v6, :cond_1b
+    if-eqz v6, :cond_1a
 
-    :cond_1a
+    :cond_19
     invoke-virtual {v0, v1, v11, v12}, Lcom/android/server/am/UserController;->sendUserStartedBroadcast(III)V
 
-    :cond_1b
+    :cond_1a
     invoke-virtual/range {p5 .. p5}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
-    if-eqz v8, :cond_1c
+    if-eqz v8, :cond_1b
 
     const-string/jumbo v3, "moveUserToForeground"
 
@@ -11167,7 +10777,7 @@
 
     goto :goto_9
 
-    :cond_1c
+    :cond_1b
     const-string v3, "finishUserBoot"
 
     invoke-virtual {v5, v3}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
@@ -11177,11 +10787,11 @@
     invoke-virtual/range {p5 .. p5}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     :goto_9
-    if-nez v2, :cond_1d
+    if-nez v2, :cond_1c
 
-    if-eqz v6, :cond_1e
+    if-eqz v6, :cond_1d
 
-    :cond_1d
+    :cond_1c
     const-string/jumbo v2, "sendRestartBroadcast"
 
     invoke-virtual {v5, v2}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
@@ -11192,7 +10802,7 @@
     :try_end_16
     .catchall {:try_start_16 .. :try_end_16} :catchall_5
 
-    :cond_1e
+    :cond_1d
     invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     const/4 v0, 0x1
diff --git a/smali_classes2/com/android/server/devicepolicy/DevicePolicyManagerService.smali b/smali_classes2/com/android/server/devicepolicy/DevicePolicyManagerService.smali
index bbd89c99..0c731539 100644
--- a/smali_classes2/com/android/server/devicepolicy/DevicePolicyManagerService.smali
+++ b/smali_classes2/com/android/server/devicepolicy/DevicePolicyManagerService.smali
@@ -63207,57 +63207,8 @@
 .end method
 
 .method public final removeDualDarClientPackage(Ljava/util/Set;I)V
-    .locals 2
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    new-instance v0, Ljava/util/HashSet;
-
-    invoke-direct {v0}, Ljava/util/HashSet;-><init>()V
-
-    iget-object p0, p0, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getClientPackage(I)Ljava/lang/String;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "DualDar client pkg "
-
-    invoke-virtual {p2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v1, " should not be deleted during Managed Device Provisioning"
-
-    invoke-virtual {p2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    const-string v1, "DevicePolicyManager"
-
-    invoke-static {v1, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-interface {v0, p0}, Ljava/util/Set;->add(Ljava/lang/Object;)Z
-
-    invoke-interface {p1, v0}, Ljava/util/Set;->removeAll(Ljava/util/Collection;)Z
+    .locals 0
 
-    :cond_0
     return-void
 .end method
 
@@ -65693,7 +65644,7 @@
 
     const/4 v10, 0x0
 
-    if-eqz v6, :cond_2
+    if-eqz v6, :cond_1
 
     invoke-virtual {v1, v0}, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->isMultifactorAuthEnforced(I)Z
 
@@ -65712,23 +65663,6 @@
     return v10
 
     :cond_0
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v6
-
-    if-eqz v6, :cond_1
-
-    const-string v0, "DevicePolicyManager"
-
-    const-string v1, "Failed to reset password due to constraint violation: password null does not meet DualDAR on Device Owner Enabled"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    monitor-exit v3
-
-    return v10
-
-    :cond_1
     new-instance v6, Landroid/app/admin/PasswordMetrics;
 
     invoke-direct {v6, v9}, Landroid/app/admin/PasswordMetrics;-><init>(I)V
@@ -65739,7 +65673,7 @@
 
     goto :goto_0
 
-    :cond_2
+    :cond_1
     invoke-virtual/range {p1 .. p1}, Ljava/lang/String;->getBytes()[B
 
     move-result-object v6
@@ -65755,7 +65689,7 @@
 
     const/4 v11, 0x1
 
-    if-nez v5, :cond_3
+    if-nez v5, :cond_2
 
     const-string v0, "DevicePolicyManager"
 
@@ -65775,7 +65709,7 @@
 
     return v10
 
-    :cond_3
+    :cond_2
     monitor-exit v3
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_4
@@ -65786,9 +65720,9 @@
 
     iget v3, v12, Lcom/android/server/devicepolicy/DevicePolicyData;->mPasswordOwner:I
 
-    if-ltz v3, :cond_4
+    if-ltz v3, :cond_3
 
-    if-eq v3, v8, :cond_4
+    if-eq v3, v8, :cond_3
 
     const-string v0, "DevicePolicyManager"
 
@@ -65798,7 +65732,7 @@
 
     return v10
 
-    :cond_4
+    :cond_3
     move-object/from16 v3, p6
 
     invoke-virtual {v1, v3}, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->isDefaultDeviceOwner(Lcom/android/server/devicepolicy/CallerIdentity;)Z
@@ -65807,30 +65741,30 @@
 
     and-int/lit8 v4, p5, 0x2
 
-    if-eqz v4, :cond_5
+    if-eqz v4, :cond_4
 
     move v4, v11
 
     goto :goto_1
 
-    :cond_5
+    :cond_4
     move v4, v10
 
     :goto_1
-    if-eqz v3, :cond_6
+    if-eqz v3, :cond_5
 
-    if-eqz v4, :cond_6
+    if-eqz v4, :cond_5
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->setDoNotAskCredentialsOnBoot()V
 
-    :cond_6
+    :cond_5
     iget-object v3, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
 
     invoke-virtual {v3}, Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;->binderClearCallingIdentity()J
 
     move-result-wide v13
 
-    if-eqz v2, :cond_7
+    if-eqz v2, :cond_6
 
     invoke-static/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->createPin(Ljava/lang/CharSequence;)Lcom/android/internal/widget/LockscreenCredential;
 
@@ -65838,7 +65772,7 @@
 
     goto :goto_2
 
-    :cond_7
+    :cond_6
     invoke-static/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->createPasswordOrNone(Ljava/lang/CharSequence;)Lcom/android/internal/widget/LockscreenCredential;
 
     move-result-object v2
@@ -65850,13 +65784,13 @@
 
     cmp-long v2, p2, v4
 
-    if-eqz v2, :cond_11
+    if-eqz v2, :cond_10
 
-    if-nez p4, :cond_8
+    if-nez p4, :cond_7
 
     goto/16 :goto_7
 
-    :cond_8
+    :cond_7
     const/4 v2, 0x0
 
     :try_start_1
@@ -65870,7 +65804,7 @@
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_1
 
-    if-eqz v15, :cond_9
+    if-eqz v15, :cond_8
 
     :try_start_2
     invoke-virtual {v15}, Landroid/os/PowerManager$WakeLock;->acquire()V
@@ -65883,7 +65817,7 @@
 
     goto :goto_3
 
-    :cond_9
+    :cond_8
     const-string v2, "DevicePolicyManager"
 
     const-string/jumbo v4, "wakeLock must not be null!"
@@ -65905,9 +65839,9 @@
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    if-nez v2, :cond_c
+    if-nez v2, :cond_b
 
-    if-nez v15, :cond_a
+    if-nez v15, :cond_9
 
     :try_start_3
     const-string v0, "DevicePolicyManager"
@@ -65918,12 +65852,12 @@
 
     goto :goto_4
 
-    :cond_a
+    :cond_9
     invoke-virtual {v15}, Landroid/os/PowerManager$WakeLock;->isHeld()Z
 
     move-result v0
 
-    if-eqz v0, :cond_b
+    if-eqz v0, :cond_a
 
     invoke-virtual {v15}, Landroid/os/PowerManager$WakeLock;->release()V
 
@@ -65935,7 +65869,7 @@
 
     goto :goto_4
 
-    :cond_b
+    :cond_a
     const-string v0, "DevicePolicyManager"
 
     const-string/jumbo v2, "wakeLock is not held."
@@ -65951,8 +65885,8 @@
 
     return v10
 
-    :cond_c
-    if-nez v15, :cond_d
+    :cond_b
+    if-nez v15, :cond_c
 
     :try_start_4
     const-string v2, "DevicePolicyManager"
@@ -65963,12 +65897,12 @@
 
     goto :goto_8
 
-    :cond_d
+    :cond_c
     invoke-virtual {v15}, Landroid/os/PowerManager$WakeLock;->isHeld()Z
 
     move-result v2
 
-    if-eqz v2, :cond_e
+    if-eqz v2, :cond_d
 
     invoke-virtual {v15}, Landroid/os/PowerManager$WakeLock;->release()V
 
@@ -65980,7 +65914,7 @@
 
     goto :goto_8
 
-    :cond_e
+    :cond_d
     const-string v2, "DevicePolicyManager"
 
     const-string/jumbo v3, "wakeLock is not held."
@@ -66000,13 +65934,13 @@
     move-exception v0
 
     :goto_5
-    if-eqz v2, :cond_10
+    if-eqz v2, :cond_f
 
     invoke-virtual {v2}, Landroid/os/PowerManager$WakeLock;->isHeld()Z
 
     move-result v3
 
-    if-eqz v3, :cond_f
+    if-eqz v3, :cond_e
 
     invoke-virtual {v2}, Landroid/os/PowerManager$WakeLock;->release()V
 
@@ -66018,7 +65952,7 @@
 
     goto :goto_6
 
-    :cond_f
+    :cond_e
     const-string v2, "DevicePolicyManager"
 
     const-string/jumbo v3, "wakeLock is not held."
@@ -66027,7 +65961,7 @@
 
     goto :goto_6
 
-    :cond_10
+    :cond_f
     const-string v2, "DevicePolicyManager"
 
     const-string/jumbo v3, "wakeLock must not be null!"
@@ -66037,7 +65971,7 @@
     :goto_6
     throw v0
 
-    :cond_11
+    :cond_10
     :goto_7
     iget-object v2, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
@@ -66051,7 +65985,7 @@
     :try_end_4
     .catchall {:try_start_4 .. :try_end_4} :catchall_3
 
-    if-nez v2, :cond_12
+    if-nez v2, :cond_11
 
     iget-object v0, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mInjector:Lcom/android/server/devicepolicy/DevicePolicyManagerService$Injector;
 
@@ -66059,21 +65993,21 @@
 
     return v10
 
-    :cond_12
+    :cond_11
     :goto_8
     and-int/lit8 v2, p5, 0x1
 
-    if-eqz v2, :cond_13
+    if-eqz v2, :cond_12
 
     move v2, v11
 
     goto :goto_9
 
-    :cond_13
+    :cond_12
     move v2, v10
 
     :goto_9
-    if-eqz v2, :cond_14
+    if-eqz v2, :cond_13
 
     :try_start_5
     iget-object v3, v1, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
@@ -66082,7 +66016,7 @@
 
     invoke-virtual {v3, v4, v9}, Lcom/android/internal/widget/LockPatternUtils;->requireStrongAuth(II)V
 
-    :cond_14
+    :cond_13
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->getLockObject()Ljava/lang/Object;
 
     move-result-object v3
@@ -66091,35 +66025,35 @@
     :try_end_5
     .catchall {:try_start_5 .. :try_end_5} :catchall_3
 
-    if-eqz v2, :cond_15
+    if-eqz v2, :cond_14
 
     move v9, v8
 
-    :cond_15
+    :cond_14
     :try_start_6
     iget v2, v12, Lcom/android/server/devicepolicy/DevicePolicyData;->mPasswordOwner:I
 
-    if-eq v2, v9, :cond_16
+    if-eq v2, v9, :cond_15
 
     iput v9, v12, Lcom/android/server/devicepolicy/DevicePolicyData;->mPasswordOwner:I
 
     move v10, v11
 
-    :cond_16
+    :cond_15
     iget v2, v12, Lcom/android/server/devicepolicy/DevicePolicyData;->mLastResetPassword:I
 
-    if-eq v2, v8, :cond_17
+    if-eq v2, v8, :cond_16
 
     iput v8, v12, Lcom/android/server/devicepolicy/DevicePolicyData;->mLastResetPassword:I
 
     move v10, v11
 
-    :cond_17
-    if-eqz v10, :cond_18
+    :cond_16
+    if-eqz v10, :cond_17
 
     invoke-virtual {v1, v0}, Lcom/android/server/devicepolicy/DevicePolicyManagerService;->saveSettingsLocked(I)V
 
-    :cond_18
+    :cond_17
     monitor-exit v3
     :try_end_6
     .catchall {:try_start_6 .. :try_end_6} :catchall_2
diff --git a/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$1.smali b/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$1.smali
index 7a97a5c1..87c5769e 100644
--- a/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$1.smali
+++ b/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$1.smali
@@ -15,26 +15,6 @@
 .field public final synthetic val$success:[Z
 
 
-# direct methods
-.method public constructor <init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[Z)V
-    .locals 0
-
-    iput-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iput-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$success:[Z
-
-    iput-object p3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$errorCode:[I
-
-    iput-object p4, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$mutex:Ljava/lang/Object;
-
-    iput-object p5, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;->val$finished:[Z
-
-    invoke-direct {p0}, Landroid/content/BroadcastReceiver;-><init>()V
-
-    return-void
-.end method
-
-
 # virtual methods
 .method public onReceive(Landroid/content/Context;Landroid/content/Intent;)V
     .locals 4
diff --git a/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$2.smali b/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$2.smali
deleted file mode 100644
index bdbc68a0..00000000
--- a/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$2.smali
+++ /dev/null
@@ -1,166 +0,0 @@
-.class public Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;
-.super Landroid/content/BroadcastReceiver;
-.source "DualDarProvisioningHelper.java"
-
-
-# instance fields
-.field public final synthetic this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-.field public final synthetic val$errorCode:[I
-
-.field public final synthetic val$finished:[Z
-
-.field public final synthetic val$mutex:Ljava/lang/Object;
-
-.field public final synthetic val$success:[Z
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[Z)V
-    .locals 0
-
-    iput-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iput-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$success:[Z
-
-    iput-object p3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$errorCode:[I
-
-    iput-object p4, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$mutex:Ljava/lang/Object;
-
-    iput-object p5, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$finished:[Z
-
-    invoke-direct {p0}, Landroid/content/BroadcastReceiver;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public onReceive(Landroid/content/Context;Landroid/content/Intent;)V
-    .locals 4
-
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string v0, "DualDarProvisioningHelper"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "DualDAR Managed Profile Completed Service onReceived is called: "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    invoke-static {v0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->-$$Nest$fgetmContext(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;)Landroid/content/Context;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p0}, Landroid/content/Context;->unregisterReceiver(Landroid/content/BroadcastReceiver;)V
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    invoke-static {v0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->-$$Nest$fgetmContext(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;)Landroid/content/Context;
-
-    move-result-object v0
-
-    iget-object v1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v1, v1, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->connection:Landroid/content/ServiceConnection;
-
-    invoke-virtual {v0, v1}, Landroid/content/Context;->unbindService(Landroid/content/ServiceConnection;)V
-
-    const-string v0, "com.android.dualdar.completed.provisioning_success"
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/4 v1, 0x1
-
-    const/4 v2, 0x0
-
-    if-eqz v0, :cond_0
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$success:[Z
-
-    aput-boolean v1, p1, v2
-
-    goto :goto_0
-
-    :cond_0
-    const-string v0, "com.android.dualdar.completed.cancelled"
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_1
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$success:[Z
-
-    aput-boolean v1, p1, v2
-
-    const-string p1, "DualDarProvisioningHelper"
-
-    const-string p2, "DualDAR is not enabled. dualdar completed provisinoing cacelled."
-
-    invoke-static {p1, p2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_0
-
-    :cond_1
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$success:[Z
-
-    aput-boolean v2, p1, v2
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$errorCode:[I
-
-    const-string v0, "ERROR_CODE"
-
-    const/4 v3, 0x5
-
-    invoke-virtual {p2, v0, v3}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p2
-
-    aput p2, p1, v2
-
-    :goto_0
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$mutex:Ljava/lang/Object;
-
-    monitor-enter p1
-
-    :try_start_0
-    iget-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$finished:[Z
-
-    aput-boolean v1, p2, v2
-
-    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;->val$mutex:Ljava/lang/Object;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->notify()V
-
-    monitor-exit p1
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit p1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
diff --git a/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$3.smali b/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$3.smali
index b505c1c9..216d430d 100644
--- a/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$3.smali
+++ b/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$3.smali
@@ -15,26 +15,6 @@
 .field public final synthetic val$success:[Z
 
 
-# direct methods
-.method public constructor <init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[Z)V
-    .locals 0
-
-    iput-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$3;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iput-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$3;->val$success:[Z
-
-    iput-object p3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$3;->val$errorCode:[I
-
-    iput-object p4, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$3;->val$mutex:Ljava/lang/Object;
-
-    iput-object p5, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$3;->val$finished:[Z
-
-    invoke-direct {p0}, Landroid/content/BroadcastReceiver;-><init>()V
-
-    return-void
-.end method
-
-
 # virtual methods
 .method public onReceive(Landroid/content/Context;Landroid/content/Intent;)V
     .locals 4
diff --git a/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$4.smali b/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$4.smali
deleted file mode 100644
index a304a4ee..00000000
--- a/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper$4.smali
+++ /dev/null
@@ -1,145 +0,0 @@
-.class public Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;
-.super Landroid/content/BroadcastReceiver;
-.source "DualDarProvisioningHelper.java"
-
-
-# instance fields
-.field public final synthetic this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-.field public final synthetic val$errorCode:[I
-
-.field public final synthetic val$finished:[Z
-
-.field public final synthetic val$mutex:Ljava/lang/Object;
-
-.field public final synthetic val$success:[Z
-
-
-# direct methods
-.method public constructor <init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[Z)V
-    .locals 0
-
-    iput-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iput-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->val$success:[Z
-
-    iput-object p3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->val$errorCode:[I
-
-    iput-object p4, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->val$mutex:Ljava/lang/Object;
-
-    iput-object p5, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->val$finished:[Z
-
-    invoke-direct {p0}, Landroid/content/BroadcastReceiver;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public onReceive(Landroid/content/Context;Landroid/content/Intent;)V
-    .locals 4
-
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string v0, "DualDarProvisioningHelper"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "DualDAR Managed Device Completed Service onReceived is called: "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    invoke-static {v0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->-$$Nest$fgetmContext(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;)Landroid/content/Context;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p0}, Landroid/content/Context;->unregisterReceiver(Landroid/content/BroadcastReceiver;)V
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    invoke-static {v0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->-$$Nest$fgetmContext(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;)Landroid/content/Context;
-
-    move-result-object v0
-
-    iget-object v1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->this$0:Lcom/android/server/devicepolicy/DualDarProvisioningHelper;
-
-    iget-object v1, v1, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->connection:Landroid/content/ServiceConnection;
-
-    invoke-virtual {v0, v1}, Landroid/content/Context;->unbindService(Landroid/content/ServiceConnection;)V
-
-    const-string v0, "com.android.dualdar.completed.provisioning_success"
-
-    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    const/4 v0, 0x1
-
-    const/4 v1, 0x0
-
-    if-eqz p1, :cond_0
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->val$success:[Z
-
-    aput-boolean v0, p1, v1
-
-    goto :goto_0
-
-    :cond_0
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->val$success:[Z
-
-    aput-boolean v1, p1, v1
-
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->val$errorCode:[I
-
-    const-string v2, "ERROR_CODE"
-
-    const/4 v3, 0x5
-
-    invoke-virtual {p2, v2, v3}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p2
-
-    aput p2, p1, v1
-
-    :goto_0
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->val$mutex:Ljava/lang/Object;
-
-    monitor-enter p1
-
-    :try_start_0
-    iget-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->val$finished:[Z
-
-    aput-boolean v0, p2, v1
-
-    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;->val$mutex:Ljava/lang/Object;
-
-    invoke-virtual {p0}, Ljava/lang/Object;->notify()V
-
-    monitor-exit p1
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit p1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
diff --git a/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper.smali b/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper.smali
index 623d7d29..1cc84bfc 100644
--- a/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper.smali
+++ b/smali_classes2/com/android/server/devicepolicy/DualDarProvisioningHelper.smali
@@ -38,113 +38,6 @@
     return-void
 .end method
 
-.method public static getDualDARConfigParams(Landroid/content/Context;Landroid/os/PersistableBundle;)Landroid/os/Bundle;
-    .locals 8
-
-    if-eqz p1, :cond_0
-
-    invoke-static {p0, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARIntentProvisioned(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    new-instance p0, Landroid/os/Bundle;
-
-    invoke-direct {p0, p1}, Landroid/os/Bundle;-><init>(Landroid/os/PersistableBundle;)V
-
-    invoke-virtual {p0}, Landroid/os/Bundle;->deepCopy()Landroid/os/Bundle;
-
-    move-result-object p0
-
-    return-object p0
-
-    :cond_0
-    invoke-static {p0}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARProfile(Landroid/content/Context;)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    const/4 p1, 0x0
-
-    if-nez p0, :cond_1
-
-    return-object p1
-
-    :cond_1
-    const-string v0, "dualdar-config-client-package"
-
-    invoke-virtual {p0, v0}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    const-string v2, "dualdar-config-client-signature"
-
-    invoke-virtual {p0, v2}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v3
-
-    const-string v4, "dualdar-config-client-location"
-
-    invoke-virtual {p0, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    new-instance v5, Landroid/os/Bundle;
-
-    invoke-direct {v5}, Landroid/os/Bundle;-><init>()V
-
-    const-string v6, "dualdar-config"
-
-    const/4 v7, 0x1
-
-    invoke-virtual {v5, v6, v7}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V
-
-    const-string v6, "default"
-
-    invoke-virtual {v6, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v7
-
-    if-eqz v7, :cond_2
-
-    move-object v7, p1
-
-    goto :goto_0
-
-    :cond_2
-    move-object v7, v1
-
-    :goto_0
-    invoke-virtual {v5, v0, v7}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v6, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    move-object v3, p1
-
-    :cond_3
-    invoke-virtual {v5, v2, v3}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v6, p0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    goto :goto_1
-
-    :cond_4
-    move-object p1, p0
-
-    :goto_1
-    invoke-virtual {v5, v4, p1}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V
-
-    return-object v5
-.end method
-
 .method public static getDualDARProfile(Landroid/content/Context;)Landroid/os/Bundle;
     .locals 1
 
@@ -213,1258 +106,82 @@
     return p0
 .end method
 
-.method public static isDualDARIntentProvisioned(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-    .locals 0
-
-    if-eqz p1, :cond_0
-
-    const-string p0, "dualdar-config"
-
-    invoke-virtual {p1, p0}, Landroid/os/PersistableBundle;->getBoolean(Ljava/lang/String;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const-string p0, "DualDarProvisioningHelper"
-
-    const-string p1, "isDualDARIntentProvisioned from provisioning params"
-
-    invoke-static {p0, p1}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
 
 # virtual methods
 .method public getDualDarProfileFlags(Landroid/app/admin/ManagedProfileProvisioningParams;)I
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object p1
-
-    invoke-virtual {p0, v0, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const p0, 0x2000040
-
-    goto :goto_0
-
-    :cond_0
-    const p0, 0x4000040
-
-    :goto_0
-    return p0
+    .locals 0
 
-    :cond_1
     const/16 p0, 0x40
 
     return p0
 .end method
 
-.method public final isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-    .locals 4
-
-    const/4 p0, 0x0
-
-    const-string v0, "dualdar-config-client-package"
-
-    const-string v1, "DualDarProvisioningHelper"
-
-    if-eqz p2, :cond_0
-
-    invoke-virtual {p2, v0}, Landroid/os/PersistableBundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v2
-
-    if-nez v2, :cond_0
-
-    const-string p1, "Custom crypto from provisioning params"
-
-    invoke-static {v1, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return p0
-
-    :cond_0
-    const/4 v2, 0x1
-
-    if-eqz p2, :cond_1
-
-    const-string v3, "dualdar-config"
-
-    invoke-virtual {p2, v3}, Landroid/os/PersistableBundle;->getBoolean(Ljava/lang/String;)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    const-string/jumbo p0, "native crypto from provisioning params"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v2
-
-    :cond_1
-    invoke-static {p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARProfile(Landroid/content/Context;)Landroid/os/Bundle;
-
-    move-result-object p2
-
-    if-eqz p2, :cond_2
-
-    invoke-static {p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARProfile(Landroid/content/Context;)Landroid/os/Bundle;
-
-    move-result-object p1
-
-    invoke-virtual {p1, v0}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p1
-
-    const-string p2, "default"
-
-    invoke-virtual {p2, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_2
-
-    const-string p0, "isDualDARNativeCrypto from preset params"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v2
-
-    :cond_2
-    return p0
-.end method
-
 .method public onCreateAndProvisioningManagedProfileCompletedForDualDar(Landroid/app/admin/ManagedProfileProvisioningParams;I)V
-    .locals 12
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    new-instance v0, Ljava/lang/Object;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    const/4 v1, 0x1
-
-    new-array v7, v1, [Z
-
-    const/4 v8, 0x0
-
-    aput-boolean v8, v7, v8
-
-    new-array v9, v1, [Z
-
-    new-array v10, v1, [I
-
-    new-instance v11, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;
-
-    move-object v1, v11
-
-    move-object v2, p0
-
-    move-object v3, v9
-
-    move-object v4, v10
-
-    move-object v5, v0
-
-    move-object v6, v7
-
-    invoke-direct/range {v1 .. v6}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$2;-><init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[Z)V
-
-    new-instance v1, Landroid/content/IntentFilter;
-
-    invoke-direct {v1}, Landroid/content/IntentFilter;-><init>()V
-
-    invoke-virtual {p0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->setFilterForDualDarCompleted(Landroid/content/IntentFilter;)V
-
-    iget-object v2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v2, v11, v1}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
-
-    monitor-enter v0
-
-    :try_start_0
-    const-string v1, "DualDarProvisioningHelper"
-
-    const-string v2, "Starting Knox DUAL DAR DualDar Completed Service"
-
-    invoke-static {v1, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v1, Landroid/content/Intent;
-
-    invoke-direct {v1}, Landroid/content/Intent;-><init>()V
-
-    new-instance v2, Landroid/content/ComponentName;
-
-    const-string v3, "com.samsung.android.knox.containercore"
-
-    const-string v4, "com.samsung.android.knox.containercore.provisioning.DualDarCompletedService"
-
-    invoke-direct {v2, v3, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v1, v2}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
-
-    const-string v2, "android.intent.extra.user_handle"
-
-    invoke-virtual {v1, v2, p2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    const-string p2, "DUAL_DAR_PARAMS"
-
-    iget-object v2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v3
-
-    invoke-static {v2, v3}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARConfigParams(Landroid/content/Context;Landroid/os/PersistableBundle;)Landroid/os/Bundle;
-
-    move-result-object v2
-
-    invoke-virtual {v1, p2, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
-
-    const-string p2, "DualDARServiceEventFlag"
-
-    const/16 v2, 0x1f4
-
-    invoke-virtual {v1, p2, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getProfileAdminComponentName()Landroid/content/ComponentName;
-
-    move-result-object p2
-
-    const-string v2, "DUAL_DAR_ADMIN_PACKAGE"
-
-    invoke-virtual {p2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-virtual {v1, v2, p2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
-
-    const-string p2, "DUAL_DAR_INTENT_PROVISIONING"
-
-    iget-object v2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v3
-
-    invoke-static {v2, v3}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARIntentProvisioned(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v2
-
-    invoke-virtual {v1, p2, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    const-string p2, "DUAL_DAR_IS_WPCOD"
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->isOrganizationOwnedProvisioning()Z
+    .locals 0
 
-    move-result v2
+    return-void
+.end method
 
-    invoke-virtual {v1, p2, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
+.method public onCreateAndProvisioningManagedProfileStartedForDualDar(Landroid/app/admin/ManagedProfileProvisioningParams;)V
+    .locals 1
 
-    iget-object p2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
+    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
 
     invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
 
     move-result-object p1
 
-    invoke-virtual {p0, p2, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
+    invoke-static {p0, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
 
-    const/high16 p2, 0x2000000
+    move-result p0
 
-    invoke-virtual {v1, p1, p2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
+    if-nez p0, :cond_0
 
-    goto :goto_0
+    return-void
 
     :cond_0
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
+    new-instance p0, Landroid/os/ServiceSpecificException;
 
-    const/high16 p2, 0x4000000
+    const/4 p1, 0x1
 
-    invoke-virtual {v1, p1, p2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
+    const-string/jumbo v0, "onCreateAndProvisionManagedProfileStarted failed : not support dualdar"
 
-    :goto_0
-    invoke-virtual {p0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->startProvisionService(Landroid/content/Intent;)V
+    invoke-direct {p0, p1, v0}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
 
-    :goto_1
-    aget-boolean p0, v7, v8
+    throw p0
+.end method
 
-    if-nez p0, :cond_1
+.method public onProvisionFullyManagedDeviceCompletedForDualDar(Landroid/app/admin/FullyManagedDeviceProvisioningParams;)V
+    .locals 0
 
-    invoke-virtual {v0}, Ljava/lang/Object;->wait()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    return-void
+.end method
 
-    goto :goto_1
+.method public onProvisionFullyManagedDeviceStartedForDualDar(Landroid/app/admin/FullyManagedDeviceProvisioningParams;)V
+    .locals 1
 
-    :catchall_0
-    move-exception p0
+    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
 
-    goto :goto_2
+    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
 
-    :catch_0
-    move-exception p0
+    move-result-object p1
 
-    :try_start_1
-    const-string p1, "DualDarProvisioningHelper"
+    invoke-static {p0, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
 
-    new-instance p2, Ljava/lang/StringBuilder;
+    move-result p0
 
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
+    if-nez p0, :cond_0
 
-    const-string v1, "Error during onCreateAndProvisionManagedProfileCompleted"
+    return-void
 
-    invoke-virtual {p2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    :cond_0
+    new-instance p0, Landroid/os/ServiceSpecificException;
 
-    invoke-virtual {p2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    aget-boolean p0, v9, v8
-
-    if-eqz p0, :cond_2
-
-    goto :goto_3
-
-    :cond_2
-    new-instance p0, Landroid/os/ServiceSpecificException;
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo p2, "onCreateAndProvisionManagedProfileCompleted failed with result: "
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    aget p2, v10, v8
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const/4 p2, 0x2
-
-    invoke-direct {p0, p2, p1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
-
-    throw p0
-
-    :goto_2
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_3
-    :goto_3
-    return-void
-.end method
-
-.method public onCreateAndProvisioningManagedProfileStartedForDualDar(Landroid/app/admin/ManagedProfileProvisioningParams;)V
-    .locals 13
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    new-instance v0, Ljava/lang/Object;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    const/4 v7, 0x1
-
-    new-array v8, v7, [Z
-
-    const/4 v9, 0x0
-
-    aput-boolean v9, v8, v9
-
-    new-array v10, v7, [Z
-
-    new-array v11, v7, [I
-
-    new-instance v12, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;
-
-    move-object v1, v12
-
-    move-object v2, p0
-
-    move-object v3, v10
-
-    move-object v4, v11
-
-    move-object v5, v0
-
-    move-object v6, v8
-
-    invoke-direct/range {v1 .. v6}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$1;-><init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[Z)V
-
-    new-instance v1, Landroid/content/IntentFilter;
-
-    invoke-direct {v1}, Landroid/content/IntentFilter;-><init>()V
-
-    invoke-virtual {p0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->setFilterForDualDarStarted(Landroid/content/IntentFilter;)V
-
-    iget-object v2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v2, v12, v1}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
-
-    monitor-enter v0
-
-    :try_start_0
-    const-string v1, "DualDarProvisioningHelper"
-
-    const-string v2, "Starting Knox DUAL DAR DualDar Started Service"
-
-    invoke-static {v1, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v1, Landroid/content/Intent;
-
-    invoke-direct {v1}, Landroid/content/Intent;-><init>()V
-
-    new-instance v2, Landroid/content/ComponentName;
-
-    const-string v3, "com.samsung.android.knox.containercore"
-
-    const-string v4, "com.samsung.android.knox.containercore.provisioning.DualDarStartedService"
-
-    invoke-direct {v2, v3, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v1, v2}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_PARAMS"
-
-    iget-object v3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v4
-
-    invoke-static {v3, v4}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARConfigParams(Landroid/content/Context;Landroid/os/PersistableBundle;)Landroid/os/Bundle;
-
-    move-result-object v3
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
-
-    const-string v2, "DualDARServiceEventFlag"
-
-    const/16 v3, 0x1f4
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getProfileAdminComponentName()Landroid/content/ComponentName;
-
-    move-result-object v2
-
-    const-string v3, "DUAL_DAR_ADMIN_PACKAGE"
-
-    invoke-virtual {v2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v1, v3, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_INTENT_PROVISIONING"
-
-    iget-object v3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v4
-
-    invoke-static {v3, v4}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARIntentProvisioned(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v3
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_IS_WPCOD"
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->isOrganizationOwnedProvisioning()Z
-
-    move-result v3
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    iget-object v2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/ManagedProfileProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object p1
-
-    invoke-virtual {p0, v2, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v2, 0x2000000
-
-    invoke-virtual {v1, p1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    goto :goto_0
-
-    :cond_0
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v2, 0x4000000
-
-    invoke-virtual {v1, p1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    :goto_0
-    invoke-virtual {p0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->startProvisionService(Landroid/content/Intent;)V
-
-    :goto_1
-    aget-boolean p0, v8, v9
-
-    if-nez p0, :cond_1
-
-    invoke-virtual {v0}, Ljava/lang/Object;->wait()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :catch_0
-    move-exception p0
-
-    :try_start_1
-    const-string p1, "DualDarProvisioningHelper"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "Error during onCreateAndProvisionManagedProfileStarted"
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    aget-boolean p0, v10, v9
-
-    if-eqz p0, :cond_2
-
-    goto :goto_3
-
-    :cond_2
-    new-instance p0, Landroid/os/ServiceSpecificException;
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v0, "onCreateAndProvisionManagedProfileStarted failed with result: "
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    aget v0, v11, v9
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-direct {p0, v7, p1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
-
-    throw p0
-
-    :goto_2
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_3
-    :goto_3
-    return-void
-.end method
-
-.method public onProvisionFullyManagedDeviceCompletedForDualDar(Landroid/app/admin/FullyManagedDeviceProvisioningParams;)V
-    .locals 13
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    new-instance v0, Ljava/lang/Object;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    const/4 v7, 0x1
-
-    new-array v8, v7, [Z
-
-    const/4 v9, 0x0
-
-    aput-boolean v9, v8, v9
-
-    new-array v10, v7, [Z
-
-    new-array v11, v7, [I
-
-    new-instance v12, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;
-
-    move-object v1, v12
-
-    move-object v2, p0
-
-    move-object v3, v10
-
-    move-object v4, v11
-
-    move-object v5, v0
-
-    move-object v6, v8
-
-    invoke-direct/range {v1 .. v6}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$4;-><init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[Z)V
-
-    new-instance v1, Landroid/content/IntentFilter;
-
-    invoke-direct {v1}, Landroid/content/IntentFilter;-><init>()V
-
-    invoke-virtual {p0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->setFilterForDualDarCompleted(Landroid/content/IntentFilter;)V
-
-    iget-object v2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v2, v12, v1}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
-
-    monitor-enter v0
-
-    :try_start_0
-    const-string v1, "DualDarProvisioningHelper"
-
-    const-string v2, "Starting Knox DUAL DAR DualDar Completed Service"
-
-    invoke-static {v1, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v1, Landroid/content/Intent;
-
-    invoke-direct {v1}, Landroid/content/Intent;-><init>()V
-
-    new-instance v2, Landroid/content/ComponentName;
-
-    const-string v3, "com.samsung.android.knox.containercore"
-
-    const-string v4, "com.samsung.android.knox.containercore.provisioning.DualDarCompletedService"
-
-    invoke-direct {v2, v3, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v1, v2}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
-
-    const-string v2, "android.intent.extra.user_handle"
-
-    invoke-static {}, Landroid/os/UserHandle;->myUserId()I
-
-    move-result v3
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_PARAMS"
-
-    iget-object v3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v4
-
-    invoke-static {v3, v4}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARConfigParams(Landroid/content/Context;Landroid/os/PersistableBundle;)Landroid/os/Bundle;
-
-    move-result-object v3
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getDeviceAdminComponentName()Landroid/content/ComponentName;
-
-    move-result-object v2
-
-    const-string v3, "DUAL_DAR_ADMIN_PACKAGE"
-
-    invoke-virtual {v2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v1, v3, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_INTENT_PROVISIONING"
-
-    iget-object v3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v4
-
-    invoke-static {v3, v4}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARIntentProvisioned(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v3
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_IS_MANAGED_DEVICE"
-
-    invoke-virtual {v1, v2, v7}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    iget-object v2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object p1
-
-    invoke-virtual {p0, v2, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v2, 0x2000000
-
-    invoke-virtual {v1, p1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    goto :goto_0
-
-    :cond_0
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v2, 0x4000000
-
-    invoke-virtual {v1, p1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    :goto_0
-    invoke-virtual {p0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->startProvisionService(Landroid/content/Intent;)V
-
-    :goto_1
-    aget-boolean p0, v8, v9
-
-    if-nez p0, :cond_1
-
-    invoke-virtual {v0}, Ljava/lang/Object;->wait()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :catch_0
-    move-exception p0
-
-    :try_start_1
-    const-string p1, "DualDarProvisioningHelper"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "Error during onProvisionFullyManagedDeviceCompleted"
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    aget-boolean p0, v10, v9
-
-    if-eqz p0, :cond_2
-
-    goto :goto_3
-
-    :cond_2
-    new-instance p0, Landroid/os/ServiceSpecificException;
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v0, "onProvisionFullyManagedDeviceCompleted failed with result: "
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    aget v0, v11, v9
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const/4 v0, 0x7
-
-    invoke-direct {p0, v0, p1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
-
-    throw p0
-
-    :goto_2
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_3
-    :goto_3
-    return-void
-.end method
-
-.method public onProvisionFullyManagedDeviceStartedForDualDar(Landroid/app/admin/FullyManagedDeviceProvisioningParams;)V
-    .locals 13
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v1
-
-    invoke-static {v0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARConfigured(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
-
-    new-instance v0, Ljava/lang/Object;
-
-    invoke-direct {v0}, Ljava/lang/Object;-><init>()V
-
-    const/4 v7, 0x1
-
-    new-array v8, v7, [Z
-
-    const/4 v9, 0x0
-
-    aput-boolean v9, v8, v9
-
-    new-array v10, v7, [Z
-
-    new-array v11, v7, [I
-
-    new-instance v12, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$3;
-
-    move-object v1, v12
-
-    move-object v2, p0
-
-    move-object v3, v10
-
-    move-object v4, v11
-
-    move-object v5, v0
-
-    move-object v6, v8
-
-    invoke-direct/range {v1 .. v6}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper$3;-><init>(Lcom/android/server/devicepolicy/DualDarProvisioningHelper;[Z[ILjava/lang/Object;[Z)V
-
-    new-instance v1, Landroid/content/IntentFilter;
-
-    invoke-direct {v1}, Landroid/content/IntentFilter;-><init>()V
-
-    invoke-virtual {p0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->setFilterForDualDarStarted(Landroid/content/IntentFilter;)V
-
-    iget-object v2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v2, v12, v1}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
-
-    monitor-enter v0
-
-    :try_start_0
-    const-string v1, "DualDarProvisioningHelper"
-
-    const-string v2, "Starting Knox DUAL DAR DualDar Started Service"
-
-    invoke-static {v1, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    new-instance v1, Landroid/content/Intent;
-
-    invoke-direct {v1}, Landroid/content/Intent;-><init>()V
-
-    new-instance v2, Landroid/content/ComponentName;
-
-    const-string v3, "com.samsung.android.knox.containercore"
-
-    const-string v4, "com.samsung.android.knox.containercore.provisioning.DualDarStartedService"
-
-    invoke-direct {v2, v3, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {v1, v2}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
-
-    const-string v2, "android.intent.extra.user_handle"
-
-    invoke-static {}, Landroid/os/UserHandle;->myUserId()I
-
-    move-result v3
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_PARAMS"
-
-    iget-object v3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v4
-
-    invoke-static {v3, v4}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->getDualDARConfigParams(Landroid/content/Context;Landroid/os/PersistableBundle;)Landroid/os/Bundle;
-
-    move-result-object v3
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Bundle;)Landroid/content/Intent;
-
-    const-string v2, "DualDARServiceEventFlag"
-
-    const/16 v3, 0x1f4
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getDeviceAdminComponentName()Landroid/content/ComponentName;
-
-    move-result-object v2
-
-    const-string v3, "DUAL_DAR_ADMIN_PACKAGE"
-
-    invoke-virtual {v2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {v1, v3, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_INTENT_PROVISIONING"
-
-    iget-object v3, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object v4
-
-    invoke-static {v3, v4}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARIntentProvisioned(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result v3
-
-    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    const-string v2, "DUAL_DAR_IS_MANAGED_DEVICE"
-
-    invoke-virtual {v1, v2, v7}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Z)Landroid/content/Intent;
-
-    iget-object v2, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    invoke-virtual {p1}, Landroid/app/admin/FullyManagedDeviceProvisioningParams;->getAdminExtras()Landroid/os/PersistableBundle;
-
-    move-result-object p1
-
-    invoke-virtual {p0, v2, p1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->isDualDARNativeCrypto(Landroid/content/Context;Landroid/os/PersistableBundle;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_0
-
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v2, 0x2000000
-
-    invoke-virtual {v1, p1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    goto :goto_0
-
-    :cond_0
-    const-string p1, "DUAL_DAR_CRYPTO_TYPE"
-
-    const/high16 v2, 0x4000000
-
-    invoke-virtual {v1, p1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;
-
-    :goto_0
-    iget-object p1, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mUserManagerInternal:Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-virtual {p1, v9, v2}, Lcom/android/server/pm/UserManagerInternal;->setDualDarInfo(II)Z
-
-    move-result p1
-
-    if-nez p1, :cond_1
-
-    const-string p0, "DualDarProvisioningHelper"
-
-    const-string p1, "Failed to set dualdar crypto type to UserInfo"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    aput-boolean v9, v10, v9
-
-    const-string p0, "ERROR_CODE"
-
-    const/4 p1, 0x5
-
-    invoke-virtual {v1, p0, p1}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
-
-    move-result p0
-
-    aput p0, v11, v9
-
-    goto :goto_2
-
-    :cond_1
-    invoke-virtual {p0, v1}, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->startProvisionService(Landroid/content/Intent;)V
-
-    :goto_1
-    aget-boolean p0, v8, v9
-
-    if-nez p0, :cond_2
-
-    invoke-virtual {v0}, Ljava/lang/Object;->wait()V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    goto :goto_1
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_3
-
-    :catch_0
-    move-exception p0
-
-    :try_start_1
-    const-string p1, "DualDarProvisioningHelper"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "Error during onProvisionFullyManagedDeviceStarted"
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    :cond_2
-    :goto_2
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    aget-boolean p0, v10, v9
-
-    if-eqz p0, :cond_3
-
-    goto :goto_4
-
-    :cond_3
-    new-instance p0, Landroid/os/ServiceSpecificException;
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v0, "onProvisionFullyManagedDeviceStarted failed with result: "
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    aget v0, v11, v9
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    invoke-direct {p0, v7, p1}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
-
-    throw p0
-
-    :goto_3
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_4
-    :goto_4
-    return-void
-.end method
-
-.method public final setFilterForDualDarCompleted(Landroid/content/IntentFilter;)V
-    .locals 0
-
-    const-string p0, "com.android.dualdar.completed.provisioning_success"
-
-    invoke-virtual {p1, p0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string p0, "com.android.dualdar.completed.cancelled"
-
-    invoke-virtual {p1, p0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string p0, "com.android.dualdar.completed.error"
-
-    invoke-virtual {p1, p0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    return-void
-.end method
-
-.method public final setFilterForDualDarStarted(Landroid/content/IntentFilter;)V
-    .locals 0
-
-    const-string p0, "com.android.dualdar.started.provisioning_success"
-
-    invoke-virtual {p1, p0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string p0, "com.android.dualdar.started.cancelled"
-
-    invoke-virtual {p1, p0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string p0, "com.android.dualdar.started.error"
-
-    invoke-virtual {p1, p0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    return-void
-.end method
-
-.method public final startProvisionService(Landroid/content/Intent;)V
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->mContext:Landroid/content/Context;
-
-    iget-object p0, p0, Lcom/android/server/devicepolicy/DualDarProvisioningHelper;->connection:Landroid/content/ServiceConnection;
-
-    const/16 v1, 0x41
-
-    invoke-virtual {v0, p1, p0, v1}, Landroid/content/Context;->bindService(Landroid/content/Intent;Landroid/content/ServiceConnection;I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    return-void
-
-    :cond_0
-    new-instance p0, Ljava/lang/Exception;
+    const/4 p1, 0x1
 
-    const-string/jumbo p1, "startProvisionService : failed to startService."
+    const-string/jumbo v0, "onProvisionFullyManagedDeviceStarted failed : not support dualdar managed device"
 
-    invoke-direct {p0, p1}, Ljava/lang/Exception;-><init>(Ljava/lang/String;)V
+    invoke-direct {p0, p1, v0}, Landroid/os/ServiceSpecificException;-><init>(ILjava/lang/String;)V
 
     throw p0
 .end method
diff --git a/smali_classes2/com/android/server/enterprise/EnterpriseDeviceManagerServiceImpl.smali b/smali_classes2/com/android/server/enterprise/EnterpriseDeviceManagerServiceImpl.smali
index e0b91721..ae1f80f7 100644
--- a/smali_classes2/com/android/server/enterprise/EnterpriseDeviceManagerServiceImpl.smali
+++ b/smali_classes2/com/android/server/enterprise/EnterpriseDeviceManagerServiceImpl.smali
@@ -2994,371 +2994,340 @@
 .end method
 
 .method public final createDeferredServices()V
-    .locals 6
-
-    const-string/jumbo v0, "knox_adapter_service"
+    .locals 5
 
-    const-string/jumbo v1, "phone_restriction_policy"
+    const-string/jumbo v0, "phone_restriction_policy"
 
-    const-string/jumbo v2, "wifi_policy"
+    const-string/jumbo v1, "wifi_policy"
 
-    iget-boolean v3, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mDeferredServicesCreated:Z
+    iget-boolean v2, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mDeferredServicesCreated:Z
 
-    const-string v4, "EnterpriseDeviceManagerService"
+    const-string v3, "EnterpriseDeviceManagerService"
 
-    if-eqz v3, :cond_0
+    if-eqz v2, :cond_0
 
     const-string p0, "createDeferredServices() : Skip to create"
 
-    invoke-static {v4, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     return-void
 
     :cond_0
-    const-string v3, "createDeferredServices() : Adding services ... "
+    const-string v2, "createDeferredServices() : Adding services ... "
 
-    invoke-static {v4, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     :try_start_0
     invoke-static {}, Lcom/android/server/enterprise/EnterpriseService;->wakeUpLazyServices()V
 
-    iget-object v3, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
-
-    invoke-static {v2}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v5
-
-    check-cast v5, Lcom/android/server/enterprise/EnterpriseServiceCallback;
-
-    invoke-virtual {v3, v2, v5}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
-
     iget-object v2, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
     invoke-static {v1}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyService(Ljava/lang/String;)Ljava/lang/Object;
 
-    move-result-object v3
-
-    check-cast v3, Lcom/android/server/enterprise/EnterpriseServiceCallback;
-
-    invoke-virtual {v2, v1, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
-
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
-
-    const-string v2, "device_info"
-
-    new-instance v3, Lcom/android/server/enterprise/device/DeviceInfo;
-
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    move-result-object v4
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/device/DeviceInfo;-><init>(Landroid/content/Context;)V
+    check-cast v4, Lcom/android/server/enterprise/EnterpriseServiceCallback;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    invoke-virtual {v2, v1, v4}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
     iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    const-string/jumbo v2, "license_log_service"
-
-    new-instance v3, Lcom/android/server/enterprise/license/LicenseLogService;
-
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
-
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/license/LicenseLogService;-><init>(Landroid/content/Context;)V
+    invoke-static {v0}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyService(Ljava/lang/String;)Ljava/lang/Object;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    move-result-object v2
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    check-cast v2, Lcom/android/server/enterprise/EnterpriseServiceCallback;
 
-    const-string v2, "auditlog"
+    invoke-virtual {v1, v0, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/auditlog/AuditLogService;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "device_info"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/auditlog/AuditLogService;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/device/DeviceInfo;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/device/DeviceInfo;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "eas_account_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/email/ExchangeAccountPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "license_log_service"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/email/ExchangeAccountPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/license/LicenseLogService;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/license/LicenseLogService;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "email_account_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/email/EmailAccountPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "auditlog"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/email/EmailAccountPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/auditlog/AuditLogService;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/auditlog/AuditLogService;-><init>(Landroid/content/Context;)V
 
-    const-string/jumbo v2, "location_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/location/LocationPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "eas_account_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/location/LocationPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/email/ExchangeAccountPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/email/ExchangeAccountPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string/jumbo v2, "misc_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/general/MiscPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "email_account_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/general/MiscPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/email/EmailAccountPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/email/EmailAccountPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string/jumbo v2, "vpn_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "location_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/location/LocationPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addLazySystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/location/LocationPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string/jumbo v2, "security_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/security/SecurityPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "misc_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/security/SecurityPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/general/MiscPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/general/MiscPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string/jumbo v2, "roaming_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/restriction/RoamingPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "vpn_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/restriction/RoamingPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/vpn/VpnInfoPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "bluetooth_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addLazySystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/bluetooth/BluetoothPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "security_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/bluetooth/BluetoothPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/security/SecurityPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/security/SecurityPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "email_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/email/EmailPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "roaming_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/email/EmailPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/restriction/RoamingPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/restriction/RoamingPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "firewall"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/firewall/Firewall;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "bluetooth_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/firewall/Firewall;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/bluetooth/BluetoothPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/bluetooth/BluetoothPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "certificate_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/certificate/CertificatePolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "email_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/certificate/CertificatePolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/email/EmailPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/email/EmailPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "apn_settings_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "firewall"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/firewall/Firewall;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/firewall/Firewall;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "browser_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/browser/BrowserPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "certificate_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/browser/BrowserPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/certificate/CertificatePolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/certificate/CertificatePolicy;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "date_time_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/datetime/DateTimePolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "apn_settings_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/datetime/DateTimePolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/apn/ApnSettingsPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string/jumbo v2, "kioskmode"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/kioskmode/KioskModeService;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "browser_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/kioskmode/KioskModeService;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/browser/BrowserPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/browser/BrowserPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string/jumbo v2, "ldap_account_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/email/LDAPAccountPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "date_time_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/email/LDAPAccountPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/datetime/DateTimePolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/datetime/DateTimePolicy;-><init>(Landroid/content/Context;)V
 
-    const-string/jumbo v2, "lockscreen_overlay"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/lso/LSOService;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string/jumbo v1, "kioskmode"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/lso/LSOService;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/kioskmode/KioskModeService;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/kioskmode/KioskModeService;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "geofencing"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/geofencing/GeofenceService;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "ldap_account_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/geofencing/GeofenceService;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/email/LDAPAccountPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/email/LDAPAccountPolicy;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "device_account_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/security/DeviceAccountPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "lockscreen_overlay"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/security/DeviceAccountPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/lso/LSOService;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/lso/LSOService;-><init>(Landroid/content/Context;)V
 
-    const-string/jumbo v2, "multi_user_manager_service"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "geofencing"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/geofencing/GeofenceService;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/geofencing/GeofenceService;-><init>(Landroid/content/Context;)V
 
-    const-string v2, "dex_policy"
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    new-instance v3, Lcom/android/server/enterprise/dex/DexPolicy;
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v5, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    const-string v1, "device_account_policy"
 
-    invoke-direct {v3, v5}, Lcom/android/server/enterprise/dex/DexPolicy;-><init>(Landroid/content/Context;)V
+    new-instance v2, Lcom/android/server/enterprise/security/DeviceAccountPolicy;
 
-    invoke-virtual {v1, v2, v3}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-static {v0}, Lcom/android/server/enterprise/EnterpriseService;->getPolicyService(Ljava/lang/String;)Ljava/lang/Object;
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/security/DeviceAccountPolicy;-><init>(Landroid/content/Context;)V
 
-    move-result-object v1
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    if-nez v1, :cond_1
+    iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    iget-object v1, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
+    const-string/jumbo v1, "multi_user_manager_service"
 
-    new-instance v2, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;
+    new-instance v2, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;
 
-    iget-object v3, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-direct {v2, v3}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;-><init>(Landroid/content/Context;)V
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/multiuser/MultiUserManagerService;-><init>(Landroid/content/Context;)V
 
-    invoke-virtual {v1, v0, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
     iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
-    const-string v1, "DualDARPolicy"
+    const-string v1, "dex_policy"
 
-    new-instance v2, Lcom/android/server/enterprise/dualdar/DualDARPolicy;
+    new-instance v2, Lcom/android/server/enterprise/dex/DexPolicy;
 
-    iget-object v3, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-direct {v2, v3}, Lcom/android/server/enterprise/dualdar/DualDARPolicy;-><init>(Landroid/content/Context;)V
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/dex/DexPolicy;-><init>(Landroid/content/Context;)V
 
     invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    :cond_1
     new-instance v0, Lcom/samsung/android/knox/ContextInfo;
 
     invoke-direct {v0}, Lcom/samsung/android/knox/ContextInfo;-><init>()V
@@ -3375,7 +3344,7 @@
 
     const/16 v2, 0x18
 
-    if-lt v1, v2, :cond_2
+    if-lt v1, v2, :cond_1
 
     new-instance v1, Ljava/lang/StringBuilder;
 
@@ -3395,7 +3364,7 @@
 
     move-result-object v0
 
-    invoke-static {v4, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
     iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
@@ -3403,22 +3372,22 @@
 
     new-instance v2, Lcom/android/server/enterprise/threatdefense/ThreatDefenseService;
 
-    iget-object v3, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-direct {v2, v3}, Lcom/android/server/enterprise/threatdefense/ThreatDefenseService;-><init>(Landroid/content/Context;)V
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/threatdefense/ThreatDefenseService;-><init>(Landroid/content/Context;)V
 
     invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addSystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
-    :cond_2
+    :cond_1
     iget-object v0, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mInjector:Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;
 
     const-string/jumbo v1, "knoxnap"
 
     new-instance v2, Lcom/android/server/enterprise/nap/NetworkAnalyticsService;
 
-    iget-object v3, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-direct {v2, v3}, Lcom/android/server/enterprise/nap/NetworkAnalyticsService;-><init>(Landroid/content/Context;)V
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/nap/NetworkAnalyticsService;-><init>(Landroid/content/Context;)V
 
     invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addLazySystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
@@ -3428,9 +3397,9 @@
 
     new-instance v2, Lcom/android/server/enterprise/filter/KnoxNetworkFilterService;
 
-    iget-object v3, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
+    iget-object v4, p0, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl;->mContext:Landroid/content/Context;
 
-    invoke-direct {v2, v3}, Lcom/android/server/enterprise/filter/KnoxNetworkFilterService;-><init>(Landroid/content/Context;)V
+    invoke-direct {v2, v4}, Lcom/android/server/enterprise/filter/KnoxNetworkFilterService;-><init>(Landroid/content/Context;)V
 
     invoke-virtual {v0, v1, v2}, Lcom/android/server/enterprise/EnterpriseDeviceManagerServiceImpl$Injector;->addLazySystemService(Ljava/lang/String;Lcom/android/server/enterprise/EnterpriseServiceCallback;)V
 
@@ -3465,7 +3434,7 @@
 
     move-result-object v1
 
-    invoke-static {v4, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v3, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
 
     invoke-virtual {v0}, Ljava/lang/Throwable;->printStackTrace()V
 
diff --git a/smali_classes2/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali b/smali_classes2/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali
index d251f194..b97af1b8 100644
--- a/smali_classes2/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali
+++ b/smali_classes2/com/android/server/enterprise/container/KnoxMUMContainerPolicy.smali
@@ -11205,115 +11205,11 @@
 .end method
 
 .method public final isDualDarLicenseLockedCase()Z
-    .locals 5
-
-    const/4 v0, 0x0
-
-    invoke-static {v0}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result v1
-
-    const/4 v2, 0x1
-
-    if-eqz v1, :cond_0
-
-    invoke-static {v0}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    return v2
-
-    :cond_0
-    invoke-virtual {p0}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getDevicePolicyService()Landroid/app/admin/DevicePolicyManager;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Landroid/app/admin/DevicePolicyManager;->isOrganizationOwnedDeviceWithManagedProfile()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_2
-
-    const-string v1, "device_policy"
-
-    invoke-static {v1}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v1
-
-    invoke-static {v1}, Landroid/app/admin/IDevicePolicyManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/app/admin/IDevicePolicyManager;
-
-    move-result-object v1
-
-    invoke-virtual {p0}, Lcom/android/server/enterprise/container/KnoxMUMContainerPolicy;->getUserManagerService()Landroid/os/UserManager;
-
-    move-result-object p0
-
-    invoke-virtual {p0, v0}, Landroid/os/UserManager;->getProfiles(I)Ljava/util/List;
-
-    move-result-object p0
-
-    invoke-interface {p0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object p0
-
-    :cond_1
-    :goto_0
-    invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_2
-
-    invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Landroid/content/pm/UserInfo;
-
-    invoke-virtual {v3}, Landroid/content/pm/UserInfo;->getUserHandle()Landroid/os/UserHandle;
-
-    move-result-object v3
-
-    invoke-virtual {v3}, Landroid/os/UserHandle;->getIdentifier()I
-
-    move-result v3
-
-    invoke-static {v3}, Lcom/samsung/android/knox/SemPersonaManager;->isKnoxId(I)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_1
-
-    invoke-static {v3}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_1
-
-    if-eqz v1, :cond_1
-
-    :try_start_0
-    invoke-interface {v1, v3}, Landroid/app/admin/IDevicePolicyManager;->isProfileOwnerOfOrganizationOwnedDeviceMDM(I)Z
-
-    move-result v3
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    if-eqz v3, :cond_1
-
-    return v2
-
-    :catch_0
-    move-exception v3
-
-    invoke-virtual {v3}, Landroid/os/RemoteException;->printStackTrace()V
+    .locals 0
 
-    goto :goto_0
+    const/4 p0, 0x0
 
-    :cond_2
-    return v0
+    return p0
 .end method
 
 .method public isEmergencyModeSupported()Z
diff --git a/smali_classes2/com/android/server/enterprise/security/PasswordPolicy.smali b/smali_classes2/com/android/server/enterprise/security/PasswordPolicy.smali
index 7167245e..92807406 100644
--- a/smali_classes2/com/android/server/enterprise/security/PasswordPolicy.smali
+++ b/smali_classes2/com/android/server/enterprise/security/PasswordPolicy.smali
@@ -8327,9 +8327,7 @@
 .method public final isDualDarDoEnabled()Z
     .locals 0
 
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result p0
+    const/4 p0, 0x0
 
     return p0
 .end method
diff --git a/smali_classes2/com/android/server/knox/dar/DarManagerService.smali b/smali_classes2/com/android/server/knox/dar/DarManagerService.smali
index 864bf487..2df98b2b 100644
--- a/smali_classes2/com/android/server/knox/dar/DarManagerService.smali
+++ b/smali_classes2/com/android/server/knox/dar/DarManagerService.smali
@@ -183,14 +183,6 @@
 
     iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mVirtualLockImpl:Lcom/android/server/knox/dar/VirtualLockImpl;
 
-    new-instance v0, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-direct {v0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;-><init>(Lcom/android/server/knox/dar/DarManagerService$Injector;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/DarManagerService;->mDualDarDoManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->prepareDualDARService()V
-
     new-instance p1, Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;
 
     invoke-direct {p1}, Lcom/android/server/knox/zt/devicetrust/EndpointMonitorImpl;-><init>()V
@@ -2264,20 +2256,8 @@
 .method public final isDualDarDoSupported()Z
     .locals 0
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/DarManagerService;->getDualDarManager()Lcom/android/server/knox/dar/ddar/core/DualDarDoManagerImpl;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :cond_0
     const/4 p0, 0x0
 
-    :goto_0
     return p0
 .end method
 
@@ -2840,18 +2820,6 @@
     return-void
 .end method
 
-.method public final prepareDualDARService()V
-    .locals 1
-
-    const-string p0, "DarManagerService_DUAL_DAR"
-
-    const-string/jumbo v0, "prepare DualDAR DO Service"
-
-    invoke-static {p0, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-.end method
-
 .method public final prepareEndpointMonitorService()V
     .locals 1
 
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/DDLog$Logger$2.smali b/smali_classes2/com/android/server/knox/dar/ddar/DDLog$Logger$2.smali
index 47cdeed6..90118812 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/DDLog$Logger$2.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/DDLog$Logger$2.smali
@@ -7,18 +7,6 @@
 .field public final synthetic this$0:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
 
 
-# direct methods
-.method public constructor <init>(Lcom/android/server/knox/dar/ddar/DDLog$Logger;Ljava/lang/String;)V
-    .locals 0
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;->this$0:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    invoke-direct {p0, p2}, Ljava/lang/Thread;-><init>(Ljava/lang/String;)V
-
-    return-void
-.end method
-
-
 # virtual methods
 .method public run()V
     .locals 4
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/DDLog$Logger.smali b/smali_classes2/com/android/server/knox/dar/ddar/DDLog$Logger.smali
index 8ee1e44d..c789a7ec 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/DDLog$Logger.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/DDLog$Logger.smali
@@ -14,12 +14,8 @@
 
 .field public fos:Ljava/io/OutputStreamWriter;
 
-.field public logWorker:Ljava/lang/Thread;
-
 .field public loggerRunning:Z
 
-.field public mCtx:Landroid/content/Context;
-
 .field public final storageDir:Ljava/io/File;
 
 .field public storeQ:Ljava/util/concurrent/BlockingQueue;
@@ -72,89 +68,6 @@
     return-void
 .end method
 
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 3
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    new-instance v0, Ljava/util/concurrent/LinkedBlockingQueue;
-
-    invoke-direct {v0}, Ljava/util/concurrent/LinkedBlockingQueue;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->storeQ:Ljava/util/concurrent/BlockingQueue;
-
-    const/4 v0, 0x0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->mCtx:Landroid/content/Context;
-
-    new-instance v1, Ljava/io/File;
-
-    const-string v2, "/data/log"
-
-    invoke-direct {v1, v2}, Ljava/io/File;-><init>(Ljava/lang/String;)V
-
-    iput-object v1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->storageDir:Ljava/io/File;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->currentFile:Ljava/io/File;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->cos:Lcom/android/server/knox/dar/ddar/DDLog$CountingOutputStream;
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->fos:Ljava/io/OutputStreamWriter;
-
-    const/4 v0, 0x0
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->loggerRunning:Z
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;
-
-    const-string v1, "Log Worker"
-
-    invoke-direct {v0, p0, v1}, Lcom/android/server/knox/dar/ddar/DDLog$Logger$2;-><init>(Lcom/android/server/knox/dar/ddar/DDLog$Logger;Ljava/lang/String;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->logWorker:Ljava/lang/Thread;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->mCtx:Landroid/content/Context;
-
-    return-void
-.end method
-
-.method public static declared-synchronized createInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-    .locals 2
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    invoke-direct {v1, p0}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;-><init>(Landroid/content/Context;)V
-
-    sput-object v1, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    invoke-virtual {v1}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->start()V
-
-    :cond_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-
-    throw p0
-.end method
-
 .method public static enqueLog(Ljava/lang/String;)V
     .locals 1
 
@@ -305,43 +218,6 @@
     return-object p0
 .end method
 
-.method public final getDeviceVersion()Ljava/lang/String;
-    .locals 3
-
-    const-string/jumbo p0, "ro.build.PDA"
-
-    const-string v0, "Unknown"
-
-    invoke-static {p0, v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    const/16 v0, 0x5f
-
-    invoke-virtual {p0, v0}, Ljava/lang/String;->indexOf(I)I
-
-    move-result v1
-
-    const/4 v2, -0x1
-
-    if-eq v1, v2, :cond_0
-
-    const/4 v1, 0x0
-
-    invoke-virtual {p0, v0}, Ljava/lang/String;->indexOf(I)I
-
-    move-result v0
-
-    invoke-virtual {p0, v1, v0}, Ljava/lang/String;->substring(II)Ljava/lang/String;
-
-    move-result-object p0
-
-    :cond_0
-    return-object p0
-.end method
-
 .method public final internalClose()V
     .locals 2
 
@@ -854,37 +730,3 @@
 
     return p0
 .end method
-
-.method public start()V
-    .locals 2
-
-    const/4 v0, 0x1
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->loggerRunning:Z
-
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->logWorker:Ljava/lang/Thread;
-
-    invoke-virtual {v1, v0}, Ljava/lang/Thread;->setDaemon(Z)V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->logWorker:Ljava/lang/Thread;
-
-    invoke-virtual {v0}, Ljava/lang/Thread;->start()V
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->getDeviceVersion()Ljava/lang/String;
-
-    move-result-object p0
-
-    filled-new-array {p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string v0, "DDAR Logging Started [DeviceVersion : %s]%n"
-
-    invoke-static {v0, p0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->enqueLog(Ljava/lang/String;)V
-
-    return-void
-.end method
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/DDLog$LoggerProxy.smali b/smali_classes2/com/android/server/knox/dar/ddar/DDLog$LoggerProxy.smali
index 9f2592ee..8846497e 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/DDLog$LoggerProxy.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/DDLog$LoggerProxy.smali
@@ -3,14 +3,6 @@
 .source "DDLog.java"
 
 
-# static fields
-.field public static mInstance:Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-
-# instance fields
-.field public final mContext:Landroid/content/Context;
-
-
 # direct methods
 .method public static constructor <clinit>()V
     .locals 0
@@ -18,59 +10,6 @@
     return-void
 .end method
 
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 2
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    const-string v0, "DDLog"
-
-    const-string v1, "Logger ready"
-
-    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;->mContext:Landroid/content/Context;
-
-    invoke-static {p1}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->createInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/DDLog$Logger;
-
-    return-void
-.end method
-
-.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-    .locals 2
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-    invoke-direct {v1, p0}, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;-><init>(Landroid/content/Context;)V
-
-    sput-object v1, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-    :cond_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;->mInstance:Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-
-    throw p0
-.end method
-
 
 # virtual methods
 .method public onMessage(ILjava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/DDLog.smali b/smali_classes2/com/android/server/knox/dar/ddar/DDLog.smali
index 60ec5ba3..5b7553c0 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/DDLog.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/DDLog.smali
@@ -221,39 +221,3 @@
 
     return p0
 .end method
-
-.method public static varargs w(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-    .locals 1
-
-    invoke-static {p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p1
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {p2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v0, ": "
-
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v0, "\n"
-
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-static {p2}, Lcom/android/server/knox/dar/ddar/DDLog$Logger;->-$$Nest$smenqueLog(Ljava/lang/String;)V
-
-    invoke-static {p0, p1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
-
-    move-result p0
-
-    return p0
-.end method
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector.smali b/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector.smali
index 19387751..fe047269 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector.smali
@@ -7,18 +7,6 @@
 .field public final mContext:Landroid/content/Context;
 
 
-# direct methods
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;->mContext:Landroid/content/Context;
-
-    return-void
-.end method
-
-
 # virtual methods
 .method public binderClearCallingIdentity()J
     .locals 2
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerImpl.smali b/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerImpl.smali
index 222f9838..b14342a7 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerImpl.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerImpl.smali
@@ -58,18 +58,6 @@
     return-void
 .end method
 
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 1
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;
-
-    invoke-direct {v0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;-><init>(Landroid/content/Context;)V
-
-    invoke-direct {p0, v0}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;-><init>(Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;)V
-
-    return-void
-.end method
-
 .method public constructor <init>(Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl$Injector;)V
     .locals 2
 
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerProxy.smali b/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerProxy.smali
index 692333d5..37e3b9f1 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerProxy.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/core/DualDarManagerProxy.smali
@@ -6,12 +6,8 @@
 # static fields
 .field public static final DEBUG:Z
 
-.field public static sInstance:Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
 
 # instance fields
-.field public mContext:Landroid/content/Context;
-
 .field public mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
 
 
@@ -62,67 +58,6 @@
     return-void
 .end method
 
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 3
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    const/4 v0, 0x0
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    const-string v1, "DualDarManagerProxy"
-
-    const-string v2, "DualDarManagerProxy created"
-
-    invoke-static {v1, v2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    invoke-direct {v0, p1}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;-><init>(Landroid/content/Context;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->mDualDarManagerImpl:Lcom/android/server/knox/dar/ddar/core/DualDarManagerImpl;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->mContext:Landroid/content/Context;
-
-    return-void
-.end method
-
-.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-    .locals 2
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->sInstance:Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-    invoke-direct {v1, p0}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;-><init>(Landroid/content/Context;)V
-
-    sput-object v1, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->sInstance:Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-    :cond_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->sInstance:Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-
-    throw p0
-.end method
-
 
 # virtual methods
 .method public final enforceCallingUser(I)V
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/fsm/StateMachineImpl.smali b/smali_classes2/com/android/server/knox/dar/ddar/fsm/StateMachineImpl.smali
index 8b5b35d8..83a1ccb3 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/fsm/StateMachineImpl.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/fsm/StateMachineImpl.smali
@@ -8,8 +8,6 @@
 
 
 # instance fields
-.field public context:Landroid/content/Context;
-
 .field public currentStateMap:Ljava/util/Map;
 
 .field public listenerLock:Ljava/lang/Object;
@@ -178,83 +176,8 @@
     return-void
 .end method
 
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 1
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->currentStateMap:Ljava/util/Map;
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->previousStateMap:Ljava/util/Map;
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->context:Landroid/content/Context;
-
-    new-instance p1, Ljava/util/ArrayList;
-
-    invoke-direct {p1}, Ljava/util/ArrayList;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateChangeListeners:Ljava/util/List;
-
-    new-instance p1, Ljava/lang/Object;
-
-    invoke-direct {p1}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateLock:Ljava/lang/Object;
-
-    new-instance p1, Ljava/lang/Object;
-
-    invoke-direct {p1}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->listenerLock:Ljava/lang/Object;
-
-    return-void
-.end method
-
 
 # virtual methods
-.method public addStateChangeListener(Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl$StateChangeListener;)V
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->listenerLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateChangeListeners:Ljava/util/List;
-
-    invoke-interface {v1, p1}, Ljava/util/List;->contains(Ljava/lang/Object;)Z
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->stateChangeListeners:Ljava/util/List;
-
-    invoke-interface {p0, p1}, Ljava/util/List;->add(Ljava/lang/Object;)Z
-
-    :cond_0
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
 .method public getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
     .locals 2
 
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/fsm/StateMachineProxy.smali b/smali_classes2/com/android/server/knox/dar/ddar/fsm/StateMachineProxy.smali
index 82650643..7db507fe 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/fsm/StateMachineProxy.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/fsm/StateMachineProxy.smali
@@ -6,10 +6,6 @@
 .implements Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl$StateChangeListener;
 
 
-# static fields
-.field public static mInstance:Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-
 # instance fields
 .field public context:Landroid/content/Context;
 
@@ -25,67 +21,6 @@
     return-void
 .end method
 
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 1
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    const/4 v0, 0x0
-
-    iput-boolean v0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->initiateState:Z
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->context:Landroid/content/Context;
-
-    new-instance v0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-
-    invoke-direct {v0, p1}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;-><init>(Landroid/content/Context;)V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->stateMachine:Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->setInitialState()Z
-
-    iget-object p1, p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->stateMachine:Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;
-
-    invoke-virtual {p1, p0}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl;->addStateChangeListener(Lcom/android/server/knox/dar/ddar/fsm/StateMachineImpl$StateChangeListener;)V
-
-    return-void
-.end method
-
-.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-    .locals 2
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->mInstance:Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    invoke-direct {v1, p0}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;-><init>(Landroid/content/Context;)V
-
-    sput-object v1, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->mInstance:Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    :cond_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->mInstance:Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-
-    throw p0
-.end method
-
 
 # virtual methods
 .method public final enforceCallingUser(I)V
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/proxy/DualDARComnService.smali b/smali_classes2/com/android/server/knox/dar/ddar/proxy/DualDARComnService.smali
index 9e78b422..94046606 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/proxy/DualDARComnService.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/proxy/DualDARComnService.smali
@@ -1714,25 +1714,8 @@
 .end method
 
 .method public final getDualDARPolicyService()Ljava/util/Optional;
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    if-nez v0, :cond_0
-
-    const-string v0, "DualDARPolicy"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    move-result-object v0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
+    .locals 0
 
-    :cond_0
     iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
 
     invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
@@ -2109,157 +2092,9 @@
     return v0
 .end method
 
-.method public final init()V
-    .locals 15
-
-    const/4 v0, 0x0
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    const-string v1, "DualDARComnService"
-
-    const-string v2, "initialize"
-
-    invoke-static {v1, v2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    new-instance v6, Landroid/content/IntentFilter;
-
-    invoke-direct {v6}, Landroid/content/IntentFilter;-><init>()V
-
-    const-string v0, "android.intent.action.USER_STARTED"
-
-    invoke-virtual {v6, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string v0, "android.intent.action.USER_REMOVED"
-
-    invoke-virtual {v6, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string v0, "android.intent.action.USER_ADDED"
-
-    invoke-virtual {v6, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    iget-object v3, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    iget-object v4, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mUserBroadcastReceiver:Landroid/content/BroadcastReceiver;
-
-    sget-object v5, Landroid/os/UserHandle;->ALL:Landroid/os/UserHandle;
-
-    const/4 v7, 0x0
-
-    const/4 v8, 0x0
-
-    invoke-virtual/range {v3 .. v8}, Landroid/content/Context;->registerReceiverAsUser(Landroid/content/BroadcastReceiver;Landroid/os/UserHandle;Landroid/content/IntentFilter;Ljava/lang/String;Landroid/os/Handler;)Landroid/content/Intent;
-
-    new-instance v12, Landroid/content/IntentFilter;
-
-    invoke-direct {v12}, Landroid/content/IntentFilter;-><init>()V
-
-    const-string v0, "android.intent.action.PACKAGE_ADDED"
-
-    invoke-virtual {v12, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string v0, "android.intent.action.PACKAGE_REMOVED"
-
-    invoke-virtual {v12, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string v0, "android.intent.action.PACKAGE_FULLY_REMOVED"
-
-    invoke-virtual {v12, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string v0, "android.intent.action.PACKAGE_CHANGED"
-
-    invoke-virtual {v12, v0}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
-    const-string/jumbo v0, "package"
-
-    invoke-virtual {v12, v0}, Landroid/content/IntentFilter;->addDataScheme(Ljava/lang/String;)V
-
-    iget-object v9, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    iget-object v10, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mPackageBroadcastReceiver:Landroid/content/BroadcastReceiver;
-
-    sget-object v11, Landroid/os/UserHandle;->ALL:Landroid/os/UserHandle;
-
-    const/4 v13, 0x0
-
-    const/4 v14, 0x0
-
-    invoke-virtual/range {v9 .. v14}, Landroid/content/Context;->registerReceiverAsUser(Landroid/content/BroadcastReceiver;Landroid/os/UserHandle;Landroid/content/IntentFilter;Ljava/lang/String;Landroid/os/Handler;)Landroid/content/Intent;
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->init()V
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->initKnownProxyAgents()V
-
-    return-void
-.end method
-
-.method public final initDualDARAgentsIfRequired()V
-    .locals 4
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isDualDAREnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManager;
-
-    move-result-object p0
-
-    const-string v0, "com.samsung.android.knox.containercore"
-
-    const-string/jumbo v1, "proxyAgent.class"
-
-    const-string v2, "KNOXCORE_PROXY_AGENT"
-
-    const/4 v3, 0x0
-
-    invoke-virtual {p0, v2, v3, v0, v1}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyManager;->registerAgentByMetadata(Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;)Z
-
-    :cond_0
-    return-void
-.end method
-
-.method public final initKnownProxyAgents()V
-    .locals 3
-
-    const/4 v0, 0x0
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    const-string v1, "DualDARComnService"
-
-    const-string v2, "initKnownProxyAgents"
-
-    invoke-static {v1, v2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->initDualDARAgentsIfRequired()V
-
-    return-void
-.end method
-
 .method public final isDualDAREnabled(I)Z
     .locals 0
 
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
     const/4 p0, 0x0
 
     return p0
@@ -2919,9 +2754,17 @@
 .end method
 
 .method public systemReady()V
-    .locals 0
+    .locals 2
+
+    const/4 p0, 0x0
+
+    new-array p0, p0, [Ljava/lang/Object;
+
+    const-string v0, "DualDARComnService"
+
+    const-string v1, "device does not support DualDAR"
 
-    invoke-virtual {p0}, Lcom/android/server/knox/dar/ddar/proxy/DualDARComnService;->init()V
+    invoke-static {v0, v1, p0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
 
     return-void
 .end method
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy.smali b/smali_classes2/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy.smali
index 2389bfc9..1d169cc6 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy.smali
@@ -3,10 +3,6 @@
 .source "DualDARPlatformProxy.java"
 
 
-# static fields
-.field public static mInstance:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-
 # instance fields
 .field public final mContext:Landroid/content/Context;
 
@@ -38,65 +34,6 @@
     return-void
 .end method
 
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 3
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    const/4 v0, 0x0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    const/4 v0, 0x0
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    const-string v1, "DualDARPlatformProxy"
-
-    const-string v2, "DualDARPlatformProxy() constructor"
-
-    invoke-static {v1, v2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    iput-object p1, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mContext:Landroid/content/Context;
-
-    return-void
-.end method
-
-.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-    .locals 2
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mInstance:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    invoke-direct {v1, p0}, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;-><init>(Landroid/content/Context;)V
-
-    sput-object v1, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mInstance:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    :cond_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mInstance:Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-
-    throw p0
-.end method
-
 .method private synthetic lambda$getConfig$0(Landroid/os/Bundle;Lcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
     .locals 4
 
@@ -431,25 +368,8 @@
 .end method
 
 .method public final getDualDARPolicyService()Ljava/util/Optional;
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    if-nez v0, :cond_0
-
-    const-string v0, "DualDARPolicy"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    move-result-object v0
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
+    .locals 0
 
-    :cond_0
     iget-object p0, p0, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
 
     invoke-static {p0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/proxy/SystemProxyAgent.smali b/smali_classes2/com/android/server/knox/dar/ddar/proxy/SystemProxyAgent.smali
index 2dc2c1d0..50c5dbad 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/proxy/SystemProxyAgent.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/proxy/SystemProxyAgent.smali
@@ -59,84 +59,6 @@
 
 
 # virtual methods
-.method public init()V
-    .locals 2
-
-    invoke-super {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->onCreate()V
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-    move-result-object v0
-
-    const-string v1, "TA_PROXY_SERVICE"
-
-    invoke-virtual {p0, v1, v0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/nativedaemon/DualDARDaemonProxy;
-
-    move-result-object v0
-
-    const-string v1, "DAEMON_PROXY_SERVICE"
-
-    invoke-virtual {p0, v1, v0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/fsm/StateMachineProxy;
-
-    move-result-object v0
-
-    const-string v1, "STATE_MACHINE_SERVICE"
-
-    invoke-virtual {p0, v1, v0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/DDLog$LoggerProxy;
-
-    move-result-object v0
-
-    const-string v1, "DDAR_LOG_SERVICE"
-
-    invoke-virtual {p0, v1, v0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/DDCache;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/DDCache;
-
-    move-result-object v0
-
-    const-string v1, "DDAR_CACHE_SERVICE"
-
-    invoke-virtual {p0, v1, v0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/proxy/DualDARPlatformProxy;
-
-    move-result-object v0
-
-    const-string v1, "DDAR_PLATFORM_SERVICE"
-
-    invoke-virtual {p0, v1, v0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    iget-object v0, p0, Lcom/android/server/knox/dar/ddar/proxy/SystemProxyAgent;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;->getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/core/DualDarManagerProxy;
-
-    move-result-object v0
-
-    const-string v1, "DDAR_MANAGER_SERVICE"
-
-    invoke-virtual {p0, v1, v0}, Lcom/samsung/android/knox/dar/ddar/proxy/KnoxProxyAgent;->register(Ljava/lang/String;Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;)Z
-
-    return-void
-.end method
-
 .method public relay(ILjava/lang/String;Ljava/lang/String;Landroid/os/Bundle;)Landroid/os/Bundle;
     .locals 6
 
diff --git a/smali_classes2/com/android/server/knox/dar/ddar/ta/TAProxy.smali b/smali_classes2/com/android/server/knox/dar/ddar/ta/TAProxy.smali
index 84a06fc9..8341f318 100644
--- a/smali_classes2/com/android/server/knox/dar/ddar/ta/TAProxy.smali
+++ b/smali_classes2/com/android/server/knox/dar/ddar/ta/TAProxy.smali
@@ -3,12 +3,6 @@
 .source "TAProxy.java"
 
 
-# static fields
-.field public static mContext:Landroid/content/Context;
-
-.field public static mInstance:Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-
 # instance fields
 .field public iSehDdar:Lvendor/samsung/hardware/tlc/ddar/ISehDdar;
 
@@ -22,67 +16,6 @@
     return-void
 .end method
 
-.method public constructor <init>(Landroid/content/Context;)V
-    .locals 2
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/dar/ddar/proxy/IProxyAgentService;-><init>()V
-
-    new-instance v0, Ljava/util/HashMap;
-
-    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V
-
-    iput-object v0, p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mTAMap:Ljava/util/Map;
-
-    const/4 p0, 0x0
-
-    new-array p0, p0, [Ljava/lang/Object;
-
-    const-string v0, "TAProxy"
-
-    const-string v1, "TAProxy() called updated"
-
-    invoke-static {v0, v1, p0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sput-object p1, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mContext:Landroid/content/Context;
-
-    return-void
-.end method
-
-.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-    .locals 2
-
-    const-class v0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-    monitor-enter v0
-
-    :try_start_0
-    sget-object v1, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mInstance:Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-    if-nez v1, :cond_0
-
-    new-instance v1, Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-    invoke-direct {v1, p0}, Lcom/android/server/knox/dar/ddar/ta/TAProxy;-><init>(Landroid/content/Context;)V
-
-    sput-object v1, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mInstance:Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-
-    :cond_0
-    sget-object p0, Lcom/android/server/knox/dar/ddar/ta/TAProxy;->mInstance:Lcom/android/server/knox/dar/ddar/ta/TAProxy;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit v0
-
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-
-    throw p0
-.end method
-
 
 # virtual methods
 .method public final createTANative(Landroid/os/Bundle;I)V
diff --git a/smali_classes2/com/android/server/knox/dar/sdp/SDPLog.smali b/smali_classes2/com/android/server/knox/dar/sdp/SDPLog.smali
index a654b372..c984562b 100644
--- a/smali_classes2/com/android/server/knox/dar/sdp/SDPLog.smali
+++ b/smali_classes2/com/android/server/knox/dar/sdp/SDPLog.smali
@@ -172,18 +172,6 @@
     return-void
 .end method
 
-.method public static i(Ljava/lang/String;Ljava/lang/String;)V
-    .locals 1
-
-    new-instance v0, Ljava/lang/Throwable;
-
-    invoke-direct {v0}, Ljava/lang/Throwable;-><init>()V
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
-
-    return-void
-.end method
-
 .method public static i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
     .locals 3
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10.smali
index 8cb261f0..a62c7314 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10.smali
@@ -3,38 +3,36 @@
 .source "R8$$SyntheticClass"
 
 # interfaces
-.implements Ljava/lang/Runnable;
+.implements Ljava/util/function/Function;
 
 
 # instance fields
-.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-.field public final synthetic f$1:J
+.field public final synthetic f$0:I
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;J)V
+.method public synthetic constructor <init>(I)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iput-wide p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$1:J
+    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$0:I
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final run()V
-    .locals 3
+.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
+    .locals 0
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$0:I
 
-    iget-wide v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;->f$1:J
+    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
 
-    invoke-static {v0, v1, v2}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$hxFRMJ-qy23Ksj0E5uph7lZu_Ww(Lcom/android/server/locksettings/LockSettingsService;J)V
+    invoke-static {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$8J6KUr7Op7Q4laSYt_FWDwOYHlY(ILcom/android/server/pm/PersonaManagerService;)Ljava/lang/Boolean;
 
-    return-void
+    move-result-object p0
+
+    return-object p0
 .end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11.smali
index b308616c..1bb26a01 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11.smali
@@ -3,34 +3,32 @@
 .source "R8$$SyntheticClass"
 
 # interfaces
-.implements Ljava/util/function/Function;
+.implements Ljava/util/function/Supplier;
 
 
 # instance fields
-.field public final synthetic f$0:I
+.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
 
 
 # direct methods
-.method public synthetic constructor <init>(I)V
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$0:I
+    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
+.method public final get()Ljava/lang/Object;
     .locals 0
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$0:I
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
-
-    invoke-static {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$8J6KUr7Op7Q4laSYt_FWDwOYHlY(ILcom/android/server/pm/PersonaManagerService;)Ljava/lang/Boolean;
+    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$jAgFSB3vtTGARVwnrGilX8PbFIU(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
 
     move-result-object p0
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali
index 3b499832..da9f6695 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12.smali
@@ -28,7 +28,7 @@
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$jAgFSB3vtTGARVwnrGilX8PbFIU(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
+    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$HH6I5RSCFyZQ3CFAaJW-s_oHOas(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
 
     move-result-object p0
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali
index 1862d179..1320d55f 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13.smali
@@ -28,7 +28,7 @@
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$HH6I5RSCFyZQ3CFAaJW-s_oHOas(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
+    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$5o0h0fldPK5obVEr7xMeuZWYrrw(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
 
     move-result-object p0
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali
index 5aebd8cd..55e5e5ad 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14.smali
@@ -3,32 +3,34 @@
 .source "R8$$SyntheticClass"
 
 # interfaces
-.implements Ljava/util/function/Supplier;
+.implements Ljava/util/function/Function;
 
 
 # instance fields
-.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
+.field public final synthetic f$0:I
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;)V
+.method public synthetic constructor <init>(I)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->f$0:I
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final get()Ljava/lang/Object;
+.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
     .locals 0
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;->f$0:I
 
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$5o0h0fldPK5obVEr7xMeuZWYrrw(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
+    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
+
+    invoke-static {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$S3R_qBk2E4mhsHEfwm4195vN0Z8(ILcom/android/server/pm/PersonaManagerService;)Ljava/lang/Boolean;
 
     move-result-object p0
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15.smali
index 46bddc59..9c6b8881 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15.smali
@@ -3,34 +3,32 @@
 .source "R8$$SyntheticClass"
 
 # interfaces
-.implements Ljava/util/function/Function;
+.implements Ljava/util/function/Supplier;
 
 
 # instance fields
-.field public final synthetic f$0:I
+.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
 
 
 # direct methods
-.method public synthetic constructor <init>(I)V
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15;->f$0:I
+    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
+.method public final get()Ljava/lang/Object;
     .locals 0
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15;->f$0:I
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
-
-    invoke-static {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$S3R_qBk2E4mhsHEfwm4195vN0Z8(ILcom/android/server/pm/PersonaManagerService;)Ljava/lang/Boolean;
+    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$ftbV1-uUdNATE66srgaXyvwoxsA(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
 
     move-result-object p0
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda16.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda16.smali
index 402d3cf3..eba5bb4c 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda16.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda16.smali
@@ -3,34 +3,24 @@
 .source "R8$$SyntheticClass"
 
 # interfaces
-.implements Ljava/util/function/Supplier;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
+.implements Ljava/lang/Runnable;
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;)V
+.method public synthetic constructor <init>()V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda16;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
     return-void
 .end method
 
 
 # virtual methods
-.method public final get()Ljava/lang/Object;
+.method public final run()V
     .locals 0
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda16;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+    invoke-static {}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$S-_jB2YpEnUEFRdAmvlGBYll4BM()V
 
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$ftbV1-uUdNATE66srgaXyvwoxsA(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
+    return-void
 .end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17.smali
index 754704b0..30abdefb 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17.smali
@@ -6,21 +6,35 @@
 .implements Ljava/lang/Runnable;
 
 
+# instance fields
+.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
+
+.field public final synthetic f$1:I
+
+
 # direct methods
-.method public synthetic constructor <init>()V
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;I)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
+    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+
+    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17;->f$1:I
+
     return-void
 .end method
 
 
 # virtual methods
 .method public final run()V
-    .locals 0
+    .locals 1
+
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17;->f$1:I
 
-    invoke-static {}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$S-_jB2YpEnUEFRdAmvlGBYll4BM()V
+    invoke-static {v0, p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$LO9iog_IUisZ78RO-XSxShUod0g(Lcom/android/server/locksettings/LockSettingsService;I)V
 
     return-void
 .end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18.smali
deleted file mode 100644
index fba39397..00000000
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18.smali
+++ /dev/null
@@ -1,40 +0,0 @@
-.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18;
-.super Ljava/lang/Object;
-.source "R8$$SyntheticClass"
-
-# interfaces
-.implements Ljava/lang/Runnable;
-
-
-# instance fields
-.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-.field public final synthetic f$1:I
-
-
-# direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;I)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iput p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18;->f$1:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final run()V
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18;->f$1:I
-
-    invoke-static {v0, p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$LO9iog_IUisZ78RO-XSxShUod0g(Lcom/android/server/locksettings/LockSettingsService;I)V
-
-    return-void
-.end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali
index f1ca8af8..aa87ab07 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4.smali
@@ -9,20 +9,20 @@
 # instance fields
 .field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-.field public final synthetic f$1:Landroid/app/admin/PasswordMetrics;
+.field public final synthetic f$1:Lcom/android/internal/widget/LockscreenCredential;
 
 .field public final synthetic f$2:I
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/app/admin/PasswordMetrics;I)V
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
     iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Landroid/app/admin/PasswordMetrics;
+    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Lcom/android/internal/widget/LockscreenCredential;
 
     iput p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$2:I
 
@@ -36,11 +36,11 @@
 
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Landroid/app/admin/PasswordMetrics;
+    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$1:Lcom/android/internal/widget/LockscreenCredential;
 
     iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;->f$2:I
 
-    invoke-static {v0, v1, p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$lhnIbXn_WLeNvcM9UNm1Go_WitU(Lcom/android/server/locksettings/LockSettingsService;Landroid/app/admin/PasswordMetrics;I)V
+    invoke-static {v0, v1, p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$VD8WCBcp5muxNlCLBfGt2efXBkA(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
 
     return-void
 .end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5.smali
index c1406e1b..e65880b5 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5.smali
@@ -3,44 +3,36 @@
 .source "R8$$SyntheticClass"
 
 # interfaces
-.implements Ljava/lang/Runnable;
+.implements Ljava/util/function/Function;
 
 
 # instance fields
-.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-.field public final synthetic f$1:Lcom/android/internal/widget/LockscreenCredential;
-
-.field public final synthetic f$2:I
+.field public final synthetic f$0:I
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
+.method public synthetic constructor <init>(I)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iput-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;->f$1:Lcom/android/internal/widget/LockscreenCredential;
-
-    iput p3, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;->f$2:I
+    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;->f$0:I
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final run()V
-    .locals 2
+.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
+    .locals 0
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;->f$0:I
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;->f$1:Lcom/android/internal/widget/LockscreenCredential;
+    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;->f$2:I
+    invoke-static {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$N7-0oVUDV5oj5679Vm7AnP0KDhU(ILcom/android/server/pm/PersonaManagerService;)Ljava/lang/Boolean;
 
-    invoke-static {v0, v1, p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$VD8WCBcp5muxNlCLBfGt2efXBkA(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
+    move-result-object p0
 
-    return-void
+    return-object p0
 .end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6.smali
index 4cdcd427..77eb475c 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6.smali
@@ -3,34 +3,32 @@
 .source "R8$$SyntheticClass"
 
 # interfaces
-.implements Ljava/util/function/Function;
+.implements Ljava/util/function/Supplier;
 
 
 # instance fields
-.field public final synthetic f$0:I
+.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
 
 
 # direct methods
-.method public synthetic constructor <init>(I)V
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;->f$0:I
+    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
+.method public final get()Ljava/lang/Object;
     .locals 0
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;->f$0:I
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
-
-    invoke-static {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$N7-0oVUDV5oj5679Vm7AnP0KDhU(ILcom/android/server/pm/PersonaManagerService;)Ljava/lang/Boolean;
+    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$oRgKhy8vTNeOvC7Y_hIhE6PuKDc(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
 
     move-result-object p0
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7.smali
index fe92e369..343c3ca0 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7.smali
@@ -28,7 +28,7 @@
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$oRgKhy8vTNeOvC7Y_hIhE6PuKDc(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
+    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$qD_BOIuBIEMRTBn8IUhG7KUYWOE(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
 
     move-result-object p0
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8.smali
index 7fa069bf..5d58a48c 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8.smali
@@ -3,34 +3,34 @@
 .source "R8$$SyntheticClass"
 
 # interfaces
-.implements Ljava/util/function/Supplier;
+.implements Ljava/util/function/Consumer;
 
 
 # instance fields
-.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
+.field public final synthetic f$0:I
 
 
 # direct methods
-.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;)V
+.method public synthetic constructor <init>(I)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;->f$0:I
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final get()Ljava/lang/Object;
+.method public final accept(Ljava/lang/Object;)V
     .locals 0
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;->f$0:I
 
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$qD_BOIuBIEMRTBn8IUhG7KUYWOE(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
+    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
 
-    move-result-object p0
+    invoke-static {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$EBrAdoJ0AkatDyv8RAlOdsxiMzw(ILcom/android/server/pm/PersonaManagerService;)V
 
-    return-object p0
+    return-void
 .end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9.smali
index 5227182f..7f80f846 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9.smali
@@ -3,34 +3,38 @@
 .source "R8$$SyntheticClass"
 
 # interfaces
-.implements Ljava/util/function/Consumer;
+.implements Ljava/lang/Runnable;
 
 
 # instance fields
-.field public final synthetic f$0:I
+.field public final synthetic f$0:Lcom/android/server/locksettings/LockSettingsService;
+
+.field public final synthetic f$1:J
 
 
 # direct methods
-.method public synthetic constructor <init>(I)V
+.method public synthetic constructor <init>(Lcom/android/server/locksettings/LockSettingsService;J)V
     .locals 0
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9;->f$0:I
+    iput-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/locksettings/LockSettingsService;
+
+    iput-wide p2, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9;->f$1:J
 
     return-void
 .end method
 
 
 # virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 0
+.method public final run()V
+    .locals 3
 
-    iget p0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9;->f$0:I
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9;->f$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    check-cast p1, Lcom/android/server/pm/PersonaManagerService;
+    iget-wide v1, p0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9;->f$1:J
 
-    invoke-static {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$EBrAdoJ0AkatDyv8RAlOdsxiMzw(ILcom/android/server/pm/PersonaManagerService;)V
+    invoke-static {v0, v1, v2}, Lcom/android/server/locksettings/LockSettingsService;->$r8$lambda$hxFRMJ-qy23Ksj0E5uph7lZu_Ww(Lcom/android/server/locksettings/LockSettingsService;J)V
 
     return-void
 .end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$3.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$3.smali
index 33f80f5a..f59857c4 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$3.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$3.smali
@@ -21,7 +21,7 @@
 
 # virtual methods
 .method public onReceive(Landroid/content/Context;Landroid/content/Intent;)V
-    .locals 4
+    .locals 3
 
     invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
@@ -37,61 +37,13 @@
 
     const-string v1, "android.intent.extra.user_handle"
 
-    const-string v2, "LockSettingsService"
-
     if-eqz p1, :cond_0
 
     invoke-virtual {p2, v1, v0}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I
 
-    move-result p1
-
-    invoke-static {p1}, Landroid/security/AndroidKeyStoreMaintenance;->onUserAdded(I)I
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_3
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v0, "OnUserAdded(): Setup SeparateCredential for DualDAR User : "
-
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-static {v2, p2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$3;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    const/4 p2, 0x1
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p0, p1, p2, v0}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabled(IZLcom/android/internal/widget/LockscreenCredential;)V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string p2, "OnUserAdded(): Successfully added OLK to vold for DualDAR User : "
-
-    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    move-result p0
 
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v2, p0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {p0}, Landroid/security/AndroidKeyStoreMaintenance;->onUserAdded(I)I
 
     goto :goto_0
 
@@ -100,9 +52,9 @@
 
     invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
-    move-result-object v3
+    move-result-object v2
 
-    invoke-virtual {p1, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {p1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result p1
 
@@ -125,9 +77,9 @@
 
     invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object p2
 
-    invoke-virtual {p1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    invoke-virtual {p1, p2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result p1
 
@@ -135,76 +87,11 @@
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$3;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    const-string/jumbo p1, "locale changed"
+    const-string p1, "locale changed"
 
     invoke-static {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mupdateActivatedEncryptionNotifications(Lcom/android/server/locksettings/LockSettingsService;Ljava/lang/String;)V
 
-    goto :goto_0
-
     :cond_2
-    const-string p1, "android.intent.action.MANAGED_PROFILE_ADDED"
-
-    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {p1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_3
-
-    const-string p1, "android.intent.extra.USER"
-
-    invoke-virtual {p2, p1}, Landroid/content/Intent;->getExtra(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p1
-
-    check-cast p1, Landroid/os/UserHandle;
-
-    invoke-virtual {p1}, Landroid/os/UserHandle;->getIdentifier()I
-
-    move-result p1
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_3
-
-    new-instance p2, Ljava/lang/StringBuilder;
-
-    invoke-direct {p2}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v0, "reportEnabledTrustAgentsChanged for DualDAR User : "
-
-    invoke-virtual {p2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-static {v2, p2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$3;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmContext(Lcom/android/server/locksettings/LockSettingsService;)Landroid/content/Context;
-
-    move-result-object p0
-
-    const-class p2, Landroid/app/trust/TrustManager;
-
-    invoke-virtual {p0, p2}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/app/trust/TrustManager;
-
-    invoke-virtual {p0, p1}, Landroid/app/trust/TrustManager;->reportEnabledTrustAgentsChanged(I)V
-
-    :cond_3
     :goto_0
     return-void
 .end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali
index a4aeb136..5de18168 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$DarLockSettings.smali
@@ -40,144 +40,6 @@
 
 
 # virtual methods
-.method public checkLockMaterialsTraced(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)V
-    .locals 5
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v0
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v0
-
-    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
-
-    move-result v1
-
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    filled-new-array {v0, v1}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    const-string v1, "Check accessor - UID : %d, PID : %d"
-
-    invoke-static {v1, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
-
-    const/4 v0, 0x5
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    const-string v1, "Hidden"
-
-    const-string v2, "Empty"
-
-    if-eqz p1, :cond_1
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    move-object v3, v1
-
-    goto :goto_1
-
-    :cond_1
-    :goto_0
-    move-object v3, v2
-
-    :goto_1
-    const/4 v4, 0x0
-
-    aput-object v3, v0, v4
-
-    if-eqz p2, :cond_2
-
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result p2
-
-    if-eqz p2, :cond_3
-
-    :cond_2
-    move-object v1, v2
-
-    :cond_3
-    const/4 p2, 0x1
-
-    aput-object v1, v0, p2
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$misProfileWithUnifiedLock(Lcom/android/server/locksettings/LockSettingsService;I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_4
-
-    const-string p0, "Yes"
-
-    goto :goto_2
-
-    :cond_4
-    const-string p0, "No"
-
-    :goto_2
-    const/4 p2, 0x2
-
-    aput-object p0, v0, p2
-
-    if-eqz p1, :cond_5
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result p0
-
-    goto :goto_3
-
-    :cond_5
-    const/4 p0, -0x1
-
-    :goto_3
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    const/4 p1, 0x3
-
-    aput-object p0, v0, p1
-
-    const/4 p0, 0x4
-
-    invoke-static {p3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    aput-object p1, v0, p0
-
-    const-string p0, "Check requisites - Given : %s, Saved : %s, Unified : %s, Type : %d, User : %d"
-
-    invoke-static {p0, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
-
-    return-void
-.end method
-
 .method public clearStorageForUser(I)V
     .locals 1
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$DarVirtualLock.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$DarVirtualLock.smali
index aaeb536e..6c9a8496 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$DarVirtualLock.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$DarVirtualLock.smali
@@ -28,1014 +28,119 @@
 
 
 # virtual methods
-.method public addEscrowToken([BIILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
-    .locals 9
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v0
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1, p3}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$misUserSecure(Lcom/android/server/locksettings/LockSettingsService;I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_1
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1, p3}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mshouldMigrateToSyntheticPasswordLocked(Lcom/android/server/locksettings/LockSettingsService;I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->prepare(I)Z
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->initializeSyntheticPasswordForVirtualUser(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    move-result-object v1
-
-    goto :goto_0
-
-    :cond_0
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v1, p3}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
-
-    move-result-wide v4
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v2
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mgetGateKeeperService(Lcom/android/server/locksettings/LockSettingsService;)Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v3
-
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v6
-
-    const/4 v8, 0x0
-
-    move v7, p3
-
-    invoke-virtual/range {v2 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-
-    move-result-object v1
-
-    iget-object v1, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    goto :goto_0
-
-    :cond_1
-    const/4 v1, 0x0
-
-    :goto_0
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v2
-
-    invoke-virtual {v2, p1, p2, p3, p4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->addPendingToken([BIILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
-
-    move-result-wide p1
-
-    if-eqz v1, :cond_3
-
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p4}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarAuthUtils(Lcom/android/server/locksettings/LockSettingsService;)Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    move-result-object p4
-
-    invoke-virtual {p4, p3}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
-
-    move-result p4
-
-    if-eqz p4, :cond_2
-
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p4}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarLockSettings(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    move-result-object p4
-
-    invoke-virtual {p4, p3, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->getPendingTokenForDualDAR(IJ)[B
-
-    move-result-object v7
-
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p4}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object p4
-
-    invoke-virtual {p4, p1, p2, v1, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createTokenBasedProtector(JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Z
-
-    move-result p4
-
-    if-eqz p4, :cond_3
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarLockSettings(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    move-result-object v3
-
-    const/4 v8, 0x0
-
-    move-wide v4, p1
-
-    move v6, p3
-
-    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->activateEscrowTokenForDualDAR(JI[B[B)V
-
-    goto :goto_1
-
-    :cond_2
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1, p2, v1, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createTokenBasedProtector(JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Z
-
-    :cond_3
-    :goto_1
-    monitor-exit v0
-
-    return-wide p1
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
-.method public clearLock(I)V
-    .locals 4
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "Clear virtual lock for user "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v0, p1}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
-
-    move-result-wide v0
-
-    const-wide/16 v2, 0x0
-
-    cmp-long v2, v0, v2
-
-    if-eqz v2, :cond_0
-
-    invoke-static {v0, v1}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v0
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    filled-new-array {v0, v1}, [Ljava/lang/Object;
-
-    move-result-object v0
-
-    const-string v1, "Handle(%d) detected at the moment of clearing lock for user %d"
-
-    invoke-static {v1, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->clearSidForUser(I)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v0
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mgetGateKeeperService(Lcom/android/server/locksettings/LockSettingsService;)Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v1
-
-    invoke-virtual {v0, v1, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->removeUser(Landroid/service/gatekeeper/IGateKeeperService;I)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0, p1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mgateKeeperClearSecureUserId(Lcom/android/server/locksettings/LockSettingsService;I)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->removeUser(I)V
-
-    return-void
-.end method
-
-.method public doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 8
-
-    if-eqz p1, :cond_5
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v0
-
-    if-nez v0, :cond_5
-
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1, p2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$misSyntheticPasswordBasedCredentialLocked(Lcom/android/server/locksettings/LockSettingsService;I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v0, p2}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
-
-    move-result-wide v3
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mgetGateKeeperService(Lcom/android/server/locksettings/LockSettingsService;)Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v2
-
-    move-object v5, p1
-
-    move v6, p2
-
-    move-object v7, p3
-
-    invoke-virtual/range {v1 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-
-    move-result-object p3
-
-    iget-object v0, p3, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    goto :goto_0
-
-    :cond_0
-    new-instance p3, Ljava/lang/StringBuilder;
-
-    invoke-direct {p3}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "Sp not yet applied to user "
-
-    invoke-virtual {p3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p3, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p3
-
-    invoke-static {p3}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
-
-    const/4 p3, 0x0
-
-    :goto_0
-    if-nez v0, :cond_1
-
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    :cond_1
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    filled-new-array {v1, v0}, [Ljava/lang/Object;
-
-    move-result-object v1
-
-    const-string v2, "Result of verification for user %d : %s"
-
-    invoke-static {v2, v1}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
-
-    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
-
-    move-result v1
-
-    if-nez v1, :cond_2
-
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->onCredentialMismatchedForInner(I)V
-
-    goto :goto_1
-
-    :cond_2
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->onCredentialVerifiedForInner(Lcom/android/internal/widget/LockscreenCredential;I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_3
-
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    :cond_3
-    :goto_1
-    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_4
-
-    if-eqz p3, :cond_4
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1, p2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$misDualDarAuthUserId(Lcom/android/server/locksettings/LockSettingsService;I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarLockSettings(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    move-result-object p0
-
-    iget-object p3, p3, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object p1
-
-    invoke-virtual {p0, p3, p2, p1}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->activateEscrowTokensForDualDAR(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I[B)V
-
-    :cond_4
-    return-object v0
-
-    :cond_5
-    new-instance p0, Ljava/lang/IllegalArgumentException;
-
-    const-string p1, "Credential can\'t be null or empty"
-
-    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-.end method
-
-.method public initializeSyntheticPasswordForVirtualUser(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-    .locals 5
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "Initialize sp for virtual user "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v0
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v1
-
-    invoke-virtual {v1, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->newSyntheticPassword(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    move-result-object v1
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v2
-
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v3}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mgetGateKeeperService(Lcom/android/server/locksettings/LockSettingsService;)Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v3
-
-    invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object v4
-
-    invoke-virtual {v2, v3, v4, v1, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
-
-    move-result-wide v2
-
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v4, v2, v3, p1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$msetCurrentLskfBasedProtectorId(Lcom/android/server/locksettings/LockSettingsService;JI)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0, p1, v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$monSyntheticPasswordCreated(Lcom/android/server/locksettings/LockSettingsService;ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "Successfully initialized sp for virtual user "
-
-    invoke-virtual {p0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    monitor-exit v0
-
-    return-object v1
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
-.method public final isInnerAuthUserForDualDarDo(I)Z
-    .locals 1
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarAuthUtils(Lcom/android/server/locksettings/LockSettingsService;)Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
-    return p0
-.end method
-
-.method public onCredentialMismatchedForInner(I)V
-    .locals 2
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->isInnerAuthUserForDualDarDo(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    return-void
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
-
-    move-result-object v0
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;
-
-    if-eqz p0, :cond_1
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mDualDARCallback:Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz p0, :cond_1
-
-    :try_start_1
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->get()Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_1
-
-    invoke-interface {p0}, Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;->onInnerLayerUnlockFailed()V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception p0
-
-    :try_start_2
-    const-string p1, "LockSettingsService.DarVirtualLock"
-
-    const-string v1, "Callback might be dead..."
-
-    invoke-static {p1, v1, p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V
-
-    :cond_1
-    :goto_0
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-.end method
-
-.method public onCredentialVerifiedForInner(Lcom/android/internal/widget/LockscreenCredential;I)Z
-    .locals 5
-
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->isInnerAuthUserForDualDarDo(I)Z
-
-    move-result v0
-
-    const/4 v1, 0x1
-
-    if-nez v0, :cond_0
-
-    return v1
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarAuthUtils(Lcom/android/server/locksettings/LockSettingsService;)Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
-
-    move-result v0
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmContext(Lcom/android/server/locksettings/LockSettingsService;)Landroid/content/Context;
-
-    move-result-object v2
-
-    invoke-static {v2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v2
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_1
-
-    const/4 v3, 0x0
-
-    goto :goto_0
-
-    :cond_1
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v3
-
-    :goto_0
-    invoke-virtual {v2, v0, v3}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Auth(I[B)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_4
-
-    const-string v2, "LockSettingsService.DarVirtualLock"
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v4, "Inner-layer authenticated with auth user "
-
-    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-static {v2, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v2, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$msetUserPasswordMetrics(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
-
-    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
-
-    move-result-object p1
-
-    monitor-enter p1
-
-    :try_start_0
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
-
-    move-result-object p2
-
-    invoke-virtual {p2, v0}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
-
-    move-result-object p2
-
-    check-cast p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;
-
-    if-eqz p2, :cond_3
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    iget-object v3, p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mSyntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    iget-object v4, p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mPasswordMetrics:Landroid/app/admin/PasswordMetrics;
-
-    invoke-static {v2, v3, v4, v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$monCredentialVerified(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
-
-    sget-object v2, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v0, v2}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    sget-object v2, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v0, v2}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mDualDARCallback:Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_1
-
-    if-eqz p2, :cond_3
-
-    :try_start_1
-    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->get()Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;
-
-    move-result-object v2
-
-    if-eqz v2, :cond_2
-
-    invoke-interface {v2}, Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;->onInnerLayerUnlocked()V
-    :try_end_1
-    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :cond_2
-    :try_start_2
-    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->dispose()V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
-
-    move-result-object p0
-
-    :goto_1
-    invoke-virtual {p0, v0}, Landroid/util/SparseArray;->remove(I)V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    goto :goto_3
-
-    :catchall_0
-    move-exception v1
-
-    goto :goto_2
-
-    :catch_0
-    move-exception v2
-
-    :try_start_3
-    const-string v3, "LockSettingsService.DarVirtualLock"
-
-    const-string v4, "Callback might be dead..."
-
-    invoke-static {v3, v4, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :try_start_4
-    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->dispose()V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
-
-    move-result-object p0
-
-    goto :goto_1
-
-    :goto_2
-    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->dispose()V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
-
-    move-result-object p0
-
-    invoke-virtual {p0, v0}, Landroid/util/SparseArray;->remove(I)V
-
-    throw v1
-
-    :cond_3
-    :goto_3
-    monitor-exit p1
-
-    return v1
-
-    :catchall_1
-    move-exception p0
-
-    monitor-exit p1
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
-
-    throw p0
-
-    :cond_4
-    const-string p0, "LockSettingsService.DarVirtualLock"
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v0, "Failed in inner-layer authentication with auth user "
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const/4 p2, 0x0
-
-    new-array v0, p2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    return p2
-.end method
-
-.method public prepare(I)Z
-    .locals 3
-
-    new-instance p0, Ljava/io/File;
-
-    new-instance v0, Ljava/io/File;
-
-    invoke-static {}, Landroid/os/Environment;->getDataSystemDirectory()Ljava/io/File;
-
-    move-result-object v1
-
-    const-string/jumbo v2, "users"
-
-    invoke-direct {v0, v1, v2}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-static {p1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-direct {p0, v0, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
-
-    invoke-virtual {p0}, Ljava/io/File;->exists()Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
+.method public final isInnerAuthUserForDualDarDo(I)Z
+    .locals 1
 
-    invoke-virtual {p0}, Ljava/io/File;->mkdir()Z
+    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
 
     move-result v0
 
-    if-nez v0, :cond_0
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v0, "prepare - failed to create sp state path for user "
-
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    if-eqz v0, :cond_0
 
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarAuthUtils(Lcom/android/server/locksettings/LockSettingsService;)Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
 
     move-result-object p0
 
-    const-string p1, "LockSettingsService.DarVirtualLock"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :cond_0
-    invoke-virtual {p0}, Ljava/io/File;->getPath()Ljava/lang/String;
+    invoke-virtual {p0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
 
-    move-result-object p0
+    move-result p0
 
-    const/16 p1, 0x1f9
+    if-eqz p0, :cond_0
 
-    const/4 v0, -0x1
+    const/4 p0, 0x1
 
-    invoke-static {p0, p1, v0, v0}, Landroid/os/FileUtils;->setPermissions(Ljava/lang/String;III)I
+    goto :goto_0
 
-    :cond_1
-    const/4 p0, 0x1
+    :cond_0
+    const/4 p0, 0x0
 
+    :goto_0
     return p0
 .end method
 
-.method public setLockCredentialInternalForDualDarDo(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Z
-    .locals 3
+.method public onCredentialVerifiedForInner(Lcom/android/internal/widget/LockscreenCredential;I)Z
+    .locals 5
 
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->isInnerAuthUserForDualDarDo(I)Z
+    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->isInnerAuthUserForDualDarDo(I)Z
 
     move-result v0
 
-    if-eqz v0, :cond_0
+    const/4 v1, 0x1
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    if-nez v0, :cond_0
 
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmContext(Lcom/android/server/locksettings/LockSettingsService;)Landroid/content/Context;
+    return v1
 
-    move-result-object v0
+    :cond_0
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
+    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarAuthUtils(Lcom/android/server/locksettings/LockSettingsService;)Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
 
     move-result-object v0
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarAuthUtils(Lcom/android/server/locksettings/LockSettingsService;)Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    move-result-object v1
+    invoke-virtual {v0, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
 
-    invoke-virtual {v1, p3}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
+    move-result v0
 
-    move-result v1
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
+    invoke-static {v2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmContext(Lcom/android/server/locksettings/LockSettingsService;)Landroid/content/Context;
 
-    move-result-object p2
+    move-result-object v2
 
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
+    invoke-static {v2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
 
     move-result-object v2
 
-    invoke-virtual {v0, v1, p2, v2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Change(I[B[B)Z
-
-    move-result p2
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    if-eqz p2, :cond_1
+    move-result v3
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    if-eqz v3, :cond_1
 
-    invoke-static {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$msetUserPasswordMetrics(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
+    const/4 v3, 0x0
 
     goto :goto_0
 
-    :cond_0
-    const/4 p2, 0x0
-
     :cond_1
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
+
+    move-result-object v3
+
     :goto_0
-    return p2
-.end method
+    invoke-virtual {v2, v0, v3}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Auth(I[B)Z
 
-.method public setLockCredentialInternalForVirtualUser(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
-    .locals 0
+    move-result v2
 
-    invoke-static {p1}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
+    if-eqz v2, :cond_4
 
-    invoke-static {p2}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
+    const-string v2, "LockSettingsService.DarVirtualLock"
 
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    new-instance v3, Ljava/lang/StringBuilder;
 
-    move-result p1
+    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
 
-    if-eqz p1, :cond_0
+    const-string v4, "Inner-layer authenticated with auth user "
 
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->clearLock(I)V
+    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string p0, "LockSettingsService.DarVirtualLock"
+    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string p1, "credential is NONE"
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;)V
+    move-result-object v3
 
-    const/4 p0, 0x1
+    invoke-static {v2, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    return p0
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+
+    invoke-static {v2, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$msetUserPasswordMetrics(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    :cond_0
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-static {p1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
+    invoke-static {p1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
 
     move-result-object p1
 
@@ -1044,207 +149,147 @@
     :try_start_0
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-static {p2, p3}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$misSyntheticPasswordBasedCredentialLocked(Lcom/android/server/locksettings/LockSettingsService;I)Z
-
-    move-result p2
-
-    if-nez p2, :cond_1
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->prepare(I)Z
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->initializeSyntheticPasswordForVirtualUser(I)Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    :cond_1
-    monitor-exit p1
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const-string p0, "LockSettingsService.DarVirtualLock"
-
-    const-string/jumbo p1, "progressing to set credential for virtual user"
-
-    invoke-static {p0, p1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;Ljava/lang/String;)V
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
+    invoke-static {p2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
 
-.method public setLockCredentialWithToken(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-    .locals 9
+    move-result-object p2
 
-    invoke-virtual {p0, p5}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->isInnerAuthUserForDualDarDo(I)Z
+    invoke-virtual {p2, v0}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
 
-    move-result v0
+    move-result-object p2
 
-    const/4 v1, 0x0
+    check-cast p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;
 
-    if-eqz v0, :cond_0
+    if-eqz p2, :cond_3
 
-    :try_start_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarLockSettings(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
+    iget-object v3, p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mSyntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    move-result-object v2
+    iget-object v4, p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mPasswordMetrics:Landroid/app/admin/PasswordMetrics;
 
-    move-object v3, p1
+    invoke-static {v2, v3, v4, v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$monCredentialVerified(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
 
-    move-wide v4, p2
+    sget-object v2, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
 
-    move-object v6, p4
+    invoke-static {v0, v2}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
 
-    move v7, p5
+    sget-object v2, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
 
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->setLockCredentialWithTokenInternalForDualDAR(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
+    invoke-static {v0, v2}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
 
-    move-result v0
+    iget-object p2, p2, Lcom/android/server/locksettings/LockSettingsService$PendingVerifiedResult;->mDualDARCallback:Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;
     :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v0
-
-    const-string v2, "LockSettingsService.DarVirtualLock"
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v4, "Exception : "
-
-    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Landroid/os/RemoteException;->getMessage()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v3, v1, [Ljava/lang/Object;
-
-    invoke-static {v2, v0, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    move v0, v1
-
-    :goto_0
-    if-nez v0, :cond_0
-
-    const-string p0, "LockSettingsService.DarVirtualLock"
-
-    new-instance p1, Ljava/lang/StringBuilder;
+    .catchall {:try_start_0 .. :try_end_0} :catchall_1
 
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
+    if-eqz p2, :cond_3
 
-    const-string p2, "Dual DAR Client failed to reset password with token for user: "
+    :try_start_1
+    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->get()Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;
 
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    move-result-object v2
 
-    invoke-virtual {p1, p5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    if-eqz v2, :cond_2
 
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-interface {v2}, Lcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;->onInnerLayerUnlocked()V
+    :try_end_1
+    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    move-result-object p1
+    :cond_2
+    :try_start_2
+    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->dispose()V
 
-    new-array p2, v1, [Ljava/lang/Object;
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
+    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
 
-    return v1
+    move-result-object p0
 
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    :goto_1
+    invoke-virtual {p0, v0}, Landroid/util/SparseArray;->remove(I)V
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_1
 
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
+    goto :goto_3
 
-    move-result-object v0
+    :catchall_0
+    move-exception v1
 
-    monitor-enter v0
+    goto :goto_2
 
-    :try_start_1
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    :catch_0
+    move-exception v2
 
-    invoke-static {v2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
+    :try_start_3
+    const-string v3, "LockSettingsService.DarVirtualLock"
 
-    move-result-object v3
+    const-string v4, "Callback might be dead..."
 
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    invoke-static {v3, v4, v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
-    invoke-static {v2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mgetGateKeeperService(Lcom/android/server/locksettings/LockSettingsService;)Landroid/service/gatekeeper/IGateKeeperService;
+    :try_start_4
+    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->dispose()V
 
-    move-result-object v4
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    move-wide v5, p2
+    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
 
-    move-object v7, p4
+    move-result-object p0
 
-    move v8, p5
+    goto :goto_1
 
-    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockTokenBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;J[BI)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    :goto_2
+    invoke-virtual {p2}, Lcom/android/server/locksettings/LockSettingsService$DualDARCallback;->dispose()V
 
-    move-result-object p2
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
 
-    iget-object p3, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
 
-    if-nez p3, :cond_1
+    move-result-object p0
 
-    const-string p0, "Invalid escrow token supplied"
+    invoke-virtual {p0, v0}, Landroid/util/SparseArray;->remove(I)V
 
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
+    throw v1
 
-    monitor-exit v0
+    :cond_3
+    :goto_3
+    monitor-exit p1
 
     return v1
 
-    :cond_1
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {p3, p5}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+    :catchall_1
+    move-exception p0
 
-    move-result-wide p3
+    monitor-exit p1
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_1
 
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    throw p0
 
-    iget-object p2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    :cond_4
+    const-string p0, "LockSettingsService.DarVirtualLock"
 
-    invoke-static {v1, p1, p2, p5}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$msetLockCredentialWithSpLocked(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
+    new-instance p1, Ljava/lang/StringBuilder;
 
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->this$0:Lcom/android/server/locksettings/LockSettingsService;
+    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
+    const-string v0, "Failed in inner-layer authentication with auth user "
 
-    move-result-object p0
+    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {p0, p3, p4, p5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyLskfBasedProtector(JI)V
+    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    monitor-exit v0
+    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    const/4 p0, 0x1
+    move-result-object p1
 
-    return p0
+    const/4 p2, 0x0
 
-    :catchall_0
-    move-exception p0
+    new-array v0, p2, [Ljava/lang/Object;
 
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    invoke-static {p0, p1, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
 
-    throw p0
+    return p2
 .end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$DualDarLockSettings.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$DualDarLockSettings.smali
index 9e9d1bc7..3b7ee49a 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$DualDarLockSettings.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$DualDarLockSettings.smali
@@ -20,1234 +20,10 @@
 
 
 # virtual methods
-.method public activateEscrowTokenForDualDAR(JI[B[B)V
-    .locals 7
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0, p3}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$misDualDarAuthUserId(Lcom/android/server/locksettings/LockSettingsService;I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmContext(Lcom/android/server/locksettings/LockSettingsService;)Landroid/content/Context;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarAuthUtils(Lcom/android/server/locksettings/LockSettingsService;)Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p3}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
-
-    move-result v2
-
-    move-object v3, p5
-
-    move-wide v4, p1
-
-    move-object v6, p4
-
-    invoke-virtual/range {v1 .. v6}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->setResetPasswordToken(I[BJ[B)Z
-
-    move-result p4
-
-    const/4 p5, 0x0
-
-    const-string v0, "LockSettingsService"
-
-    if-eqz p4, :cond_0
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string p1, "Successfully activated reset pwd token for Dual DAR user: "
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, p5, [Ljava/lang/Object;
-
-    invoke-static {v0, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    goto :goto_0
-
-    :cond_0
-    new-instance p4, Ljava/lang/StringBuilder;
-
-    invoke-direct {p4}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "Failed to activate escrow token for Dual DAR user: "
-
-    invoke-virtual {p4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p4, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v1, " because client failed to activate reset pwd token"
-
-    invoke-virtual {p4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p4
-
-    new-array p5, p5, [Ljava/lang/Object;
-
-    invoke-static {v0, p4, p5}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mremoveEscrowToken(Lcom/android/server/locksettings/LockSettingsService;JI)Z
-
-    :cond_1
-    :goto_0
-    return-void
-.end method
-
-.method public activateEscrowTokensForDualDAR(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I[B)V
-    .locals 10
-
-    const-string v0, "LockSettingsService"
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "activateEscrowTokens: user="
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    const/4 v2, 0x0
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v0
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1, p2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mdisableEscrowTokenOnNonManagedDevicesIfNeeded(Lcom/android/server/locksettings/LockSettingsService;I)V
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v1
-
-    invoke-virtual {v1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getPendingTokensForUser(I)Ljava/util/Set;
-
-    move-result-object v1
-
-    invoke-interface {v1}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
-
-    move-result-object v1
-
-    :cond_0
-    :goto_0
-    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_1
-
-    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v3
-
-    check-cast v3, Ljava/lang/Long;
-
-    invoke-virtual {v3}, Ljava/lang/Long;->longValue()J
-
-    move-result-wide v5
-
-    const-string v3, "LockSettingsService"
-
-    const-string v4, "activateEscrowTokens: %x %d "
-
-    const/4 v7, 0x2
-
-    new-array v7, v7, [Ljava/lang/Object;
-
-    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v8
-
-    aput-object v8, v7, v2
-
-    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v8
-
-    const/4 v9, 0x1
-
-    aput-object v8, v7, v9
-
-    invoke-static {v4, v7}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object v4
-
-    new-array v7, v2, [Ljava/lang/Object;
-
-    invoke-static {v3, v4, v7}, Lcom/android/server/knox/dar/ddar/DDLog;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-virtual {p0, p2, v5, v6}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->getPendingTokenForDualDAR(IJ)[B
-
-    move-result-object v8
-
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v3}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v3
-
-    invoke-virtual {v3, v5, v6, p1, p2}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createTokenBasedProtector(JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_0
-
-    move-object v4, p0
-
-    move v7, p2
-
-    move-object v9, p3
-
-    invoke-virtual/range {v4 .. v9}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->activateEscrowTokenForDualDAR(JI[B[B)V
-
-    goto :goto_0
-
-    :cond_1
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
-.method public final deriveTokenForDualDAR([B)[B
+.method public isDualDARUser(I)Z
     .locals 0
 
-    invoke-static {p1}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->deriveResetTokenForDualDAR([B)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public doVerifyCredentialForDualDAR(Lcom/android/internal/widget/LockscreenCredential;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 9
-
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->isDualDARUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_6
-
-    invoke-static {p2}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncrypted(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_6
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    goto/16 :goto_1
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v0
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1, p2}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$misSyntheticPasswordBasedCredentialLocked(Lcom/android/server/locksettings/LockSettingsService;I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_1
-
-    monitor-exit v0
-
     const/4 p0, 0x0
 
-    return-object p0
-
-    :cond_1
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v1, p2}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
-
-    move-result-wide v4
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v2
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mgetGateKeeperService(Lcom/android/server/locksettings/LockSettingsService;)Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v3
-
-    const/4 v8, 0x0
-
-    move-object v6, p1
-
-    move v7, p2
-
-    invoke-virtual/range {v2 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-
-    move-result-object v1
-
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-virtual {v2, p2}, Lcom/android/server/locksettings/LockSettingsService;->getCredentialType(I)I
-
-    move-result v2
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v3
-
-    const/4 v4, 0x0
-
-    if-eq v2, v3, :cond_2
-
-    const-string p0, "LockSettingsService"
-
-    const-string p1, "Credential type mismatch."
-
-    new-array p2, v4, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    monitor-exit v0
-
-    return-object p0
-
-    :cond_2
-    iget-object v1, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
-
-    move-result v0
-
-    if-nez v0, :cond_3
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v0
-
-    invoke-virtual {p0, p2, v0}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->onPassword2Auth(I[B)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object v1
-
-    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    const-string p0, "LockSettingsService"
-
-    const-string/jumbo p1, "verifyChallenge for DualDAR failed."
-
-    new-array p2, v4, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_3
-    invoke-virtual {v1}, Lcom/android/internal/widget/VerifyCredentialResponse;->isMatched()Z
-
-    move-result v0
-
-    if-nez v0, :cond_4
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDarVirtualLock(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->onCredentialMismatchedForInner(I)V
-
-    goto :goto_0
-
-    :cond_4
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDarVirtualLock(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->onCredentialVerifiedForInner(Lcom/android/internal/widget/LockscreenCredential;I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_5
-
-    sget-object v1, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    :cond_5
-    :goto_0
-    return-object v1
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_6
-    :goto_1
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-.end method
-
-.method public final fetchOuterLayerKey(I)[B
-    .locals 2
-
-    const-string v0, "fetchOuterLayerKey()"
-
-    const-string v1, "LockSettingsService"
-
-    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmContext(Lcom/android/server/locksettings/LockSettingsService;)Landroid/content/Context;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->fetchOuterLayerKey(I)[B
-
-    move-result-object p0
-
-    const-string p1, "fetchOuterLayerKey Finished"
-
-    invoke-static {v1, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-object p0
-.end method
-
-.method public getChangedStorageSecretIfDualDAR(I[B)[B
-    .locals 2
-
-    const-string v0, "getChangedStorageSecretIfDualDAR"
-
-    const-string v1, "LockSettingsService"
-
-    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->isDualDARUser(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    return-object p2
-
-    :cond_0
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    const-string p0, "Do not substitute outer-layer-key in case of DualDAR on DO!"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-object p2
-
-    :cond_1
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->fetchOuterLayerKey(I)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public getPendingTokenForDualDAR(IJ)[B
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v0
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v1
-
-    invoke-virtual {v1, p1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getPendingTokenForDualDar(IJ)[B
-
-    move-result-object p2
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p3}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDarLockSettings(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
-
-    move-result-object p3
-
-    invoke-virtual {p3, p1}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->getSecureMode(I)I
-
-    move-result p1
-
-    if-gtz p1, :cond_1
-
-    const/4 p1, 0x0
-
-    if-eqz p2, :cond_0
-
-    array-length p3, p2
-
-    add-int/lit8 p3, p3, -0x40
-
-    goto :goto_0
-
-    :cond_0
-    move p3, p1
-
-    :goto_0
-    if-lez p3, :cond_1
-
-    new-array v0, p3, [B
-
-    invoke-static {p2, p1, v0, p1, p3}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V
-
-    invoke-virtual {p0, v0}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->deriveTokenForDualDAR([B)[B
-
-    move-result-object p2
-
-    :cond_1
-    return-object p2
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-.end method
-
-.method public isDualDARUser(I)Z
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmInjector(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getUserManagerInternal()Lcom/android/server/pm/UserManagerInternal;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerInternal;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    iget p0, p0, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 p1, 0x6000000
-
-    and-int/2addr p0, p1
-
-    if-lez p0, :cond_0
-
-    const/4 p0, 0x1
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    :goto_0
     return p0
 .end method
-
-.method public final onPassword2Auth(I[B)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 2
-
-    const-string/jumbo v0, "onPassword2Auth()"
-
-    const-string v1, "LockSettingsService"
-
-    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->isDualDARUser(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string p2, "User is not DualDAR eligible. so no need to verify DualDAR Passwords"
-
-    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmContext(Lcom/android/server/locksettings/LockSettingsService;)Landroid/content/Context;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1, p2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Auth(I[B)Z
-
-    move-result p0
-
-    if-nez p0, :cond_1
-
-    const-string p0, "Authentication Failure by dual dar client"
-
-    invoke-static {v1, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_1
-    const-string/jumbo p0, "onPassword2Auth completed sucessfully"
-
-    invoke-static {v1, p0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object p0, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {p1, p0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-.end method
-
-.method public final onPassword2Change(I[B[B)Z
-    .locals 2
-
-    const-string/jumbo v0, "onPassword2Change()"
-
-    const-string v1, "LockSettingsService"
-
-    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmContext(Lcom/android/server/locksettings/LockSettingsService;)Landroid/content/Context;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1, p2, p3}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Change(I[B[B)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    const-string p1, "Authentication Change to DualDAR Client Successful"
-
-    invoke-static {v1, p1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_0
-
-    :cond_0
-    const-string p1, "Authentication Change Failure by dual dar client"
-
-    invoke-static {v1, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    :goto_0
-    return p0
-.end method
-
-.method public performDualDARPasswordChange(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)V
-    .locals 6
-
-    const-string v0, "LockSettingsService"
-
-    const-string/jumbo v1, "performDualDARPasswordChange "
-
-    const/4 v2, 0x0
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-static {p3}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDarVirtualLock(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->setLockCredentialInternalForDualDarDo(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_7
-
-    const-string p0, "LockSettingsService"
-
-    const-string p1, "Unexpected failure while change password"
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    goto/16 :goto_3
-
-    :cond_0
-    if-nez p3, :cond_3
-
-    invoke-static {p3}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_1
-
-    const-string p0, "LockSettingsService"
-
-    const-string p1, "Skipped in DualDAR on DO case"
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    return-void
-
-    :cond_1
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmContext(Lcom/android/server/locksettings/LockSettingsService;)Landroid/content/Context;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    if-eqz p1, :cond_2
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result p1
-
-    if-nez p1, :cond_2
-
-    const/4 v2, 0x1
-
-    :cond_2
-    invoke-virtual {p0, p3, v2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword1Change(IZ)Z
-
-    goto/16 :goto_3
-
-    :cond_3
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->isDualDARUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_7
-
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_4
-
-    move-object v0, v1
-
-    goto :goto_0
-
-    :cond_4
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v0
-
-    :goto_0
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
-
-    move-result v3
-
-    if-eqz v3, :cond_5
-
-    goto :goto_1
-
-    :cond_5
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v1
-
-    :goto_1
-    invoke-virtual {p0, p3, v0, v1}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->onPassword2Change(I[B[B)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_6
-
-    goto :goto_3
-
-    :cond_6
-    const-string v0, "LockSettingsService"
-
-    const-string v1, "Change profile password failed by DualDAR Client"
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v0, v1, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    :try_start_0
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v0
-
-    invoke-static {v0}, Lcom/android/internal/widget/LockPatternUtils;->credentialTypeToPasswordQuality(I)I
-
-    move-result v2
-    :try_end_0
-    .catch Ljava/lang/IllegalStateException; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_2
-
-    :catch_0
-    move-exception v0
-
-    const-string v1, "LockSettingsService"
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v4, "IllegalStateException : get credential quality : "
-
-    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/IllegalStateException;->getMessage()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v1, v0, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    :goto_2
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v0
-
-    monitor-enter v0
-
-    :try_start_1
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    const-string/jumbo v3, "lockscreen.password_type"
-
-    int-to-long v4, v2
-
-    invoke-virtual {v1, v3, v4, v5, p3}, Lcom/android/server/locksettings/LockSettingsService;->setLong(Ljava/lang/String;JI)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0, p2, p1, p3, p4}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$msetLockCredentialInternal(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
-
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    new-instance p0, Landroid/os/RemoteException;
-
-    const-string p1, "Change profile password failed by DualDAR Client"
-
-    invoke-direct {p0, p1}, Landroid/os/RemoteException;-><init>(Ljava/lang/String;)V
-
-    throw p0
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_2
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
-
-    throw p0
-
-    :cond_7
-    :goto_3
-    return-void
-.end method
-
-.method public setLockCredentialWithTokenInternalForDualDAR(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-    .locals 9
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0, p5}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$misDualDarAuthUserId(Lcom/android/server/locksettings/LockSettingsService;I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_3
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v0
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v2
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v1}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mgetGateKeeperService(Lcom/android/server/locksettings/LockSettingsService;)Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v3
-
-    move-wide v4, p2
-
-    move-object v6, p4
-
-    move v7, p5
-
-    invoke-virtual/range {v2 .. v7}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockTokenBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;J[BI)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-
-    move-result-object v1
-
-    iget-object v1, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
-
-    const/4 v2, 0x0
-
-    if-nez v1, :cond_0
-
-    const-string p0, "LockSettingsService"
-
-    const-string p1, "Invalid escrow token supplied"
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->w(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    monitor-exit v0
-
-    return v2
-
-    :cond_0
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmSpManager(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p5, p4}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getActiveTokenForDualDar(I[B)[B
-
-    move-result-object v8
-
-    if-nez v8, :cond_1
-
-    const-string p0, "LockSettingsService"
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string p2, "Dual DAR Client failed to get reset token for user: "
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1, p5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    return v2
-
-    :cond_1
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p4}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmContext(Lcom/android/server/locksettings/LockSettingsService;)Landroid/content/Context;
-
-    move-result-object p4
-
-    invoke-static {p4}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v3
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->service:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmDualDarAuthUtils(Lcom/android/server/locksettings/LockSettingsService;)Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p5}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
-
-    move-result v4
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v5
-
-    move-wide v6, p2
-
-    invoke-virtual/range {v3 .. v8}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->resetPasswordWithToken(I[BJ[B)Z
-
-    move-result p0
-
-    if-nez p0, :cond_2
-
-    const-string p0, "LockSettingsService"
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string p2, "Dual DAR Client failed to reset password with token for user: "
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1, p5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    return v2
-
-    :cond_2
-    const-string p0, "LockSettingsService"
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string p2, "Dual DAR Client successfully reset password with token for user: "
-
-    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1, p5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array p2, v2, [Ljava/lang/Object;
-
-    invoke-static {p0, p1, p2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_3
-    :goto_0
-    const/4 p0, 0x1
-
-    return p0
-.end method
-
-.method public unlockDualDarUserKeyIfUnsecured(I)Z
-    .locals 4
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->isDualDARUser(I)Z
-
-    move-result p0
-
-    const/4 v0, 0x1
-
-    if-nez p0, :cond_0
-
-    return v0
-
-    :cond_0
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_1
-
-    return v0
-
-    :cond_1
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    move-result-object p0
-
-    sget-object v1, Lcom/samsung/android/knox/dar/ddar/fsm/State;->DEVICE_UNLOCK_DATA_UNLOCK:Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    const-string v2, "LockSettingsService"
-
-    const/4 v3, 0x0
-
-    if-ne p0, v1, :cond_2
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "Password2Auth has already been completed for: "
-
-    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    return v0
-
-    :cond_2
-    const-string p0, "dualdar data is not unlocked yet!"
-
-    new-array p1, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    return v3
-.end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$Injector$1.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$Injector$1.smali
index 21708a8a..77baa2a3 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$Injector$1.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$Injector$1.smali
@@ -42,7 +42,7 @@
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Injector$1;->val$storage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string/jumbo v0, "lockscreen.disabled"
+    const-string v0, "lockscreen.disabled"
 
     const-string v2, "1"
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$Injector.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$Injector.smali
index 3d191244..e8ebfa7a 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$Injector.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$Injector.smali
@@ -480,16 +480,6 @@
     return-object p0
 .end method
 
-.method public isDualDAREnabled()Z
-    .locals 0
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isDualDAREnabled()Z
-
-    move-result p0
-
-    return p0
-.end method
-
 .method public isGsiRunning()Z
     .locals 1
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$Lifecycle$$ExternalSyntheticLambda1.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$Lifecycle$$ExternalSyntheticLambda1.smali
deleted file mode 100644
index 5b7da073..00000000
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$Lifecycle$$ExternalSyntheticLambda1.smali
+++ /dev/null
@@ -1,28 +0,0 @@
-.class public final synthetic Lcom/android/server/locksettings/LockSettingsService$Lifecycle$$ExternalSyntheticLambda1;
-.super Ljava/lang/Object;
-.source "R8$$SyntheticClass"
-
-# interfaces
-.implements Ljava/util/function/Consumer;
-
-
-# direct methods
-.method public synthetic constructor <init>()V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final accept(Ljava/lang/Object;)V
-    .locals 0
-
-    check-cast p1, Lcom/android/server/knox/dar/DarManagerService;
-
-    invoke-virtual {p1}, Lcom/android/server/knox/dar/DarManagerService;->isDarSupported()Z
-
-    return-void
-.end method
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService$Lifecycle.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService$Lifecycle.smali
index b74aa0b5..9b442db6 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService$Lifecycle.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService$Lifecycle.smali
@@ -40,8 +40,6 @@
 
     if-ne p1, v0, :cond_1
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService$Lifecycle;->onBootPhaseForEnterprise()V
-
     invoke-virtual {p0}, Lcom/android/server/SystemService;->getContext()Landroid/content/Context;
 
     move-result-object p1
@@ -58,45 +56,6 @@
     return-void
 .end method
 
-.method public final onBootPhaseForEnterprise()V
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Lifecycle;->mLockSettingsService:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mcheckWeaverStatus(Lcom/android/server/locksettings/LockSettingsService;)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Lifecycle;->mLockSettingsService:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mrefreshWeaverSlots(Lcom/android/server/locksettings/LockSettingsService;)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Lifecycle;->mLockSettingsService:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {v0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$fgetmInjector(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    move-result-object v0
-
-    invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsService$Injector;->isDualDAREnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService$Lifecycle;->mLockSettingsService:Lcom/android/server/locksettings/LockSettingsService;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/LockSettingsService;->-$$Nest$mgetDarManagerService(Lcom/android/server/locksettings/LockSettingsService;)Ljava/util/Optional;
-
-    move-result-object p0
-
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$Lifecycle$$ExternalSyntheticLambda1;
-
-    invoke-direct {v0}, Lcom/android/server/locksettings/LockSettingsService$Lifecycle$$ExternalSyntheticLambda1;-><init>()V
-
-    invoke-virtual {p0, v0}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
-
-    :cond_0
-    return-void
-.end method
-
 .method public final onBootPhaseForSecureFolder()V
     .locals 1
 
@@ -130,7 +89,7 @@
 
     iput-object v0, p0, Lcom/android/server/locksettings/LockSettingsService$Lifecycle;->mLockSettingsService:Lcom/android/server/locksettings/LockSettingsService;
 
-    const-string/jumbo v1, "lock_settings"
+    const-string v1, "lock_settings"
 
     invoke-virtual {p0, v1, v0}, Lcom/android/server/SystemService;->publishBinderService(Ljava/lang/String;Landroid/os/IBinder;)V
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsService.smali b/smali_classes2/com/android/server/locksettings/LockSettingsService.smali
index 1adf1da8..91b6f558 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsService.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsService.smali
@@ -248,14 +248,6 @@
     return-object p0
 .end method
 
-.method public static synthetic $r8$lambda$lhnIbXn_WLeNvcM9UNm1Go_WitU(Lcom/android/server/locksettings/LockSettingsService;Landroid/app/admin/PasswordMetrics;I)V
-    .locals 0
-
-    invoke-direct {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->lambda$notifyPasswordChanged$17(Landroid/app/admin/PasswordMetrics;I)V
-
-    return-void
-.end method
-
 .method public static synthetic $r8$lambda$oRgKhy8vTNeOvC7Y_hIhE6PuKDc(Lcom/android/server/locksettings/LockSettingsService;)Ljava/lang/String;
     .locals 0
 
@@ -308,14 +300,6 @@
     return-object p0
 .end method
 
-.method public static bridge synthetic -$$Nest$fgetmDarVirtualLock(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;
-
-    return-object p0
-.end method
-
 .method public static bridge synthetic -$$Nest$fgetmDualDarAuthUtils(Lcom/android/server/locksettings/LockSettingsService;)Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
     .locals 0
 
@@ -332,14 +316,6 @@
     return-object p0
 .end method
 
-.method public static bridge synthetic -$$Nest$fgetmInjector(Lcom/android/server/locksettings/LockSettingsService;)Lcom/android/server/locksettings/LockSettingsService$Injector;
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    return-object p0
-.end method
-
 .method public static bridge synthetic -$$Nest$fgetmPendingVerifiedResults(Lcom/android/server/locksettings/LockSettingsService;)Landroid/util/SparseArray;
     .locals 0
 
@@ -422,14 +398,6 @@
     return-void
 .end method
 
-.method public static bridge synthetic -$$Nest$mcheckWeaverStatus(Lcom/android/server/locksettings/LockSettingsService;)V
-    .locals 0
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkWeaverStatus()V
-
-    return-void
-.end method
-
 .method public static bridge synthetic -$$Nest$mcreateNewUser(Lcom/android/server/locksettings/LockSettingsService;II)V
     .locals 0
 
@@ -438,22 +406,6 @@
     return-void
 .end method
 
-.method public static bridge synthetic -$$Nest$mdisableEscrowTokenOnNonManagedDevicesIfNeeded(Lcom/android/server/locksettings/LockSettingsService;I)V
-    .locals 0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->disableEscrowTokenOnNonManagedDevicesIfNeeded(I)V
-
-    return-void
-.end method
-
-.method public static bridge synthetic -$$Nest$mgateKeeperClearSecureUserId(Lcom/android/server/locksettings/LockSettingsService;I)V
-    .locals 0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->gateKeeperClearSecureUserId(I)V
-
-    return-void
-.end method
-
 .method public static bridge synthetic -$$Nest$mgetDarManagerService(Lcom/android/server/locksettings/LockSettingsService;)Ljava/util/Optional;
     .locals 0
 
@@ -482,16 +434,6 @@
     return-void
 .end method
 
-.method public static bridge synthetic -$$Nest$misDualDarAuthUserId(Lcom/android/server/locksettings/LockSettingsService;I)Z
-    .locals 0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
-
-    move-result p0
-
-    return p0
-.end method
-
 .method public static bridge synthetic -$$Nest$misEnterpriseUser(Lcom/android/server/locksettings/LockSettingsService;I)Z
     .locals 0
 
@@ -614,14 +556,6 @@
     return-void
 .end method
 
-.method public static bridge synthetic -$$Nest$monSyntheticPasswordCreated(Lcom/android/server/locksettings/LockSettingsService;ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-    .locals 0
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordCreated(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
-
-    return-void
-.end method
-
 .method public static bridge synthetic -$$Nest$monThirdPartyAppsStarted(Lcom/android/server/locksettings/LockSettingsService;)V
     .locals 0
 
@@ -638,14 +572,6 @@
     return-void
 .end method
 
-.method public static bridge synthetic -$$Nest$mrefreshWeaverSlots(Lcom/android/server/locksettings/LockSettingsService;)V
-    .locals 0
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->refreshWeaverSlots()V
-
-    return-void
-.end method
-
 .method public static bridge synthetic -$$Nest$mremoveEscrowToken(Lcom/android/server/locksettings/LockSettingsService;JI)Z
     .locals 0
 
@@ -672,34 +598,6 @@
     return-void
 .end method
 
-.method public static bridge synthetic -$$Nest$msetCurrentLskfBasedProtectorId(Lcom/android/server/locksettings/LockSettingsService;JI)V
-    .locals 0
-
-    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsService;->setCurrentLskfBasedProtectorId(JI)V
-
-    return-void
-.end method
-
-.method public static bridge synthetic -$$Nest$msetLockCredentialInternal(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
-    .locals 0
-
-    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
-
-    move-result p0
-
-    return p0
-.end method
-
-.method public static bridge synthetic -$$Nest$msetLockCredentialWithSpLocked(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
-    .locals 0
-
-    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
-
-    move-result-wide p0
-
-    return-wide p0
-.end method
-
 .method public static bridge synthetic -$$Nest$msetLockCredentialWithToken(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
     .locals 0
 
@@ -825,11 +723,11 @@
 
     sput-object v0, Lcom/android/server/locksettings/LockSettingsService;->SYSTEM_CREDENTIAL_UIDS:[I
 
-    const-string/jumbo v0, "lock_pattern_visible_pattern"
+    const-string v0, "lock_pattern_visible_pattern"
 
-    const-string/jumbo v1, "lock_pattern_tactile_feedback_enabled"
+    const-string v1, "lock_pattern_tactile_feedback_enabled"
 
-    const-string/jumbo v2, "lock_pattern_autolock"
+    const-string v2, "lock_pattern_autolock"
 
     filled-new-array {v2, v0, v1}, [Ljava/lang/String;
 
@@ -1003,10 +901,6 @@
 
     invoke-virtual {v5, v2}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
 
-    const-string v2, "android.intent.action.MANAGED_PROFILE_ADDED"
-
-    invoke-virtual {v5, v2}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V
-
     invoke-virtual {p1}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getContext()Landroid/content/Context;
 
     move-result-object v2
@@ -1324,30 +1218,6 @@
     return-object p0
 .end method
 
-.method private synthetic lambda$notifyPasswordChanged$17(Landroid/app/admin/PasswordMetrics;I)V
-    .locals 0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1, p2}, Landroid/app/admin/DevicePolicyManager;->reportPasswordChanged(Landroid/app/admin/PasswordMetrics;I)V
-
-    const-class p0, Lcom/android/server/wm/WindowManagerInternal;
-
-    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/wm/WindowManagerInternal;
-
-    invoke-virtual {p0, p2}, Lcom/android/server/wm/WindowManagerInternal;->reportPasswordChanged(I)V
-
-    return-void
-.end method
-
 .method private synthetic lambda$notifyPasswordChanged$18(Lcom/android/internal/widget/LockscreenCredential;I)V
     .locals 0
 
@@ -1870,37 +1740,6 @@
 
     invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->p([Ljava/lang/Object;)V
 
-    invoke-static {p3}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "add escrow token for virtual user "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;
-
-    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->addEscrowToken([BIILcom/android/internal/widget/LockPatternUtils$EscrowTokenStateChangeCallback;)J
-
-    move-result-wide p0
-
-    return-wide p0
-
-    :cond_0
     const-string v0, "LockSettingsService"
 
     const-string v1, "Adding escrow token for user %d"
@@ -1924,7 +1763,7 @@
 
     move-result v1
 
-    if-nez v1, :cond_1
+    if-nez v1, :cond_0
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
@@ -1960,7 +1799,7 @@
 
     goto :goto_0
 
-    :cond_1
+    :cond_0
     const/4 v1, 0x0
 
     :goto_0
@@ -1980,7 +1819,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_5
+    if-eqz v2, :cond_2
 
     iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -1992,41 +1831,8 @@
 
     const/4 v2, 0x1
 
-    if-eqz v1, :cond_3
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
-
-    move-result v3
-
-    if-eqz v3, :cond_2
-
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    invoke-virtual {p4, p3, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->getPendingTokenForDualDAR(IJ)[B
-
-    move-result-object v7
-
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p4, p1, p2, v1, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->createTokenBasedProtector(JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)Z
-
-    move-result p4
-
-    if-eqz p4, :cond_4
-
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    const/4 v8, 0x0
-
-    move-wide v4, p1
-
-    move v6, p3
-
-    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->activateEscrowTokenForDualDAR(JI[B[B)V
-
-    goto :goto_1
+    if-eqz v1, :cond_1
 
-    :cond_2
     const-string v3, "LockSettingsService"
 
     const-string v4, "Immediately activating escrow token %016x"
@@ -2047,7 +1853,7 @@
 
     goto :goto_1
 
-    :cond_3
+    :cond_1
     const-string p0, "LockSettingsService"
 
     const-string p3, "Escrow token %016x will be activated when user is unlocked"
@@ -2062,13 +1868,12 @@
 
     invoke-static {p0, p3, v1}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    :cond_4
     :goto_1
     monitor-exit v0
 
     return-wide p1
 
-    :cond_5
+    :cond_2
     new-instance p0, Ljava/lang/SecurityException;
 
     const-string p1, "Escrow token is disabled on the current user"
@@ -2270,7 +2075,7 @@
     move-object/from16 v2, v19
 
     :goto_1
-    const-string/jumbo v15, "locked"
+    const-string v15, "locked"
 
     move-object/from16 v20, v2
 
@@ -2392,7 +2197,7 @@
 
     invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string/jumbo v4, "locktime"
+    const-string v4, "locktime"
 
     invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
@@ -3471,38 +3276,21 @@
 
     move-result-wide v0
 
-    :try_start_0
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUser(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_0
+    const/4 v2, 0x0
 
-    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredentialForEnterpriseUser(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/internal/widget/VerifyCredentialResponse;
+    :try_start_0
+    invoke-virtual {p0, p1, p2, p3, v2}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
     move-result-object p1
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    :goto_0
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
 
     return-object p1
 
-    :cond_0
-    const/4 v2, 0x0
-
-    :try_start_1
-    invoke-virtual {p0, p1, p2, p3, v2}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_0
-
     :catchall_0
     move-exception p1
 
@@ -3827,7 +3615,7 @@
 
     invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string/jumbo p1, "locktime"
+    const-string p1, "locktime"
 
     invoke-virtual {p2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
@@ -3866,32 +3654,6 @@
     return-void
 .end method
 
-.method public final checkWeaverStatus()V
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->checkWeaverStatus()V
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
 .method public final checkWritePermission()V
     .locals 2
 
@@ -3980,32 +3742,17 @@
 .method public final disableEscrowTokenOnNonManagedDevicesIfNeeded(I)V
     .locals 5
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const-string p0, "LockSettingsService.SDP"
-
-    const-string p1, "Virtual user can have escrow token"
-
-    invoke-static {p0, p1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-
-    :cond_0
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual {v0, p1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasAnyEscrowData(I)Z
 
     move-result v0
 
-    if-nez v0, :cond_1
+    if-nez v0, :cond_0
 
     return-void
 
-    :cond_1
+    :cond_0
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
     move-result-wide v0
@@ -4025,7 +3772,7 @@
 
     const-string v3, "LockSettingsService"
 
-    if-eqz v2, :cond_4
+    if-eqz v2, :cond_3
 
     :try_start_1
     iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
@@ -4038,7 +3785,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_8
+    if-eqz v2, :cond_7
 
     iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
 
@@ -4046,7 +3793,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_3
+    if-eqz v2, :cond_2
 
     iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
@@ -4058,7 +3805,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_2
+    if-eqz v2, :cond_1
 
     const-string p0, "Dual DAR enabled Organization Managed profile can have escrow token"
 
@@ -4070,7 +3817,7 @@
 
     return-void
 
-    :cond_2
+    :cond_1
     :try_start_2
     const-string v2, "Dual DAR enabled Organization Managed profile doesn\'t support reset password. Disable escrow"
 
@@ -4078,7 +3825,7 @@
 
     goto :goto_1
 
-    :cond_3
+    :cond_2
     const-string p0, "Organization managed users can have escrow token"
 
     invoke-static {v3, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
@@ -4089,7 +3836,7 @@
 
     return-void
 
-    :cond_4
+    :cond_3
     :try_start_3
     iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
@@ -4101,7 +3848,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_7
+    if-eqz v4, :cond_6
 
     iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
 
@@ -4109,7 +3856,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_6
+    if-eqz v4, :cond_5
 
     iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
@@ -4121,7 +3868,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_5
+    if-eqz v4, :cond_4
 
     const-string p0, "Dual DAR enabled Managed profile can have escrow token"
 
@@ -4133,7 +3880,7 @@
 
     return-void
 
-    :cond_5
+    :cond_4
     :try_start_4
     const-string v4, "Dual DAR enabled Managed profile doesn\'t support reset password. Disable escrow"
 
@@ -4141,7 +3888,7 @@
 
     goto :goto_0
 
-    :cond_6
+    :cond_5
     const-string p0, "Managed profile can have escrow token"
 
     invoke-static {v3, p0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
@@ -4152,14 +3899,14 @@
 
     return-void
 
-    :cond_7
+    :cond_6
     :goto_0
     :try_start_5
     invoke-virtual {v2}, Lcom/android/server/pm/UserManagerInternal;->isDeviceManaged()Z
 
     move-result v2
 
-    if-eqz v2, :cond_8
+    if-eqz v2, :cond_7
 
     const-string p0, "Corp-owned device can have escrow token"
 
@@ -4171,7 +3918,7 @@
 
     return-void
 
-    :cond_8
+    :cond_7
     :goto_1
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
@@ -4179,7 +3926,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_9
+    if-eqz v0, :cond_8
 
     const-string p0, "User with knox admin can have escrow token"
 
@@ -4187,7 +3934,7 @@
 
     return-void
 
-    :cond_9
+    :cond_8
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
     invoke-virtual {v0}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDeviceStateCache()Landroid/app/admin/DeviceStateCache;
@@ -4198,7 +3945,7 @@
 
     move-result v0
 
-    if-nez v0, :cond_a
+    if-nez v0, :cond_9
 
     const-string p0, "Postpone disabling escrow tokens until device is provisioned"
 
@@ -4206,7 +3953,7 @@
 
     return-void
 
-    :cond_a
+    :cond_9
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
     invoke-virtual {v0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
@@ -4219,11 +3966,11 @@
 
     move-result v0
 
-    if-eqz v0, :cond_b
+    if-eqz v0, :cond_a
 
     return-void
 
-    :cond_b
+    :cond_a
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
@@ -4251,33 +3998,25 @@
 .end method
 
 .method public final doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 20
-
-    move-object/from16 v1, p0
-
-    move-object/from16 v9, p1
-
-    move/from16 v2, p2
-
-    move-object/from16 v8, p3
+    .locals 11
 
-    if-eqz v9, :cond_d
+    if-eqz p1, :cond_9
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v0
 
-    if-nez v0, :cond_d
+    if-nez v0, :cond_9
 
     new-instance v0, Ljava/lang/StringBuilder;
 
     invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
 
-    const-string v3, "Verify credential for user "
+    const-string v1, "Verify credential for user "
 
-    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -4285,531 +4024,419 @@
 
     invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    const-string v10, "credential"
+    const-string v1, "credential"
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
 
-    move-result-object v11
+    move-result-object v2
 
-    const-string v12, "credentialType"
+    const-string v3, "credentialType"
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
     move-result v0
 
     invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v13
+    move-result-object v4
 
-    const-string/jumbo v14, "userId"
+    const-string/jumbo v5, "userId"
 
-    invoke-static/range {p2 .. p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-result-object v15
+    move-result-object v6
 
-    filled-new-array/range {v10 .. v15}, [Ljava/lang/Object;
+    filled-new-array/range {v1 .. v6}, [Ljava/lang/Object;
 
     move-result-object v0
 
     invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->p([Ljava/lang/Object;)V
 
-    invoke-static/range {p2 .. p2}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;
-
-    invoke-virtual {v0, v9, v2, v8}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object v0
-
-    return-object v0
-
-    :cond_0
-    const/16 v3, -0x270f
-
-    const/4 v10, 0x0
-
-    if-ne v2, v3, :cond_1
-
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
-
-    move-result-object v0
-
-    const-string v4, "device_provisioned"
-
-    invoke-static {v0, v4, v10}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    const-string v0, "LockSettingsService"
-
-    const-string v1, "FRP credential can only be verified prior to provisioning."
-
-    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object v0
-
-    :cond_1
-    const-string v0, "LockSettingsService"
+    const/16 v0, -0x270f
 
-    const-string v4, "Verifying lockscreen credential for user %d"
+    const/4 v1, 0x0
 
-    invoke-static/range {p2 .. p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    if-ne p2, v0, :cond_0
 
-    move-result-object v5
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    filled-new-array {v5}, [Ljava/lang/Object;
+    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    move-result-object v5
+    move-result-object v2
 
-    invoke-static {v0, v4, v5}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    const-string v3, "device_provisioned"
 
-    :try_start_0
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
+    invoke-static {v2, v3, v1}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
 
-    invoke-virtual {v0, v9, v2}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->doVerifyCredentialForDualDAR(Lcom/android/internal/widget/LockscreenCredential;I)Lcom/android/internal/widget/VerifyCredentialResponse;
+    move-result v2
 
-    move-result-object v0
+    if-eqz v2, :cond_0
 
-    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    const-string p0, "LockSettingsService"
 
-    move-result v4
+    const-string p1, "FRP credential can only be verified prior to provisioning."
 
-    if-eqz v4, :cond_2
+    invoke-static {p0, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    const-string v4, "LockSettingsService"
+    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    const-string/jumbo v5, "verifyChallenge for DualDAR failed."
+    return-object p0
 
-    invoke-static {v4, v5}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    :cond_0
+    const-string v2, "LockSettingsService"
 
-    iget-object v4, v1, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    const-string v3, "Verifying lockscreen credential for user %d"
 
-    invoke-static {v4}, Lcom/android/server/enterprise/plm/LockDetectionTracker;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/plm/LockDetectionTracker;
+    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v4
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v5
-
-    invoke-virtual {v4, v0, v5}, Lcom/android/server/enterprise/plm/LockDetectionTracker;->reportLockDetection(Lcom/android/internal/widget/VerifyCredentialResponse;I)V
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object v0
-
-    :catch_0
-    move-exception v0
-
-    const-string v4, "LockSettingsService"
-
-    new-instance v5, Ljava/lang/StringBuilder;
-
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v6, "RemoteException : "
-
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Landroid/os/RemoteException;->getMessage()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    filled-new-array {v4}, [Ljava/lang/Object;
 
-    move-result-object v0
+    move-result-object v4
 
-    invoke-static {v4, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v2, v3, v4}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    :cond_2
-    iget-object v11, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    monitor-enter v11
+    monitor-enter v2
 
-    if-ne v2, v3, :cond_3
+    if-ne p2, v0, :cond_1
 
-    :try_start_1
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    :try_start_0
+    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v1
+    move-result-object p0
 
-    invoke-virtual {v0, v1, v9, v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyFrpCredential(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {p2, p0, p1, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyFrpCredential(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    move-result-object v0
+    move-result-object p0
 
-    monitor-exit v11
+    monitor-exit v2
 
-    return-object v0
+    return-object p0
 
-    :cond_3
-    invoke-virtual {v1, v2}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
+    :cond_1
+    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
     move-result-wide v3
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->isSupportForgotPassword()Z
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->isSupportForgotPassword()Z
 
     move-result v0
 
-    const/4 v12, 0x1
-
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_2
 
     const/16 v0, -0x270e
 
-    if-ne v2, v0, :cond_4
+    if-ne p2, v0, :cond_2
 
-    const-string v0, "LockSettingsService"
-
-    const-string v2, "!@ try unlock with prevCredential!!!"
+    const-string p2, "LockSettingsService"
 
-    invoke-static {v0, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    const-string v0, "!@ try unlock with prevCredential!!!"
 
-    invoke-virtual {v1, v10}, Lcom/android/server/locksettings/LockSettingsService;->getBackupLskfBasedProtectorId(I)J
+    invoke-static {p2, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result-wide v2
+    invoke-virtual {p0, v1}, Lcom/android/server/locksettings/LockSettingsService;->getBackupLskfBasedProtectorId(I)J
 
-    move-wide v4, v2
+    move-result-wide v3
 
-    move v0, v10
+    move p2, v1
 
-    move/from16 v19, v12
+    const/4 v10, 0x1
 
     goto :goto_0
 
-    :cond_4
-    move v0, v2
-
-    move-wide v4, v3
-
-    move/from16 v19, v10
+    :cond_2
+    const/4 v10, 0x0
 
     :goto_0
-    iget-object v2, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v3
-
-    move-object/from16 v6, p1
-
-    move v7, v0
-
-    move-object/from16 v8, p3
-
-    invoke-virtual/range {v2 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
-
-    move-result-object v2
+    move-wide v5, v3
 
-    iget-object v3, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
-
-    move-result v4
-
-    if-nez v4, :cond_5
-
-    iget-object v3, v1, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
-
-    iget-object v4, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v4}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
     move-result-object v4
 
-    invoke-virtual {v3, v0, v4}, Lcom/android/server/locksettings/BiometricDeferredQueue;->addPendingLockoutResetForUser(I[B)V
-
-    iget-object v13, v1, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    move-object v7, p1
 
-    invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
+    move v8, p2
 
-    move-result-object v14
+    move-object v9, p3
 
-    iget-object v15, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    invoke-virtual/range {v3 .. v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
-    const-wide/16 v16, 0x0
+    move-result-object p3
 
-    move/from16 v18, v0
+    iget-object v0, p3, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    invoke-virtual/range {v13 .. v18}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallenge(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;JI)Lcom/android/internal/widget/VerifyCredentialResponse;
+    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    move-result-object v3
+    move-result v3
 
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    if-nez v3, :cond_3
 
-    move-result v4
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
 
-    if-eqz v4, :cond_5
+    iget-object v3, p3, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    const-string v0, "LockSettingsService"
+    invoke-virtual {v3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
 
-    const-string/jumbo v1, "verifyChallenge with SP failed."
+    move-result-object v3
 
-    invoke-static {v0, v1}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-virtual {v0, p2, v3}, Lcom/android/server/locksettings/BiometricDeferredQueue;->addPendingLockoutResetForUser(I[B)V
 
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    monitor-exit v11
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    return-object v0
+    move-result-object v4
 
-    :cond_5
-    monitor-exit v11
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    iget-object v5, p3, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    const-wide/16 v6, 0x0
 
-    move-result v4
+    move v8, p2
 
-    if-nez v4, :cond_b
+    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->verifyChallenge(Landroid/service/gatekeeper/IGateKeeperService;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;JI)Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    const-string v4, "LockSettingsService"
+    move-result-object v0
 
-    const-string v5, "Successfully verified lockscreen credential for user %d"
+    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    move-result v3
 
-    move-result-object v6
+    if-eqz v3, :cond_3
 
-    filled-new-array {v6}, [Ljava/lang/Object;
+    const-string p0, "LockSettingsService"
 
-    move-result-object v6
+    const-string/jumbo p1, "verifyChallenge with SP failed."
 
-    invoke-static {v4, v5, v6}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {p0, p1}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object v4, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    if-eqz v19, :cond_6
+    monitor-exit v2
 
-    const/4 v5, 0x0
+    return-object p0
 
-    goto :goto_1
+    :cond_3
+    monitor-exit v2
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    :cond_6
-    invoke-static/range {p1 .. p1}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
+    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    move-result-object v5
+    move-result v2
 
-    :goto_1
-    invoke-virtual {v1, v4, v5, v0}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
+    const/4 v3, 0x1
 
-    invoke-virtual {v1, v0}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
+    if-nez v2, :cond_7
 
-    move-result v4
+    const-string v2, "LockSettingsService"
 
-    if-eqz v4, :cond_7
+    const-string v4, "Successfully verified lockscreen credential for user %d"
 
-    iget-object v4, v1, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
+    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    iget-object v5, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    move-result-object v5
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
+    filled-new-array {v5}, [Ljava/lang/Object;
 
-    move-result-object v6
+    move-result-object v5
 
-    invoke-virtual {v4, v5, v0, v6}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->activateEscrowTokensForDualDAR(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I[B)V
+    invoke-static {v2, v4, v5}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    :cond_7
-    and-int/lit8 v4, p4, 0x1
+    iget-object v2, p3, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-eqz v4, :cond_8
+    if-nez v10, :cond_4
 
-    iget-object v2, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    invoke-static {p1}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
 
-    invoke-virtual {v2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
+    move-result-object v4
 
-    move-result-object v2
+    goto :goto_1
 
-    invoke-virtual {v1, v2}, Lcom/android/server/locksettings/LockSettingsService;->storeGatekeeperPasswordTemporarily([B)J
+    :cond_4
+    const/4 v4, 0x0
 
-    move-result-wide v2
+    :goto_1
+    invoke-virtual {p0, v2, v4, p2}, Lcom/android/server/locksettings/LockSettingsService;->onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
 
-    new-instance v4, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
+    and-int/2addr p4, v3
 
-    invoke-direct {v4}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;-><init>()V
+    if-eqz p4, :cond_5
 
-    invoke-virtual {v4, v2, v3}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->setGatekeeperPasswordHandle(J)Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
+    iget-object p3, p3, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    move-result-object v2
+    invoke-virtual {p3}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveGkPassword()[B
 
-    invoke-virtual {v2}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->build()Lcom/android/internal/widget/VerifyCredentialResponse;
+    move-result-object p3
 
-    move-result-object v2
+    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->storeGatekeeperPasswordTemporarily([B)J
 
-    move-object v3, v2
+    move-result-wide p3
 
-    :cond_8
-    invoke-virtual {v1, v9, v0}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
+    new-instance v0, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
 
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
+    invoke-direct {v0}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;-><init>()V
 
-    move-result v2
+    invoke-virtual {v0, p3, p4}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->setGatekeeperPasswordHandle(J)Lcom/android/internal/widget/VerifyCredentialResponse$Builder;
 
-    if-eqz v2, :cond_9
+    move-result-object p3
 
-    iget-object v2, v1, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    invoke-virtual {p3}, Lcom/android/internal/widget/VerifyCredentialResponse$Builder;->build()Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    invoke-static {v2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
+    move-result-object p3
 
-    move-result-object v2
+    move-object v0, p3
 
-    invoke-virtual {v2, v0}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->cancelDataLock(I)V
+    :cond_5
+    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    :cond_9
-    iget-object v2, v1, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string/jumbo v4, "last-failed-count"
+    const-string p4, "last-failed-count"
 
-    invoke-virtual {v2, v4, v10, v0}, Lcom/android/server/locksettings/LockSettingsStorage;->getInt(Ljava/lang/String;II)I
+    invoke-virtual {p3, p4, v1, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->getInt(Ljava/lang/String;II)I
 
-    move-result v2
+    move-result p3
 
-    const/4 v4, 0x5
+    const/4 p4, 0x5
 
-    if-lt v2, v4, :cond_a
+    if-lt p3, p4, :cond_6
 
-    iget-object v4, v1, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    new-instance v5, Ljava/lang/StringBuilder;
+    new-instance v2, Ljava/lang/StringBuilder;
 
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V
 
-    const-string v6, "Verify Success, History of "
+    const-string v4, "Verify Success, History of "
 
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v2, " failures.\n"
+    const-string p3, " failures.\n"
 
-    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object p3
 
-    invoke-virtual {v4, v12, v2}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
+    invoke-virtual {p4, v3, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
 
-    :cond_a
-    iget-object v2, v1, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    :cond_6
+    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string/jumbo v4, "last-failed-count"
+    const-string p4, "last-failed-count"
 
-    invoke-virtual {v2, v4, v10, v0}, Lcom/android/server/locksettings/LockSettingsStorage;->setInt(Ljava/lang/String;II)V
+    invoke-virtual {p3, p4, v1, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->setInt(Ljava/lang/String;II)V
 
-    invoke-virtual {v1, v9, v0}, Lcom/android/server/locksettings/LockSettingsService;->updateVerifierIfNeeded(Lcom/android/internal/widget/LockscreenCredential;I)V
+    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->updateVerifierIfNeeded(Lcom/android/internal/widget/LockscreenCredential;I)V
 
     goto :goto_2
 
-    :cond_b
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    :cond_7
+    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
-    move-result v2
+    move-result p3
 
-    if-ne v2, v12, :cond_c
+    if-ne p3, v3, :cond_8
 
-    invoke-virtual {v1, v0}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentFailedPasswordAttempts(I)I
+    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentFailedPasswordAttempts(I)I
 
-    move-result v2
+    move-result p3
 
-    add-int/2addr v2, v12
+    add-int/2addr p3, v3
 
-    iget-object v4, v1, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string/jumbo v5, "last-failed-count"
+    const-string v1, "last-failed-count"
 
-    invoke-virtual {v4, v5, v2, v0}, Lcom/android/server/locksettings/LockSettingsStorage;->setInt(Ljava/lang/String;II)V
+    invoke-virtual {p4, v1, p3, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->setInt(Ljava/lang/String;II)V
 
-    iget-object v4, v1, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    new-instance v5, Ljava/lang/StringBuilder;
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
 
-    const-string v6, "Too many failed, fail count = "
+    const-string v2, "Too many failed, fail count = "
 
-    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v2, ", timeout = "
+    const-string p3, ", timeout = "
 
-    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
+    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
 
-    move-result v2
+    move-result p3
 
-    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object p3
 
-    invoke-virtual {v4, v12, v2}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
+    invoke-virtual {p4, v3, p3}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
 
-    iget-object v2, v1, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
+    iget-object p3, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {v2, v12}, Lcom/android/server/locksettings/LockSettingsStorage;->uploadLogFile(I)V
+    invoke-virtual {p3, v3}, Lcom/android/server/locksettings/LockSettingsStorage;->uploadLogFile(I)V
 
-    invoke-virtual {v3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
+    invoke-virtual {v0}, Lcom/android/internal/widget/VerifyCredentialResponse;->getTimeout()I
 
-    move-result v2
+    move-result p3
 
-    if-lez v2, :cond_c
+    if-lez p3, :cond_8
 
-    const/16 v2, 0x8
+    const/16 p3, 0x8
 
-    invoke-virtual {v1, v2, v0}, Lcom/android/server/locksettings/LockSettingsService;->requireStrongAuth(II)V
+    invoke-virtual {p0, p3, p2}, Lcom/android/server/locksettings/LockSettingsService;->requireStrongAuth(II)V
 
-    :cond_c
+    :cond_8
     :goto_2
-    iget-object v0, v1, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    invoke-static {v0}, Lcom/android/server/enterprise/plm/LockDetectionTracker;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/plm/LockDetectionTracker;
+    invoke-static {p0}, Lcom/android/server/enterprise/plm/LockDetectionTracker;->getInstance(Landroid/content/Context;)Lcom/android/server/enterprise/plm/LockDetectionTracker;
 
-    move-result-object v0
+    move-result-object p0
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    move-result v1
+    move-result p1
 
-    invoke-virtual {v0, v3, v1}, Lcom/android/server/enterprise/plm/LockDetectionTracker;->reportLockDetection(Lcom/android/internal/widget/VerifyCredentialResponse;I)V
+    invoke-virtual {p0, v0, p1}, Lcom/android/server/enterprise/plm/LockDetectionTracker;->reportLockDetection(Lcom/android/internal/widget/VerifyCredentialResponse;I)V
 
-    return-object v3
+    return-object v0
 
     :catchall_0
-    move-exception v0
+    move-exception p0
 
-    :try_start_2
-    monitor-exit v11
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
+    :try_start_1
+    monitor-exit v2
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    throw v0
+    throw p0
 
-    :cond_d
-    new-instance v0, Ljava/lang/IllegalArgumentException;
+    :cond_9
+    new-instance p0, Ljava/lang/IllegalArgumentException;
 
-    const-string v1, "Credential can\'t be null or empty"
+    const-string p1, "Credential can\'t be null or empty"
 
-    invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
+    invoke-direct {p0, p1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
 
-    throw v0
+    throw p0
 .end method
 
 .method public final doVerifyCredentialForDualDarDo(Lcom/android/internal/widget/LockscreenCredential;IILcom/samsung/android/knox/dar/ddar/IDualDarAuthProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
@@ -5099,20 +4726,6 @@
     :cond_5
     invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_7
-
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
-
-    move-result-object v0
-
-    invoke-virtual {v0, p2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->cancelDataLock(I)V
-
     goto :goto_3
 
     :cond_6
@@ -5154,74 +4767,6 @@
     throw v0
 .end method
 
-.method public final doVerifyCredentialForEnterpriseUser(Lcom/android/internal/widget/LockscreenCredential;II)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 1
-
-    :try_start_0
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/StreamCipher;->decryptStream(Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object p1
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p0, p1, p2, v0, p3}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz p1, :cond_0
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-
-    :cond_0
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    if-eqz p1, :cond_1
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-
-    :cond_1
-    throw p0
-.end method
-
-.method public final doVerifyCredentialForEnterpriseUser(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 1
-
-    :try_start_0
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/StreamCipher;->decryptStream(Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object p1
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p0, p1, p2, p3, v0}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    if-eqz p1, :cond_0
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-
-    :cond_0
-    return-object p0
-
-    :catchall_0
-    move-exception p0
-
-    if-eqz p1, :cond_1
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-
-    :cond_1
-    throw p0
-.end method
-
 .method public dump(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
     .locals 2
 
@@ -6577,26 +6122,17 @@
 .method public final getDecryptedPasswordsForAllTiedProfiles(I)Ljava/util/Map;
     .locals 7
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialSharableWithParent(I)Z
 
     move-result v0
 
-    const/4 v1, 0x0
-
     if-eqz v0, :cond_0
 
-    return-object v1
-
-    :cond_0
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialSharableWithParent(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
+    const/4 p0, 0x0
 
-    return-object v1
+    return-object p0
 
-    :cond_1
+    :cond_0
     new-instance v0, Landroid/util/ArrayMap;
 
     invoke-direct {v0}, Landroid/util/ArrayMap;-><init>()V
@@ -6614,7 +6150,7 @@
     const/4 v2, 0x0
 
     :goto_0
-    if-ge v2, v1, :cond_4
+    if-ge v2, v1, :cond_3
 
     invoke-interface {p1, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
@@ -6628,22 +6164,22 @@
 
     move-result v4
 
-    if-nez v4, :cond_2
+    if-nez v4, :cond_1
 
     goto :goto_1
 
-    :cond_2
+    :cond_1
     iget v3, v3, Landroid/content/pm/UserInfo;->id:I
 
     invoke-virtual {p0, v3}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result v4
 
-    if-eqz v4, :cond_3
+    if-eqz v4, :cond_2
 
     goto :goto_1
 
-    :cond_3
+    :cond_2
     :try_start_0
     invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -6694,7 +6230,7 @@
 
     goto :goto_0
 
-    :cond_4
+    :cond_3
     return-object v0
 .end method
 
@@ -6896,17 +6432,6 @@
 
     invoke-static {v0, v1, v2}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/StreamCipher;->decryptStream(Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object p1
-
-    :cond_0
     invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isProfileWithUnifiedLock(I)Z
 
     move-result v0
@@ -6915,7 +6440,7 @@
 
     const/4 v1, 0x0
 
-    if-eqz v0, :cond_1
+    if-eqz v0, :cond_0
 
     :try_start_1
     invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->getDecryptedPasswordForTiedProfile(I)Lcom/android/internal/widget/LockscreenCredential;
@@ -6943,7 +6468,7 @@
 
     return-object v1
 
-    :cond_1
+    :cond_0
     :goto_0
     move-object v6, p1
 
@@ -6975,7 +6500,7 @@
 
     iget-object p2, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-nez p2, :cond_2
+    if-nez p2, :cond_1
 
     const-string p2, "LockSettingsService"
 
@@ -6991,7 +6516,7 @@
 
     return-object v1
 
-    :cond_2
+    :cond_1
     :try_start_5
     invoke-virtual {p2}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->derivePasswordHashFactor()[B
 
@@ -7055,7 +6580,7 @@
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string/jumbo v0, "lockscreen.password_type"
+    const-string v0, "lockscreen.password_type"
 
     const-wide/16 v1, 0x0
 
@@ -7088,9 +6613,9 @@
 
     move-result-object v0
 
-    new-instance v2, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15;
+    new-instance v2, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
 
-    invoke-direct {v2, p1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15;-><init>(I)V
+    invoke-direct {v2, p1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;-><init>(I)V
 
     invoke-virtual {v0, v2}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
@@ -7120,9 +6645,9 @@
 
     move-result-object p1
 
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda16;
+    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15;
 
-    invoke-direct {v0, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda16;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
+    invoke-direct {v0, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda15;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
 
     const-string p0, "Core.PROFILE_ENCRYPTED_DETAIL"
 
@@ -7166,9 +6691,9 @@
 
     move-result-object v0
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;
 
-    invoke-direct {v1, p1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;-><init>(I)V
+    invoke-direct {v1, p1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;-><init>(I)V
 
     invoke-virtual {v0, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
@@ -7200,9 +6725,9 @@
 
     move-result-object p1
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;
 
-    invoke-direct {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
+    invoke-direct {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
 
     invoke-virtual {p1, v0, v1}, Landroid/app/admin/DevicePolicyResourcesManager;->getString(Ljava/lang/String;Ljava/util/function/Supplier;)Ljava/lang/String;
 
@@ -7221,9 +6746,9 @@
 
     move-result-object p1
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;
 
-    invoke-direct {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
+    invoke-direct {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda7;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
 
     invoke-virtual {p1, v0, v1}, Landroid/app/admin/DevicePolicyResourcesManager;->getString(Ljava/lang/String;Ljava/util/function/Supplier;)Ljava/lang/String;
 
@@ -7262,9 +6787,9 @@
 
     move-result-object v0
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;
 
-    invoke-direct {v1, p1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;-><init>(I)V
+    invoke-direct {v1, p1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;-><init>(I)V
 
     invoke-virtual {v0, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
@@ -7322,9 +6847,9 @@
 
     move-result-object p1
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;
 
-    invoke-direct {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
+    invoke-direct {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda11;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
 
     invoke-virtual {p1, v0, v1}, Landroid/app/admin/DevicePolicyResourcesManager;->getString(Ljava/lang/String;Ljava/util/function/Supplier;)Ljava/lang/String;
 
@@ -7343,9 +6868,9 @@
 
     move-result-object p1
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;
 
-    invoke-direct {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
+    invoke-direct {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda12;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
 
     invoke-virtual {p1, v0, v1}, Landroid/app/admin/DevicePolicyResourcesManager;->getString(Ljava/lang/String;Ljava/util/function/Supplier;)Ljava/lang/String;
 
@@ -7364,9 +6889,9 @@
 
     move-result-object p1
 
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;
+    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;
 
-    invoke-direct {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda14;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
+    invoke-direct {v1, p0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda13;-><init>(Lcom/android/server/locksettings/LockSettingsService;)V
 
     invoke-virtual {p1, v0, v1}, Landroid/app/admin/DevicePolicyResourcesManager;->getString(Ljava/lang/String;Ljava/util/function/Supplier;)Ljava/lang/String;
 
@@ -7594,21 +7119,6 @@
 .method public final getRequestedPasswordHistoryLength(I)I
     .locals 1
 
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
-
-    move-result p1
-
-    :cond_0
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getDevicePolicyManager()Landroid/app/admin/DevicePolicyManager;
@@ -7627,7 +7137,7 @@
 .method public final getSalt(I)Ljava/lang/String;
     .locals 5
 
-    const-string/jumbo v0, "lockscreen.password_salt"
+    const-string v0, "lockscreen.password_salt"
 
     const-wide/16 v1, 0x0
 
@@ -7656,7 +7166,7 @@
 .method public getSeparateProfileChallengeEnabled(I)Z
     .locals 1
 
-    const-string/jumbo v0, "lockscreen.profilechallenge"
+    const-string v0, "lockscreen.profilechallenge"
 
     invoke-virtual {p0, v0, p1}, Lcom/android/server/locksettings/LockSettingsService;->checkDatabaseReadPermission(Ljava/lang/String;I)V
 
@@ -7677,7 +7187,7 @@
     :try_start_0
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string/jumbo v1, "lockscreen.profilechallenge"
+    const-string v1, "lockscreen.profilechallenge"
 
     const/4 v2, 0x0
 
@@ -8260,152 +7770,71 @@
 
     if-eq p0, v0, :cond_1
 
-    if-nez p0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const/4 p0, 0x0
-
-    goto :goto_1
-
-    :cond_1
-    :goto_0
-    const/4 p0, 0x1
-
-    :goto_1
-    return p0
-.end method
-
-.method public isCredentialSharableWithParent(I)Z
-    .locals 0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->getUserManagerFromCache(I)Landroid/os/UserManager;
-
-    move-result-object p0
-
-    invoke-virtual {p0}, Landroid/os/UserManager;->isCredentialSharableWithParent()Z
-
-    move-result p0
-
-    return p0
-.end method
-
-.method public final isDeviceOwner(I)Z
-    .locals 4
-
-    const/4 v0, 0x0
-
-    if-eqz p1, :cond_0
-
-    return v0
-
-    :cond_0
-    const-string/jumbo v1, "knox.device_owner"
-
-    const-wide/16 v2, 0x0
-
-    invoke-virtual {p0, v1, v2, v3, p1}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
-
-    move-result-wide p0
-
-    cmp-long p0, p0, v2
-
-    if-eqz p0, :cond_1
-
-    const/4 v0, 0x1
-
-    :cond_1
-    return v0
-.end method
-
-.method public final isDualDarAuthUserId(I)Z
-    .locals 1
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {p0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->isInnerAuthUserForDo(I)Z
-
-    move-result p0
-
-    goto :goto_0
-
-    :cond_0
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result p0
-
-    if-eqz p0, :cond_1
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_1
-
-    const/4 p0, 0x1
+    if-nez p0, :cond_0
 
     goto :goto_0
 
-    :cond_1
+    :cond_0
     const/4 p0, 0x0
 
+    goto :goto_1
+
+    :cond_1
     :goto_0
+    const/4 p0, 0x1
+
+    :goto_1
     return p0
 .end method
 
-.method public final isEnterpriseUser(I)Z
-    .locals 2
+.method public isCredentialSharableWithParent(I)Z
+    .locals 0
 
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->getUserManagerFromCache(I)Landroid/os/UserManager;
 
-    move-result-wide v0
+    move-result-object p0
 
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
+    invoke-virtual {p0}, Landroid/os/UserManager;->isCredentialSharableWithParent()Z
 
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService$Injector;->getUserManagerInternal()Lcom/android/server/pm/UserManagerInternal;
+    move-result p0
 
-    move-result-object p0
+    return p0
+.end method
 
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerInternal;->getUserInfo(I)Landroid/content/pm/UserInfo;
+.method public final isDeviceOwner(I)Z
+    .locals 4
 
-    move-result-object p0
+    const/4 v0, 0x0
 
-    if-eqz p0, :cond_0
+    if-eqz p1, :cond_0
 
-    invoke-static {p0}, Lcom/android/server/knox/dar/DarUtil;->isEnterpriseUser(Landroid/content/pm/UserInfo;)Z
+    return v0
 
-    move-result p0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    :cond_0
+    const-string/jumbo v1, "knox.device_owner"
 
-    if-eqz p0, :cond_0
+    const-wide/16 v2, 0x0
 
-    const/4 p0, 0x1
+    invoke-virtual {p0, v1, v2, v3, p1}, Lcom/android/server/locksettings/LockSettingsService;->getLong(Ljava/lang/String;JI)J
 
-    goto :goto_0
+    move-result-wide p0
 
-    :cond_0
-    const/4 p0, 0x0
+    cmp-long p0, p0, v2
 
-    :goto_0
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    if-eqz p0, :cond_1
 
-    return p0
+    const/4 v0, 0x1
 
-    :catchall_0
-    move-exception p0
+    :cond_1
+    return v0
+.end method
 
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+.method public final isEnterpriseUser(I)Z
+    .locals 0
 
-    throw p0
+    const/4 p0, 0x0
+
+    return p0
 .end method
 
 .method public final isEscrowTokenActive(JI)Z
@@ -9094,7 +8523,7 @@
     monitor-enter v2
 
     :try_start_0
-    const-string/jumbo v0, "lockscreen.password_type"
+    const-string v0, "lockscreen.password_type"
 
     iget v3, v1, Landroid/content/pm/UserInfo;->id:I
 
@@ -9470,7 +8899,7 @@
 
     invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsStorage;->migrateLssLog()V
 
-    const-string/jumbo v1, "lockscreen.pwdata.ver"
+    const-string v1, "lockscreen.pwdata.ver"
 
     const-string v2, ""
 
@@ -9580,7 +9009,7 @@
 
     move-result-object v8
 
-    const-string/jumbo v9, "lockscreen.token"
+    const-string v9, "lockscreen.token"
 
     invoke-virtual {p0, v9, v2, v4}, Lcom/android/server/locksettings/LockSettingsService;->setString(Ljava/lang/String;Ljava/lang/String;I)V
 
@@ -9822,45 +9251,14 @@
 .method public final notifyPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
     .locals 2
 
-    invoke-static {p2}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    invoke-static {p1}, Landroid/app/admin/PasswordMetrics;->computeForCredential(Lcom/android/internal/widget/LockscreenCredential;)Landroid/app/admin/PasswordMetrics;
-
-    move-result-object p1
-
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
     new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;
 
-    invoke-direct {v1, p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/locksettings/LockSettingsService;Landroid/app/admin/PasswordMetrics;I)V
+    invoke-direct {v1, p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
 
     invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    goto :goto_0
-
-    :cond_1
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
-
-    new-instance v1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;
-
-    invoke-direct {v1, p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda5;-><init>(Lcom/android/server/locksettings/LockSettingsService;Lcom/android/internal/widget/LockscreenCredential;I)V
-
-    invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
-
-    :goto_0
     return-void
 .end method
 
@@ -9901,15 +9299,6 @@
 .method public final notifySeparateProfileChallengeChanged(I)V
     .locals 1
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
     new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda1;
@@ -9962,20 +9351,7 @@
 .method public final onCredentialVerified(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;Landroid/app/admin/PasswordMetrics;I)V
     .locals 1
 
-    invoke-static {p3}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSdpLockSettings:Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings;
-
-    invoke-virtual {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService$SdpLockSettings;->migrateWithAuthToken(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)V
-
-    return-void
-
-    :cond_0
-    if-eqz p2, :cond_1
+    if-eqz p2, :cond_0
 
     monitor-enter p0
 
@@ -9997,7 +9373,7 @@
 
     throw p1
 
-    :cond_1
+    :cond_0
     :goto_0
     invoke-virtual {p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->deriveKeyStorePassword()[B
 
@@ -10009,29 +9385,13 @@
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->unlockUser(I)V
 
-    iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    invoke-virtual {p2, p3}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->isDualDARUser(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_2
-
-    invoke-static {p3}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p2
-
-    if-eqz p2, :cond_3
-
-    :cond_2
     invoke-virtual {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->activateEscrowTokens(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)V
 
-    :cond_3
     invoke-virtual {p1}, Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;->getSecureFolderAuthToken()Z
 
     move-result p2
 
-    if-eqz p2, :cond_4
+    if-eqz p2, :cond_1
 
     const-string/jumbo p2, "onCredentialVerified : unlockSecureFolderWithToken is true."
 
@@ -10041,24 +9401,24 @@
 
     return-void
 
-    :cond_4
+    :cond_1
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialSharableWithParent(I)Z
 
     move-result p2
 
-    if-eqz p2, :cond_7
+    if-eqz p2, :cond_4
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result p2
 
-    if-eqz p2, :cond_6
+    if-eqz p2, :cond_3
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isPwdChangeRequested(I)Z
 
     move-result p2
 
-    if-eqz p2, :cond_5
+    if-eqz p2, :cond_2
 
     const-string p2, "LockSettingsService"
 
@@ -10068,17 +9428,17 @@
 
     goto :goto_1
 
-    :cond_5
+    :cond_2
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->setDeviceUnlockedForUser(I)V
 
     goto :goto_1
 
-    :cond_6
+    :cond_3
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
 
     invoke-virtual {p2, p3}, Lcom/android/server/locksettings/LockSettingsStrongAuth;->reportUnlock(I)V
 
-    :cond_7
+    :cond_4
     :goto_1
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mStrongAuth:Lcom/android/server/locksettings/LockSettingsStrongAuth;
 
@@ -10098,7 +9458,7 @@
 
     if-eqz v0, :cond_0
 
-    const-string/jumbo v0, "lockscreen.patterneverchosen"
+    const-string v0, "lockscreen.patterneverchosen"
 
     const/4 v1, 0x1
 
@@ -10411,7 +9771,7 @@
 
     move-result-object v2
 
-    if-nez v2, :cond_4
+    if-nez v2, :cond_3
 
     iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
@@ -10428,7 +9788,7 @@
 
     move-result v3
 
-    if-eqz v3, :cond_3
+    if-eqz v3, :cond_2
 
     invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -10442,51 +9802,6 @@
 
     invoke-virtual {p0, v5, v6}, Lcom/android/server/locksettings/LockSettingsService;->removeStateForReusedUserIdIfNecessary(II)V
 
-    iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    iget v6, v3, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-virtual {v5, v6}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->isDualDARUser(I)Z
-
-    move-result v5
-
-    if-eqz v5, :cond_2
-
-    iget v5, v3, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {v5}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v5
-
-    if-nez v5, :cond_2
-
-    iget v5, v3, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-virtual {p0, v5}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
-
-    move-result v5
-
-    if-nez v5, :cond_2
-
-    const-string/jumbo v5, "migrated_dualdar_user_to_sp_and_bound_ce"
-
-    const-string v6, "false"
-
-    iget v3, v3, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-virtual {p0, v5, v6, v3}, Lcom/android/server/locksettings/LockSettingsService;->setString(Ljava/lang/String;Ljava/lang/String;I)V
-
-    const-string v3, "LockSettingsService"
-
-    const-string/jumbo v5, "need to migrate unsecured DualDar user."
-
-    new-array v6, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, v5, v6}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    goto :goto_2
-
-    :cond_2
     iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     monitor-enter v5
@@ -10512,14 +9827,14 @@
     :try_start_2
     throw p0
 
-    :cond_3
+    :cond_2
     const-string/jumbo v2, "migrated_all_users_to_sp_and_bound_ce"
 
     const-string/jumbo v3, "true"
 
     invoke-virtual {p0, v2, v3, v1}, Lcom/android/server/locksettings/LockSettingsService;->setString(Ljava/lang/String;Ljava/lang/String;I)V
 
-    :cond_4
+    :cond_3
     iput-boolean v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mThirdPartyAppsStarted:Z
 
     monitor-exit v0
@@ -10774,36 +10089,6 @@
     throw p0
 .end method
 
-.method public final refreshWeaverSlots()V
-    .locals 1
-
-    const-string v0, "Refresh weaver slots"
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->refreshActiveSlots()V
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
 .method public registerRemoteLockCallback(ILcom/android/internal/widget/IRemoteLockMonitorCallback;)V
     .locals 3
 
@@ -11197,7 +10482,7 @@
 .end method
 
 .method public final removeEscrowToken(JI)Z
-    .locals 5
+    .locals 4
 
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -11246,56 +10531,17 @@
 
     move-result v1
 
-    if-eqz v1, :cond_3
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {v1, p1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyTokenBasedProtector(JI)V
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
-
-    move-result v1
-
     if-eqz v1, :cond_2
 
-    const-string v1, "LockSettingsService"
-
-    new-instance v2, Ljava/lang/StringBuilder;
-
-    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v4, "Clearing activated reset pwd token for DualDAR user: "
-
-    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-static {v1, v2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
-
-    invoke-static {v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v1
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarAuthUtils:Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;
-
-    invoke-virtual {p0, p3}, Lcom/samsung/android/knox/dar/ddar/DualDarAuthUtils;->getMainUserId(I)I
-
-    move-result p0
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v1, p0, p1, p2}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->clearResetPasswordToken(IJ)V
+    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/locksettings/SyntheticPasswordManager;->destroyTokenBasedProtector(JI)V
 
-    :cond_2
     monitor-exit v0
 
     return v3
 
-    :cond_3
+    :cond_2
     monitor-exit v0
 
     return v2
@@ -11349,19 +10595,10 @@
 .end method
 
 .method public final removeKeystoreProfileKey(I)V
-    .locals 7
-
-    const-string v0, "LockSettingsService"
-
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v1
-
-    if-eqz v1, :cond_0
+    .locals 7
 
-    return-void
+    const-string v0, "LockSettingsService"
 
-    :cond_0
     new-instance v1, Ljava/lang/StringBuilder;
 
     invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
@@ -11397,7 +10634,7 @@
 
     move-result v3
 
-    if-nez v3, :cond_1
+    if-nez v3, :cond_0
 
     iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mJavaKeyStore:Ljava/security/KeyStore;
 
@@ -11405,9 +10642,9 @@
 
     move-result v3
 
-    if-eqz v3, :cond_2
+    if-eqz v3, :cond_1
 
-    :cond_1
+    :cond_0
     const-string v3, "Removing keystore profile key for user %d"
 
     const/4 v4, 0x1
@@ -11451,7 +10688,7 @@
 
     invoke-static {v0, p0, v1, p1}, Lcom/android/server/utils/Slogf;->e(Ljava/lang/String;Ljava/lang/Throwable;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    :cond_2
+    :cond_1
     :goto_0
     return-void
 .end method
@@ -11700,7 +10937,7 @@
 
     invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string/jumbo v7, "locked"
+    const-string v7, "locked"
 
     invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
@@ -11836,7 +11073,7 @@
 
     invoke-virtual {v9, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string/jumbo v13, "locktime"
+    const-string v13, "locktime"
 
     invoke-virtual {v9, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
@@ -12120,15 +11357,6 @@
 .method public resetKeyStore(I)V
     .locals 13
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkWritePermission()V
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
@@ -12163,13 +11391,13 @@
 
     move-result-object v3
 
-    :cond_1
+    :cond_0
     :goto_0
     invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z
 
     move-result v4
 
-    if-eqz v4, :cond_2
+    if-eqz v4, :cond_1
 
     invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -12183,7 +11411,7 @@
 
     move-result v5
 
-    if-eqz v5, :cond_1
+    if-eqz v5, :cond_0
 
     iget v5, v4, Landroid/content/pm/UserInfo;->id:I
 
@@ -12191,7 +11419,7 @@
 
     move-result v5
 
-    if-nez v5, :cond_1
+    if-nez v5, :cond_0
 
     iget-object v5, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
@@ -12201,7 +11429,7 @@
 
     move-result v5
 
-    if-eqz v5, :cond_1
+    if-eqz v5, :cond_0
 
     :try_start_0
     iget v5, v4, Landroid/content/pm/UserInfo;->id:I
@@ -12242,7 +11470,7 @@
 
     goto :goto_0
 
-    :cond_2
+    :cond_1
     const/4 v1, -0x1
 
     const/4 v3, 0x0
@@ -12259,7 +11487,7 @@
     move v6, v3
 
     :goto_1
-    if-ge v6, v5, :cond_4
+    if-ge v6, v5, :cond_3
 
     aget v7, v4, v6
 
@@ -12270,7 +11498,7 @@
     move v10, v3
 
     :goto_2
-    if-ge v10, v9, :cond_3
+    if-ge v10, v9, :cond_2
 
     aget v11, v8, v10
 
@@ -12286,12 +11514,12 @@
 
     goto :goto_2
 
-    :cond_3
+    :cond_2
     add-int/lit8 v6, v6, 0x1
 
     goto :goto_1
 
-    :cond_4
+    :cond_3
     iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
     invoke-virtual {v4, p1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
@@ -12302,7 +11530,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_5
+    if-eqz v4, :cond_4
 
     const/4 v4, 0x2
 
@@ -12312,13 +11540,13 @@
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :cond_5
+    :cond_4
     :goto_3
     invoke-interface {v0}, Ljava/util/List;->size()I
 
     move-result v4
 
-    if-ge v3, v4, :cond_8
+    if-ge v3, v4, :cond_7
 
     invoke-interface {v0, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
@@ -12336,23 +11564,23 @@
 
     check-cast v5, Lcom/android/internal/widget/LockscreenCredential;
 
-    if-eq v4, v1, :cond_6
+    if-eq v4, v1, :cond_5
 
-    if-eqz v5, :cond_6
+    if-eqz v5, :cond_5
 
     invoke-virtual {p0, v4, p1, v5}, Lcom/android/server/locksettings/LockSettingsService;->tieProfileLockToParent(IILcom/android/internal/widget/LockscreenCredential;)V
 
-    :cond_6
-    if-eqz v5, :cond_7
+    :cond_5
+    if-eqz v5, :cond_6
 
     invoke-virtual {v5}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
 
-    :cond_7
+    :cond_6
     add-int/lit8 v3, v3, 0x1
 
     goto :goto_3
 
-    :cond_8
+    :cond_7
     return-void
 
     :catchall_0
@@ -12363,7 +11591,7 @@
 
     move-result v5
 
-    if-ge v3, v5, :cond_b
+    if-ge v3, v5, :cond_a
 
     invoke-interface {v0, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
@@ -12381,23 +11609,23 @@
 
     check-cast v6, Lcom/android/internal/widget/LockscreenCredential;
 
-    if-eq v5, v1, :cond_9
+    if-eq v5, v1, :cond_8
 
-    if-eqz v6, :cond_9
+    if-eqz v6, :cond_8
 
     invoke-virtual {p0, v5, p1, v6}, Lcom/android/server/locksettings/LockSettingsService;->tieProfileLockToParent(IILcom/android/internal/widget/LockscreenCredential;)V
 
-    :cond_9
-    if-eqz v6, :cond_a
+    :cond_8
+    if-eqz v6, :cond_9
 
     invoke-virtual {v6}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
 
-    :cond_a
+    :cond_9
     add-int/lit8 v3, v3, 0x1
 
     goto :goto_4
 
-    :cond_b
+    :cond_a
     throw v4
 .end method
 
@@ -12408,9 +11636,9 @@
 
     move-result-object p0
 
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17;
+    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda16;
 
-    invoke-direct {v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17;-><init>()V
+    invoke-direct {v0}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda16;-><init>()V
 
     const-wide/16 v1, 0x7d0
 
@@ -12507,40 +11735,31 @@
 .method public final sendCredentialsOnUnlockIfRequired(Lcom/android/internal/widget/LockscreenCredential;I)V
     .locals 4
 
-    invoke-static {p2}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     const/16 v0, -0x270f
 
-    if-ne p2, v0, :cond_1
+    if-ne p2, v0, :cond_0
 
     return-void
 
-    :cond_1
+    :cond_0
     invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v0
 
-    if-eqz v0, :cond_2
+    if-eqz v0, :cond_1
 
     return-void
 
-    :cond_2
+    :cond_1
     invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isProfileWithUnifiedLock(I)Z
 
     move-result v0
 
-    if-eqz v0, :cond_3
+    if-eqz v0, :cond_2
 
     return-void
 
-    :cond_3
+    :cond_2
     invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->getProfilesWithSameLockScreen(I)Ljava/util/Set;
 
     move-result-object p2
@@ -12554,7 +11773,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_3
 
     invoke-interface {p2}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -12580,7 +11799,7 @@
 
     goto :goto_0
 
-    :cond_4
+    :cond_3
     return-void
 .end method
 
@@ -12883,325 +12102,132 @@
 .method public setKeystorePassword([BI)V
     .locals 2
 
-    invoke-static {p2}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     invoke-static {p2, p1}, Landroid/security/AndroidKeyStoreMaintenance;->onUserPasswordChanged(I[B)I
 
-    move-result p1
-
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v1, "setKeystorePassword, userhandle = "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string p2, ", ret = "
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    const/4 p2, 0x0
-
-    invoke-virtual {p0, p2, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
-
-    return-void
-.end method
-
-.method public setKnoxGuard(ILcom/android/internal/widget/RemoteLockInfo;)Z
-    .locals 0
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkWritePermission()V
-
-    :try_start_0
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->applyRemoteLock(ILcom/android/internal/widget/RemoteLockInfo;)Z
-
-    move-result p0
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return p0
-
-    :catch_0
-    const-string p0, "LockSettingsService"
-
-    const-string p1, "failed applyRemoteLock!"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x0
-
-    return p0
-.end method
-
-.method public setLockCarrierPassword([BI)V
-    .locals 1
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkWritePermission()V
-
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->passwordToHash([BI)[B
-
-    move-result-object p0
-
-    invoke-virtual {v0, p0, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->writeCarrierPasswordHash([BI)V
-
-    return-void
-.end method
-
-.method public setLockCredential(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Z
-    .locals 1
-
-    const/4 v0, 0x0
-
-    invoke-virtual {p0, p1, p2, p3, v0}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithIgnoreNotifyIfNeeded(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
-
-    move-result p0
-
-    return p0
-.end method
-
-.method public final setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
-    .locals 24
-
-    move-object/from16 v8, p0
-
-    move-object/from16 v9, p1
-
-    move-object/from16 v1, p2
-
-    move/from16 v10, p4
-
-    invoke-static/range {p1 .. p1}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
-
-    invoke-static/range {p2 .. p2}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
-
-    const/16 v0, -0x270e
-
-    const/4 v11, 0x1
-
-    const/4 v2, 0x0
-
-    move/from16 v3, p3
-
-    if-ne v3, v0, :cond_0
-
-    const-string v0, "LockSettingsService"
-
-    const-string v3, "!@ set credential with prev!!!"
-
-    invoke-static {v0, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    move v7, v2
-
-    move v3, v11
-
-    goto :goto_0
-
-    :cond_0
-    move v7, v3
-
-    move v3, v2
-
-    :goto_0
-    invoke-static {v7}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v4, "Set credential for user virtual "
-
-    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v4, " credentialType:"
-
-    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v4
-
-    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    const-string v12, "credential"
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v13
-
-    const-string v14, "credentialType"
-
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v0
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v15
-
-    const-string/jumbo v16, "savedCredential"
-
-    invoke-virtual/range {p2 .. p2}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
-
-    move-result-object v17
-
-    const-string/jumbo v18, "savedCredentialType"
-
-    invoke-virtual/range {p2 .. p2}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
-
-    move-result v0
-
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v19
-
-    const-string/jumbo v20, "userId"
-
-    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v21
+    move-result p1
 
-    const-string v22, "isLockTiedToParent"
+    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-static/range {p4 .. p4}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    new-instance v0, Ljava/lang/StringBuilder;
 
-    move-result-object v23
+    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
 
-    filled-new-array/range {v12 .. v23}, [Ljava/lang/Object;
+    const-string/jumbo v1, "setKeystorePassword, userhandle = "
 
-    move-result-object v0
+    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->p([Ljava/lang/Object;)V
+    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    iget-object v0, v8, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;
+    const-string p2, ", ret = "
 
-    invoke-virtual {v0, v9, v1, v7, v10}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->setLockCredentialInternalForVirtualUser(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
+    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result v0
+    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    if-eqz v0, :cond_1
+    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    return v11
+    move-result-object p1
 
-    :cond_1
-    invoke-virtual {v8, v7}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUser(I)Z
+    const/4 p2, 0x0
 
-    move-result v0
+    invoke-virtual {p0, p2, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
 
-    if-eqz v0, :cond_2
+    return-void
+.end method
 
-    new-instance v0, Ljava/lang/StringBuilder;
+.method public setKnoxGuard(ILcom/android/internal/widget/RemoteLockInfo;)Z
+    .locals 0
 
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkWritePermission()V
 
-    const-string v4, "Set credential for user enterprise "
+    :try_start_0
+    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->applyRemoteLock(ILcom/android/internal/widget/RemoteLockInfo;)Z
 
-    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    move-result p0
+    :try_end_0
+    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
 
-    invoke-virtual {v0, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    return p0
 
-    const-string v4, " credentialType:"
+    :catch_0
+    const-string p0, "LockSettingsService"
 
-    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    const-string p1, "failed applyRemoteLock!"
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    invoke-static {p0, p1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result v4
+    const/4 p0, 0x0
 
-    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    return p0
+.end method
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+.method public setLockCarrierPassword([BI)V
+    .locals 1
 
-    move-result-object v0
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->checkWritePermission()V
 
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
+    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string v12, "credential"
+    invoke-virtual {p0, p1, p2}, Lcom/android/server/locksettings/LockSettingsService;->passwordToHash([BI)[B
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
+    move-result-object p0
 
-    move-result-object v13
+    invoke-virtual {v0, p0, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->writeCarrierPasswordHash([BI)V
 
-    const-string v14, "credentialType"
+    return-void
+.end method
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+.method public setLockCredential(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)Z
+    .locals 1
 
-    move-result v0
+    const/4 v0, 0x0
 
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-virtual {p0, p1, p2, p3, v0}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithIgnoreNotifyIfNeeded(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
 
-    move-result-object v15
+    move-result p0
 
-    const-string/jumbo v16, "savedCredential"
+    return p0
+.end method
 
-    invoke-virtual/range {p2 .. p2}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
+.method public final setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
+    .locals 18
 
-    move-result-object v17
+    move-object/from16 v8, p0
 
-    const-string/jumbo v18, "savedCredentialType"
+    move-object/from16 v9, p1
 
-    invoke-virtual/range {p2 .. p2}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    invoke-static/range {p1 .. p1}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
 
-    move-result v0
+    invoke-static/range {p2 .. p2}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;
 
-    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    const/16 v0, -0x270e
 
-    move-result-object v19
+    const/4 v10, 0x1
 
-    const-string/jumbo v20, "userId"
+    const/4 v1, 0x0
 
-    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    move/from16 v2, p3
 
-    move-result-object v21
+    if-ne v2, v0, :cond_0
 
-    const-string v22, "isLockTiedToParent"
+    const-string v0, "LockSettingsService"
 
-    invoke-static/range {p4 .. p4}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    const-string v2, "!@ set credential with prev!!!"
 
-    move-result-object v23
+    invoke-static {v0, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    filled-new-array/range {v12 .. v23}, [Ljava/lang/Object;
+    move v7, v1
 
-    move-result-object v0
+    move v2, v10
 
-    invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->p([Ljava/lang/Object;)V
+    goto :goto_0
 
-    iget-object v0, v8, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
+    :cond_0
+    move v7, v2
 
-    invoke-virtual {v0, v9, v1, v7}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->checkLockMaterialsTraced(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;I)V
+    move v2, v1
 
-    :cond_2
+    :goto_0
     iget-object v6, v8, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     monitor-enter v6
@@ -13211,7 +12237,7 @@
 
     move-result v0
 
-    if-eqz v0, :cond_3
+    if-eqz v0, :cond_1
 
     invoke-virtual {v8, v7}, Lcom/android/server/locksettings/LockSettingsService;->isProfileWithUnifiedLock(I)Z
 
@@ -13219,7 +12245,7 @@
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    if-eqz v0, :cond_3
+    if-eqz v0, :cond_1
 
     :try_start_1
     invoke-virtual {v8, v7}, Lcom/android/server/locksettings/LockSettingsService;->getDecryptedPasswordForTiedProfile(I)Lcom/android/internal/widget/LockscreenCredential;
@@ -13239,159 +12265,161 @@
     .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
+    move-object v3, v0
+
     goto :goto_2
 
     :catch_0
     move-exception v0
 
     :try_start_2
-    const-string v4, "LockSettingsService"
+    const-string v3, "LockSettingsService"
 
-    const-string v5, "Failed to decrypt child profile key"
+    const-string v4, "Failed to decrypt child profile key"
 
-    invoke-static {v4, v5, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+    invoke-static {v3, v4, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    const-string v4, "Failed to decrypt child profile key"
+    const-string v3, "Failed to decrypt child profile key"
 
-    invoke-static {v4, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/String;Ljava/lang/Exception;)V
+    invoke-static {v3, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/String;Ljava/lang/Exception;)V
 
     goto :goto_1
 
     :catch_1
     move-exception v0
 
-    move-object v4, v0
+    move-object v3, v0
 
     const-string v0, "LockSettingsService"
 
-    const-string v5, "Child profile key not found"
+    const-string v4, "Child profile key not found"
 
-    invoke-static {v0, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
     const-string v0, "Child profile key not found"
 
-    invoke-static {v0, v4}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/String;Ljava/lang/Exception;)V
+    invoke-static {v0, v3}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/String;Ljava/lang/Exception;)V
 
-    :cond_3
+    :cond_1
     :goto_1
-    move-object v0, v1
+    move-object/from16 v3, p2
 
     :goto_2
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->isSupportForgotPassword()Z
 
-    move-result v1
+    move-result v0
 
-    if-eqz v1, :cond_4
+    if-eqz v0, :cond_2
 
-    if-eqz v3, :cond_4
+    if-eqz v2, :cond_2
 
     invoke-virtual {v8, v7}, Lcom/android/server/locksettings/LockSettingsService;->getBackupLskfBasedProtectorId(I)J
 
     move-result-wide v4
 
-    iget-object v12, v8, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v11, v8, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v13
+    move-result-object v12
 
-    const/16 v18, 0x0
+    const/16 v17, 0x0
 
-    move-wide v14, v4
+    move-wide v13, v4
 
-    move-object/from16 v16, v0
+    move-object v15, v3
 
-    move/from16 v17, v7
+    move/from16 v16, v7
 
-    invoke-virtual/range {v12 .. v18}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    invoke-virtual/range {v11 .. v17}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
-    move-result-object v1
+    move-result-object v0
 
     goto :goto_3
 
-    :cond_4
+    :cond_2
     invoke-virtual {v8, v7}, Lcom/android/server/locksettings/LockSettingsService;->getCurrentLskfBasedProtectorId(I)J
 
     move-result-wide v4
 
-    iget-object v12, v8, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v11, v8, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-result-object v13
+    move-result-object v12
 
-    const/16 v18, 0x0
+    const/16 v17, 0x0
 
-    move-wide v14, v4
+    move-wide v13, v4
 
-    move-object/from16 v16, v0
+    move-object v15, v3
 
-    move/from16 v17, v7
+    move/from16 v16, v7
 
-    invoke-virtual/range {v12 .. v18}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    invoke-virtual/range {v11 .. v17}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
-    move-result-object v1
+    move-result-object v0
 
     :goto_3
-    iget-object v12, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
+    iget-object v11, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
-    iget-object v13, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    iget-object v0, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-nez v13, :cond_8
+    if-nez v0, :cond_6
 
     const-string v0, "Untrusted credential reset not acceptable"
 
     invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
 
-    if-eqz v12, :cond_7
+    if-eqz v11, :cond_5
 
-    invoke-virtual {v12}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    invoke-virtual {v11}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
     move-result v0
 
-    const/4 v1, -0x1
+    const/4 v2, -0x1
 
-    if-ne v0, v1, :cond_5
+    if-ne v0, v2, :cond_3
 
     goto :goto_4
 
-    :cond_5
-    invoke-virtual {v12}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
+    :cond_3
+    invoke-virtual {v11}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
     move-result v0
 
-    if-ne v0, v11, :cond_6
+    if-ne v0, v10, :cond_4
 
     const-string v0, "LockSettingsService"
 
-    const-string v1, "Failed to enroll: rate limit exceeded."
+    const-string v2, "Failed to enroll: rate limit exceeded."
 
-    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
     iget-object v0, v8, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string v1, "Failed to enroll: rate limit exceeded."
+    const-string v2, "Failed to enroll: rate limit exceeded."
 
-    invoke-virtual {v0, v2, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
 
     iget-object v0, v8, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {v0, v2}, Lcom/android/server/locksettings/LockSettingsStorage;->uploadLogFile(I)V
+    invoke-virtual {v0, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->uploadLogFile(I)V
 
     monitor-exit v6
 
-    return v2
+    return v1
 
-    :cond_6
+    :cond_4
     iget-object v0, v8, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string/jumbo v1, "password change failed"
+    const-string/jumbo v2, "password change failed"
 
-    invoke-virtual {v0, v2, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
 
     iget-object v0, v8, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {v0, v2}, Lcom/android/server/locksettings/LockSettingsStorage;->uploadLogFile(I)V
+    invoke-virtual {v0, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->uploadLogFile(I)V
 
     new-instance v0, Ljava/lang/IllegalStateException;
 
@@ -13401,63 +12429,63 @@
 
     throw v0
 
-    :cond_7
+    :cond_5
     :goto_4
     const-string v0, "LockSettingsService"
 
-    const-string v1, "Failed to enroll: incorrect credential."
+    const-string v2, "Failed to enroll: incorrect credential."
 
-    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
     iget-object v0, v8, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string v1, "Failed to enroll: incorrect credential."
+    const-string v2, "Failed to enroll: incorrect credential."
 
-    invoke-virtual {v0, v2, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
+    invoke-virtual {v0, v1, v2}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
 
     iget-object v0, v8, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    invoke-virtual {v0, v2}, Lcom/android/server/locksettings/LockSettingsStorage;->uploadLogFile(I)V
+    invoke-virtual {v0, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->uploadLogFile(I)V
 
     monitor-exit v6
 
-    return v2
+    return v1
 
-    :cond_8
+    :cond_6
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->isSupportForgotPassword()Z
 
     move-result v1
 
-    if-eqz v1, :cond_9
+    if-eqz v1, :cond_7
 
-    if-nez v3, :cond_9
+    if-nez v2, :cond_7
 
-    if-nez v7, :cond_9
+    if-nez v7, :cond_7
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->expirePreviousData()V
 
-    :cond_9
-    invoke-virtual {v8, v7, v13}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordUnlocked(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
+    :cond_7
+    invoke-virtual {v8, v7, v0}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordUnlocked(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->isSupportForgotPassword()Z
 
     move-result v1
 
-    if-eqz v1, :cond_a
+    if-eqz v1, :cond_8
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/locksettings/LockSettingsService;->isSupportWeaver()Z
 
     move-result v1
 
-    if-nez v1, :cond_a
+    if-nez v1, :cond_8
 
-    if-nez v7, :cond_a
+    if-nez v7, :cond_8
 
-    invoke-virtual {v0}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    invoke-virtual {v3}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v1
 
-    if-nez v1, :cond_a
+    if-nez v1, :cond_8
 
     invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
@@ -13465,87 +12493,59 @@
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
-    if-nez v1, :cond_a
+    if-nez v1, :cond_8
 
     move-object/from16 v1, p0
 
     move-object/from16 v2, p1
 
-    move-object v3, v0
-
-    move-object v12, v6
+    move-object v11, v6
 
-    move-object v6, v13
+    move-object v6, v0
 
-    move v14, v7
+    move v12, v7
 
     :try_start_3
     invoke-virtual/range {v1 .. v7}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;JLcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
 
     goto :goto_5
 
-    :cond_a
-    move-object v12, v6
+    :cond_8
+    move-object v11, v6
 
-    move v14, v7
+    move v12, v7
 
-    invoke-virtual {v8, v9, v13, v14}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
+    invoke-virtual {v8, v9, v0, v12}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithSpLocked(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)J
 
     :goto_5
-    invoke-virtual {v8, v9, v14, v10}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnChangeIfRequired(Lcom/android/internal/widget/LockscreenCredential;IZ)V
-
-    iget-object v1, v8, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
-
-    invoke-virtual {v1, v13, v14}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->saveEscrowDataIfNeededLocked(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)V
-
-    iget-object v1, v8, Lcom/android/server/locksettings/LockSettingsService;->mInjector:Lcom/android/server/locksettings/LockSettingsService$Injector;
-
-    invoke-virtual {v1}, Lcom/android/server/locksettings/LockSettingsService$Injector;->isDualDAREnabled()Z
-
-    move-result v1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_1
-
-    if-eqz v1, :cond_b
-
-    :try_start_4
-    iget-object v1, v8, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    invoke-virtual {v1, v9, v0, v14, v10}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->performDualDARPasswordChange(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)V
-    :try_end_4
-    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_2
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
+    move/from16 v1, p4
 
-    goto :goto_6
+    invoke-virtual {v8, v9, v12, v1}, Lcom/android/server/locksettings/LockSettingsService;->sendCredentialsOnChangeIfRequired(Lcom/android/internal/widget/LockscreenCredential;IZ)V
 
-    :catch_2
-    move-exception v0
+    iget-object v1, v8, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
 
-    :try_start_5
-    invoke-virtual {v0}, Landroid/os/RemoteException;->printStackTrace()V
+    invoke-virtual {v1, v0, v12}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->saveEscrowDataIfNeededLocked(Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;I)V
 
-    :cond_b
-    :goto_6
-    monitor-exit v12
+    monitor-exit v11
 
-    return v11
+    return v10
 
     :catchall_0
     move-exception v0
 
-    move-object v12, v6
+    move-object v11, v6
 
-    :goto_7
-    monitor-exit v12
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
+    :goto_6
+    monitor-exit v11
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
     throw v0
 
     :catchall_1
     move-exception v0
 
-    goto :goto_7
+    goto :goto_6
 .end method
 
 .method public setLockCredentialWithIgnoreNotifyIfNeeded(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
@@ -13714,30 +12714,15 @@
     invoke-static {v7}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
 
     :cond_6
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUser(I)Z
-
-    move-result v7
-
-    if-eqz v7, :cond_7
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/StreamCipher;->decryptStream(Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object p1
-
-    invoke-static {p2}, Lcom/samsung/android/knox/dar/StreamCipher;->decryptStream(Lcom/android/internal/widget/LockscreenCredential;)Lcom/android/internal/widget/LockscreenCredential;
-
-    move-result-object p2
-
-    :cond_7
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isSEPLiteSecureFolder(I)Z
 
     move-result v7
 
-    if-nez v7, :cond_8
+    if-nez v7, :cond_7
 
-    if-eqz v6, :cond_9
+    if-eqz v6, :cond_8
 
-    :cond_8
+    :cond_7
     const-string v6, "SEP-Lite User %d identified as SecureFolder user"
 
     new-array v7, v1, [Ljava/lang/Object;
@@ -13764,7 +12749,7 @@
 
     move-result v6
 
-    if-eq v6, v1, :cond_9
+    if-eq v6, v1, :cond_8
 
     const-string/jumbo p1, "sdp not supported : setSecureFolderLockCredential success"
 
@@ -13821,7 +12806,7 @@
 
     return v1
 
-    :cond_9
+    :cond_8
     :try_start_1
     iget-object v6, p0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
 
@@ -13829,20 +12814,20 @@
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_1
 
-    if-eqz v3, :cond_a
+    if-eqz v3, :cond_9
 
     goto :goto_4
 
-    :cond_a
+    :cond_9
     move v0, p3
 
     :goto_4
     :try_start_2
     invoke-virtual {p0, p1, p2, v0, v2}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialInternal(Lcom/android/internal/widget/LockscreenCredential;Lcom/android/internal/widget/LockscreenCredential;IZ)Z
 
-    move-result v0
+    move-result p2
 
-    if-nez v0, :cond_b
+    if-nez p2, :cond_a
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
 
@@ -13898,23 +12883,23 @@
 
     return v2
 
-    :cond_b
-    const/4 v0, 0x0
+    :cond_a
+    const/4 p2, 0x0
 
     :try_start_3
-    invoke-virtual {p0, p3, v1, v0}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
+    invoke-virtual {p0, p3, v1, p2}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
 
-    if-eqz p4, :cond_c
+    if-eqz p4, :cond_b
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUser(I)Z
 
-    move-result p4
+    move-result p2
 
-    if-eqz p4, :cond_c
+    if-eqz p2, :cond_b
 
     goto :goto_5
 
-    :cond_c
+    :cond_b
     invoke-virtual {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->notifyPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
 
     :goto_5
@@ -13925,42 +12910,31 @@
     :try_start_4
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialSharableWithParent(I)Z
 
-    move-result p4
+    move-result p2
 
-    if-eqz p4, :cond_d
+    if-eqz p2, :cond_c
 
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->setDeviceUnlockedForUser(I)V
 
-    :cond_d
+    :cond_c
     invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->notifySeparateProfileChallengeChanged(I)V
 
     invoke-virtual {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->onPostPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    iget-object p4, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
+    iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mContext:Landroid/content/Context;
 
-    invoke-virtual {p4}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-virtual {p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
 
-    move-result-object p4
+    move-result-object p1
 
-    const-string/jumbo v0, "ppp_enroll_timestamp"
+    const-string/jumbo p2, "ppp_enroll_timestamp"
 
     invoke-static {}, Ljava/lang/System;->currentTimeMillis()J
 
     move-result-wide v6
 
-    invoke-static {p4, v0, v6, v7, p3}, Landroid/provider/Settings$Secure;->putLongForUser(Landroid/content/ContentResolver;Ljava/lang/String;JI)Z
-
-    invoke-virtual {p0, p3}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUser(I)Z
-
-    move-result p4
-
-    if-eqz p4, :cond_e
-
-    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
-
-    invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->zeroize()V
+    invoke-static {p1, p2, v6, v7, p3}, Landroid/provider/Settings$Secure;->putLongForUser(Landroid/content/ContentResolver;Ljava/lang/String;JI)Z
 
-    :cond_e
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
     :try_end_4
     .catchall {:try_start_4 .. :try_end_4} :catchall_1
@@ -14335,188 +13309,165 @@
 .end method
 
 .method public final setLockCredentialWithToken(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-    .locals 16
-
-    move-object/from16 v0, p0
-
-    move/from16 v5, p5
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "Set lock credential with token for user "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
-
-    const-string v6, "credential"
+    .locals 13
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
+    move-object v0, p0
 
-    move-result-object v7
+    move/from16 v1, p5
 
-    const-string/jumbo v8, "type"
+    new-instance v2, Ljava/lang/StringBuilder;
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
+    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V
 
-    move-result v1
+    const-string v3, "Set lock credential with token for user "
 
-    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v9
+    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string/jumbo v10, "tokenHandle"
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
+    move-result-object v2
 
-    move-result-object v11
+    invoke-static {v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->i(Ljava/lang/String;)V
 
-    const-string/jumbo v12, "token"
+    const-string v3, "credential"
 
-    const-string/jumbo v14, "userId"
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getCredential()[B
 
-    invoke-static/range {p5 .. p5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
+    move-result-object v4
 
-    move-result-object v15
+    const-string/jumbo v5, "type"
 
-    move-object/from16 v13, p4
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
-    filled-new-array/range {v6 .. v15}, [Ljava/lang/Object;
+    move-result v2
 
-    move-result-object v1
+    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    invoke-static {v1}, Lcom/android/server/knox/dar/sdp/SDPLog;->p([Ljava/lang/Object;)V
+    move-result-object v6
 
-    invoke-static/range {p5 .. p5}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    const-string/jumbo v7, "tokenHandle"
 
-    move-result v1
+    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
 
-    if-eqz v1, :cond_0
+    move-result-object v8
 
-    iget-object v0, v0, Lcom/android/server/locksettings/LockSettingsService;->mDarVirtualLock:Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;
+    const-string/jumbo v9, "token"
 
-    move-object/from16 v1, p1
+    const-string/jumbo v11, "userId"
 
-    move-wide/from16 v2, p2
+    invoke-static/range {p5 .. p5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
-    move-object/from16 v4, p4
+    move-result-object v12
 
-    move/from16 v5, p5
+    move-object/from16 v10, p4
 
-    invoke-virtual/range {v0 .. v5}, Lcom/android/server/locksettings/LockSettingsService$DarVirtualLock;->setLockCredentialWithToken(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
+    filled-new-array/range {v3 .. v12}, [Ljava/lang/Object;
 
-    move-result v0
+    move-result-object v2
 
-    return v0
+    invoke-static {v2}, Lcom/android/server/knox/dar/sdp/SDPLog;->p([Ljava/lang/Object;)V
 
-    :cond_0
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    monitor-enter v1
+    monitor-enter v2
 
     :try_start_0
-    iget-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
+    iget-object v3, v0, Lcom/android/server/locksettings/LockSettingsService;->mDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;
 
-    invoke-virtual {v2, v5}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->restoreEscrowDataIfNeededLocked(I)V
+    invoke-virtual {v3, v1}, Lcom/android/server/locksettings/LockSettingsService$DarLockSettings;->restoreEscrowDataIfNeededLocked(I)V
 
-    iget-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
+    iget-object v3, v0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    invoke-virtual {v2, v5}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasEscrowData(I)Z
+    invoke-virtual {v3, v1}, Lcom/android/server/locksettings/SyntheticPasswordManager;->hasEscrowData(I)Z
 
-    move-result v2
+    move-result v3
 
-    if-eqz v2, :cond_4
+    if-eqz v3, :cond_3
 
-    move-wide/from16 v2, p2
+    move-wide v3, p2
 
-    invoke-virtual {v0, v2, v3, v5}, Lcom/android/server/locksettings/LockSettingsService;->isEscrowTokenActive(JI)Z
+    invoke-virtual {p0, v3, v4, v1}, Lcom/android/server/locksettings/LockSettingsService;->isEscrowTokenActive(JI)Z
 
-    move-result v4
+    move-result v5
 
-    if-nez v4, :cond_1
+    if-nez v5, :cond_0
 
     const-string v0, "LockSettingsService"
 
-    new-instance v4, Ljava/lang/StringBuilder;
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
 
     const-string v5, "Unknown or unactivated token: "
 
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-static/range {p2 .. p3}, Ljava/lang/Long;->toHexString(J)Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v3
 
-    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v1
 
-    invoke-static {v0, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    monitor-exit v1
+    monitor-exit v2
 
     const/4 v0, 0x0
 
     return v0
 
-    :cond_1
+    :cond_0
     invoke-virtual/range {p0 .. p5}, Lcom/android/server/locksettings/LockSettingsService;->setLockCredentialWithTokenInternalLocked(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
 
-    move-result v2
+    move-result v3
 
-    monitor-exit v1
+    monitor-exit v2
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_1
 
-    if-eqz v2, :cond_3
+    if-eqz v3, :cond_2
 
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
+    iget-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
 
-    monitor-enter v1
+    monitor-enter v2
 
-    const/4 v3, 0x1
+    const/4 v4, 0x1
 
-    const/4 v4, 0x0
+    const/4 v5, 0x0
 
     :try_start_1
-    invoke-virtual {v0, v5, v3, v4}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
+    invoke-virtual {p0, v1, v4, v5}, Lcom/android/server/locksettings/LockSettingsService;->setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
 
-    monitor-exit v1
+    monitor-exit v2
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    invoke-virtual/range {p1 .. p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
+    invoke-virtual {p1}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
-    move-result v1
+    move-result v2
 
-    if-eqz v1, :cond_2
+    if-eqz v2, :cond_1
 
-    iget-object v1, v0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
+    iget-object v2, v0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    new-instance v3, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18;
+    new-instance v4, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17;
 
-    invoke-direct {v3, v0, v5}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda18;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
+    invoke-direct {v4, p0, v1}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda17;-><init>(Lcom/android/server/locksettings/LockSettingsService;I)V
 
-    invoke-virtual {v1, v3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
+    invoke-virtual {v2, v4}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
 
-    :cond_2
-    move-object/from16 v1, p1
+    :cond_1
+    move-object v2, p1
 
-    invoke-virtual {v0, v1, v5}, Lcom/android/server/locksettings/LockSettingsService;->notifyPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
+    invoke-virtual {p0, p1, v1}, Lcom/android/server/locksettings/LockSettingsService;->notifyPasswordChanged(Lcom/android/internal/widget/LockscreenCredential;I)V
 
-    invoke-virtual {v0, v5}, Lcom/android/server/locksettings/LockSettingsService;->notifySeparateProfileChallengeChanged(I)V
+    invoke-virtual {p0, v1}, Lcom/android/server/locksettings/LockSettingsService;->notifySeparateProfileChallengeChanged(I)V
 
     goto :goto_0
 
@@ -14524,13 +13475,13 @@
     move-exception v0
 
     :try_start_2
-    monitor-exit v1
+    monitor-exit v2
     :try_end_2
     .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
     throw v0
 
-    :cond_3
+    :cond_2
     :goto_0
     const-string v0, "Result of setting credential with token for user %d : %s"
 
@@ -14538,11 +13489,11 @@
 
     move-result-object v1
 
-    invoke-static {v2}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+    invoke-static {v3}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
 
-    move-result-object v3
+    move-result-object v2
 
-    filled-new-array {v1, v3}, [Ljava/lang/Object;
+    filled-new-array {v1, v2}, [Ljava/lang/Object;
 
     move-result-object v1
 
@@ -14552,22 +13503,22 @@
 
     invoke-static {v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
 
-    return v2
+    return v3
 
-    :cond_4
+    :cond_3
     :try_start_3
     new-instance v0, Ljava/lang/SecurityException;
 
-    const-string v2, "Escrow token is disabled on the current user"
+    const-string v1, "Escrow token is disabled on the current user"
 
-    invoke-direct {v0, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
+    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V
 
     throw v0
 
     :catchall_1
     move-exception v0
 
-    monitor-exit v1
+    monitor-exit v2
     :try_end_3
     .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
@@ -14575,7 +13526,7 @@
 .end method
 
 .method public final setLockCredentialWithTokenInternalLocked(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-    .locals 10
+    .locals 9
 
     invoke-static {p5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -14595,18 +13546,11 @@
 
     invoke-static {v1, v2, v0}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
-    invoke-virtual {p0, p5}, Lcom/android/server/locksettings/LockSettingsService;->isDualDarAuthUserId(I)Z
-
-    move-result v0
-
-    const/4 v2, 0x0
-
-    if-eqz v0, :cond_0
+    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
-    :try_start_0
-    iget-object v3, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
+    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
-    move-object v4, p1
+    move-result-object v4
 
     move-wide v5, p2
 
@@ -14614,100 +13558,38 @@
 
     move v8, p5
 
-    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->setLockCredentialWithTokenInternalForDualDAR(Lcom/android/internal/widget/LockscreenCredential;J[BI)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v3, "Dual DAR Client failed to reset password with token for user: "
-
-    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-static {v1, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return v2
-
-    :catch_0
-    move-exception v0
-
-    new-instance v3, Ljava/lang/StringBuilder;
-
-    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v4, "Exception : "
-
-    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Landroid/os/RemoteException;->getMessage()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    new-array v3, v2, [Ljava/lang/Object;
-
-    invoke-static {v1, v0, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    :cond_0
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
-
-    move-result-object v5
-
-    move-wide v6, p2
-
-    move-object v8, p4
-
-    move v9, p5
-
-    invoke-virtual/range {v4 .. v9}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockTokenBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;J[BI)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
+    invoke-virtual/range {v3 .. v8}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockTokenBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;J[BI)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
     move-result-object p2
 
     iget-object p3, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-nez p3, :cond_1
+    const/4 p4, 0x0
+
+    if-nez p3, :cond_0
 
     const-string p0, "Invalid escrow token supplied"
 
     invoke-static {v1, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    return v2
+    return p4
 
-    :cond_1
+    :cond_0
     iget-object p3, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->gkResponse:Lcom/android/internal/widget/VerifyCredentialResponse;
 
     invoke-virtual {p3}, Lcom/android/internal/widget/VerifyCredentialResponse;->getResponseCode()I
 
     move-result p3
 
-    if-eqz p3, :cond_2
+    if-eqz p3, :cond_1
 
     const-string p0, "Obsolete token: synthetic password decrypted but it fails GK verification."
 
     invoke-static {v1, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
 
-    return v2
+    return p4
 
-    :cond_2
+    :cond_1
     iget-object p3, p2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
     invoke-virtual {p0, p5, p3}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordUnlocked(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
@@ -14801,7 +13683,7 @@
 
     if-nez p2, :cond_0
 
-    const-string/jumbo p2, "lockscreen.samsung_biometric"
+    const-string p2, "lockscreen.samsung_biometric"
 
     invoke-static {p2, p1}, Landroid/text/TextUtils;->equals(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Z
 
@@ -14815,9 +13697,9 @@
 
     move-result-object p0
 
-    new-instance p1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9;
+    new-instance p1, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;
 
-    invoke-direct {p1, p4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9;-><init>(I)V
+    invoke-direct {p1, p4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda8;-><init>(I)V
 
     invoke-virtual {p0, p1}, Ljava/util/Optional;->ifPresent(Ljava/util/function/Consumer;)V
 
@@ -14920,26 +13802,17 @@
 .method public setSeparateProfileChallengeEnabled(IZLcom/android/internal/widget/LockscreenCredential;)V
     .locals 7
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     new-instance v0, Ljava/lang/StringBuilder;
 
     invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
 
-    if-eqz p2, :cond_1
+    if-eqz p2, :cond_0
 
     const-string v1, "Enable"
 
     goto :goto_0
 
-    :cond_1
+    :cond_0
     const-string v1, "Disable"
 
     :goto_0
@@ -14983,9 +13856,9 @@
 
     iget-boolean v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mHasSecureLockScreen:Z
 
-    if-nez v0, :cond_3
+    if-nez v0, :cond_2
 
-    if-eqz p3, :cond_3
+    if-eqz p3, :cond_2
 
     invoke-virtual {p3}, Lcom/android/internal/widget/LockscreenCredential;->getType()I
 
@@ -14993,11 +13866,11 @@
 
     const/4 v1, -0x1
 
-    if-ne v0, v1, :cond_2
+    if-ne v0, v1, :cond_1
 
     goto :goto_1
 
-    :cond_2
+    :cond_1
     new-instance p0, Ljava/lang/UnsupportedOperationException;
 
     const-string p1, "This operation requires secure lock screen feature."
@@ -15006,17 +13879,17 @@
 
     throw p0
 
-    :cond_3
+    :cond_2
     :goto_1
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSeparateChallengeLock:Ljava/lang/Object;
 
     monitor-enter v0
 
-    if-eqz p3, :cond_4
+    if-eqz p3, :cond_3
 
     goto :goto_2
 
-    :cond_4
+    :cond_3
     :try_start_0
     invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
 
@@ -15047,18 +13920,9 @@
 .method public final setSeparateProfileChallengeEnabledLocked(IZLcom/android/internal/widget/LockscreenCredential;)V
     .locals 3
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     const/4 v0, 0x0
 
-    const-string/jumbo v1, "lockscreen.profilechallenge"
+    const-string v1, "lockscreen.profilechallenge"
 
     invoke-virtual {p0, v1, v0, p1}, Lcom/android/server/locksettings/LockSettingsService;->getBoolean(Ljava/lang/String;ZI)Z
 
@@ -15070,7 +13934,7 @@
 
     invoke-virtual {p0, v2, p1}, Lcom/android/server/locksettings/LockSettingsService;->notifyPasswordPolicyOneLockChanged(ZI)V
 
-    if-eqz p2, :cond_1
+    if-eqz p2, :cond_0
 
     :try_start_0
     iget-object p2, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
@@ -15081,7 +13945,7 @@
 
     goto :goto_0
 
-    :cond_1
+    :cond_0
     invoke-virtual {p0, p1, p3}, Lcom/android/server/locksettings/LockSettingsService;->tieProfileLockIfNecessary(ILcom/android/internal/widget/LockscreenCredential;)V
     :try_end_0
     .catch Ljava/lang/IllegalStateException; {:try_start_0 .. :try_end_0} :catch_0
@@ -15144,26 +14008,11 @@
 .method public final setUserKeyProtection(I[B)V
     .locals 4
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
     move-result-wide v0
 
     :try_start_0
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    invoke-virtual {v2, p1, p2}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->getChangedStorageSecretIfDualDAR(I[B)[B
-
-    move-result-object p2
-
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorageManager:Landroid/os/storage/IStorageManager;
 
     invoke-interface {p0, p1, p2}, Landroid/os/storage/IStorageManager;->setUserKeyProtection(I[B)V
@@ -15866,9 +14715,9 @@
 
     iget-object p1, p0, Lcom/android/server/locksettings/LockSettingsService;->mHandler:Landroid/os/Handler;
 
-    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;
+    new-instance v0, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9;
 
-    invoke-direct {v0, p0, v3, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda10;-><init>(Lcom/android/server/locksettings/LockSettingsService;J)V
+    invoke-direct {v0, p0, v3, v4}, Lcom/android/server/locksettings/LockSettingsService$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/locksettings/LockSettingsService;J)V
 
     const-wide/32 v1, 0x927c0
 
@@ -15898,7 +14747,7 @@
 .method public final synchronizeUnifiedWorkChallengeForProfiles(ILjava/util/Map;)V
     .locals 7
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
+    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialSharableWithParent(I)Z
 
     move-result v0
 
@@ -15907,15 +14756,6 @@
     return-void
 
     :cond_0
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialSharableWithParent(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    return-void
-
-    :cond_1
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
     move-result v0
@@ -15969,7 +14809,7 @@
     const/4 p1, 0x0
 
     :goto_0
-    if-ge p1, v2, :cond_6
+    if-ge p1, v2, :cond_5
 
     invoke-interface {v1, p1}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
@@ -15983,18 +14823,18 @@
 
     move-result v4
 
-    if-eqz v4, :cond_5
+    if-eqz v4, :cond_4
 
     invoke-virtual {p0, v3}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result v4
 
-    if-eqz v4, :cond_2
+    if-eqz v4, :cond_1
 
     goto :goto_1
 
-    :cond_2
-    if-eqz v0, :cond_3
+    :cond_1
+    if-eqz v0, :cond_2
 
     invoke-static {}, Lcom/android/internal/widget/LockscreenCredential;->createNone()Lcom/android/internal/widget/LockscreenCredential;
 
@@ -16004,10 +14844,10 @@
 
     goto :goto_1
 
-    :cond_3
+    :cond_2
     const-string v4, "Profile("
 
-    if-eqz p2, :cond_4
+    if-eqz p2, :cond_3
 
     invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -16017,7 +14857,7 @@
 
     move-result v5
 
-    if-eqz v5, :cond_4
+    if-eqz v5, :cond_3
 
     new-instance v5, Ljava/lang/StringBuilder;
 
@@ -16063,7 +14903,7 @@
 
     goto :goto_1
 
-    :cond_4
+    :cond_3
     new-instance v5, Ljava/lang/StringBuilder;
 
     invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
@@ -16088,13 +14928,13 @@
 
     invoke-static {v3, v4}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_5
+    :cond_4
     :goto_1
     add-int/lit8 p1, p1, 0x1
 
     goto/16 :goto_0
 
-    :cond_6
+    :cond_5
     return-void
 .end method
 
@@ -16193,18 +15033,9 @@
     return-void
 .end method
 
-.method public final tieProfileLockIfNecessary(ILcom/android/internal/widget/LockscreenCredential;)V
-    .locals 7
-
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
+.method public final tieProfileLockIfNecessary(ILcom/android/internal/widget/LockscreenCredential;)V
+    .locals 7
 
-    :cond_0
     new-instance v0, Ljava/lang/StringBuilder;
 
     invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
@@ -16239,42 +15070,31 @@
 
     move-result v0
 
-    if-nez v0, :cond_1
+    if-nez v0, :cond_0
 
     return-void
 
-    :cond_1
+    :cond_0
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->getSeparateProfileChallengeEnabledInternal(I)Z
 
     move-result v0
 
-    if-eqz v0, :cond_2
+    if-eqz v0, :cond_1
 
     return-void
 
-    :cond_2
+    :cond_1
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
     invoke-virtual {v0, p1}, Lcom/android/server/locksettings/LockSettingsStorage;->hasChildProfileLock(I)Z
 
     move-result v0
 
-    if-eqz v0, :cond_3
-
-    return-void
-
-    :cond_3
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    invoke-virtual {v0, p1}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->isDualDARUser(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_2
 
     return-void
 
-    :cond_4
+    :cond_2
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
     invoke-virtual {v0, p1}, Landroid/os/UserManager;->getProfileParent(I)Landroid/content/pm/UserInfo;
@@ -16291,13 +15111,13 @@
 
     const-string v3, "LockSettingsService"
 
-    if-nez v1, :cond_5
+    if-nez v1, :cond_3
 
     invoke-virtual {p2}, Lcom/android/internal/widget/LockscreenCredential;->isNone()Z
 
     move-result v1
 
-    if-nez v1, :cond_5
+    if-nez v1, :cond_3
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -16319,7 +15139,7 @@
 
     return-void
 
-    :cond_5
+    :cond_3
     :try_start_0
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->getGateKeeperService()Landroid/service/gatekeeper/IGateKeeperService;
 
@@ -16335,11 +15155,11 @@
 
     cmp-long v1, v3, v5
 
-    if-nez v1, :cond_6
+    if-nez v1, :cond_4
 
     return-void
 
-    :cond_6
+    :cond_4
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->generateRandomProfilePassword()Lcom/android/internal/widget/LockscreenCredential;
 
     move-result-object v1
@@ -16357,7 +15177,7 @@
 
     move-result p2
 
-    if-eqz p2, :cond_7
+    if-eqz p2, :cond_5
 
     const/4 p2, 0x0
 
@@ -16367,18 +15187,18 @@
     :try_end_1
     .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :cond_7
-    if-eqz v1, :cond_8
+    :cond_5
+    if-eqz v1, :cond_6
 
     invoke-virtual {v1}, Lcom/android/internal/widget/LockscreenCredential;->close()V
 
-    :cond_8
+    :cond_6
     return-void
 
     :catchall_0
     move-exception p0
 
-    if-eqz v1, :cond_9
+    if-eqz v1, :cond_7
 
     :try_start_2
     invoke-virtual {v1}, Lcom/android/internal/widget/LockscreenCredential;->close()V
@@ -16392,7 +15212,7 @@
 
     invoke-virtual {p0, p1}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V
 
-    :cond_9
+    :cond_7
     :goto_0
     throw p0
 
@@ -16851,15 +15671,6 @@
 .method public final unlockKeystore([BI)V
     .locals 3
 
-    invoke-static {p2}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     const/4 v0, 0x0
 
     const/4 v1, 0x0
@@ -16894,13 +15705,13 @@
 
     invoke-virtual {v0, v1, p2}, Lcom/android/server/locksettings/LockSettingsStorage;->addLog(ILjava/lang/String;)V
 
-    if-eqz p1, :cond_1
+    if-eqz p1, :cond_0
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
     invoke-virtual {p0, v1}, Lcom/android/server/locksettings/LockSettingsStorage;->uploadLogFile(I)V
 
-    :cond_1
+    :cond_0
     return-void
 .end method
 
@@ -16992,15 +15803,6 @@
 .method public final unlockUser(I)V
     .locals 7
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
     move-result-object v0
@@ -17061,22 +15863,22 @@
 
     move-result v2
 
-    if-eqz v2, :cond_2
+    if-eqz v2, :cond_1
 
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->hasUnifiedChallenge(I)Z
 
     move-result p1
 
-    if-nez p1, :cond_1
+    if-nez p1, :cond_0
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/BiometricDeferredQueue;->processPendingLockoutResets()V
 
-    :cond_1
+    :cond_0
     return-void
 
-    :cond_2
+    :cond_1
     iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
     invoke-virtual {v2, p1}, Landroid/os/UserManager;->getProfiles(I)Ljava/util/List;
@@ -17087,13 +15889,13 @@
 
     move-result-object v2
 
-    :cond_3
+    :cond_2
     :goto_1
     invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z
 
     move-result v3
 
-    if-eqz v3, :cond_9
+    if-eqz v3, :cond_8
 
     invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -17103,27 +15905,27 @@
 
     iget v4, v3, Landroid/content/pm/UserInfo;->id:I
 
-    if-ne v4, p1, :cond_4
+    if-ne v4, p1, :cond_3
 
     goto :goto_1
 
-    :cond_4
+    :cond_3
     invoke-virtual {p0, v4}, Lcom/android/server/locksettings/LockSettingsService;->isCredentialSharableWithParent(I)Z
 
     move-result v4
 
-    if-nez v4, :cond_5
+    if-nez v4, :cond_4
 
     goto :goto_1
 
-    :cond_5
+    :cond_4
     iget v4, v3, Landroid/content/pm/UserInfo;->id:I
 
     invoke-virtual {p0, v4}, Lcom/android/server/locksettings/LockSettingsService;->hasUnifiedChallenge(I)Z
 
     move-result v4
 
-    if-eqz v4, :cond_7
+    if-eqz v4, :cond_6
 
     iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
@@ -17133,7 +15935,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_6
+    if-eqz v4, :cond_5
 
     iget v4, v3, Landroid/content/pm/UserInfo;->id:I
 
@@ -17141,7 +15943,7 @@
 
     goto :goto_2
 
-    :cond_6
+    :cond_5
     :try_start_2
     iget v4, v3, Landroid/content/pm/UserInfo;->id:I
 
@@ -17159,24 +15961,24 @@
 
     invoke-static {v1, v5, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    :cond_7
+    :cond_6
     :goto_2
     invoke-static {}, Landroid/os/storage/StorageManager;->isFileEncryptedNativeOrEmulated()Z
 
     move-result v4
 
-    if-eqz v4, :cond_8
+    if-eqz v4, :cond_7
 
     invoke-virtual {v3}, Landroid/content/pm/UserInfo;->isSecureFolder()Z
 
     move-result v4
 
-    if-eqz v4, :cond_8
+    if-eqz v4, :cond_7
 
     invoke-virtual {p0, v3}, Lcom/android/server/locksettings/LockSettingsService;->UnlockSecureFolderIfAutoDataDecryption(Landroid/content/pm/UserInfo;)V
 
-    :cond_8
-    if-nez v0, :cond_3
+    :cond_7
+    if-nez v0, :cond_2
 
     invoke-static {}, Lcom/android/internal/widget/ILockSettings$Stub;->clearCallingIdentity()J
 
@@ -17202,7 +16004,7 @@
 
     throw p0
 
-    :cond_9
+    :cond_8
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mBiometricDeferredQueue:Lcom/android/server/locksettings/BiometricDeferredQueue;
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/BiometricDeferredQueue;->processPendingLockoutResets()V
@@ -17222,22 +16024,13 @@
 .method public final unlockUserKey(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
     .locals 13
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isUserKeyUnlocked(I)Z
 
     move-result v0
 
     const-string v1, "LockSettingsService"
 
-    if-eqz v0, :cond_1
+    if-eqz v0, :cond_0
 
     invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
 
@@ -17253,7 +16046,7 @@
 
     return-void
 
-    :cond_1
+    :cond_0
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mUserManager:Landroid/os/UserManager;
 
     invoke-virtual {v0, p1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
@@ -17264,13 +16057,13 @@
 
     move-result v2
 
-    if-eqz v2, :cond_2
+    if-eqz v2, :cond_1
 
     const-string/jumbo v2, "secured"
 
     goto :goto_0
 
-    :cond_2
+    :cond_1
     const-string/jumbo v2, "unsecured"
 
     :goto_0
@@ -17278,12 +16071,6 @@
 
     move-result-object v3
 
-    iget-object v4, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    invoke-virtual {v4, p1, v3}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->getChangedStorageSecretIfDualDAR(I[B)[B
-
-    move-result-object v3
-
     const/4 v4, 0x1
 
     const/4 v5, 0x2
@@ -17311,15 +16098,15 @@
 
     move-result v7
 
-    if-eqz v7, :cond_4
+    if-eqz v7, :cond_3
 
-    if-eqz p2, :cond_4
+    if-eqz p2, :cond_3
 
     invoke-virtual {p2}, Lcom/android/internal/widget/VerifyCredentialResponse;->getGatekeeperHAT()[B
 
     move-result-object p2
 
-    if-eqz p2, :cond_3
+    if-eqz p2, :cond_2
 
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorageManager:Landroid/os/storage/IStorageManager;
 
@@ -17329,7 +16116,7 @@
 
     goto :goto_1
 
-    :cond_3
+    :cond_2
     new-instance p0, Ljava/lang/IllegalArgumentException;
 
     const-string p2, "Empty payload verifying a credential we just set"
@@ -17338,7 +16125,7 @@
 
     throw p0
 
-    :cond_4
+    :cond_3
     iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsService;->mStorageManager:Landroid/os/storage/IStorageManager;
 
     iget p2, v0, Landroid/content/pm/UserInfo;->serialNumber:I
@@ -17406,96 +16193,24 @@
 .method public final unlockUserKeyIfUnsecured(I)V
     .locals 14
 
-    invoke-static {p1}, Landroid/os/UserManager;->isVirtualUserId(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    return-void
-
-    :cond_0
-    const-string/jumbo v0, "migrated_dualdar_user_to_sp_and_bound_ce"
-
-    const-string/jumbo v1, "true"
-
-    invoke-virtual {p0, v0, v1, p1}, Lcom/android/server/locksettings/LockSettingsService;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string v1, "false"
-
-    invoke-static {v0, v1}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_1
-
     iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
     monitor-enter v0
 
     :try_start_0
-    const-string v2, "LockSettingsService"
-
-    const-string v3, "Migrating unsecured DualDar user."
-
-    new-array v4, v1, [Ljava/lang/Object;
-
-    invoke-static {v2, v3, v4}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->migrateUserToSpWithBoundCeKeyLocked(I)V
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const-string v0, "LockSettingsService"
-
-    const-string v2, "Migrated unsecured DualDar user."
-
-    new-array v3, v1, [Ljava/lang/Object;
-
-    invoke-static {v0, v2, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    const-string/jumbo v0, "migrated_dualdar_user_to_sp_and_bound_ce"
-
-    const-string/jumbo v2, "true"
-
-    invoke-virtual {p0, v0, v2, p1}, Lcom/android/server/locksettings/LockSettingsService;->setString(Ljava/lang/String;Ljava/lang/String;I)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_1
-    monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    throw p0
-
-    :cond_1
-    :goto_0
-    iget-object v0, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    monitor-enter v0
-
-    :try_start_2
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isUserKeyUnlocked(I)Z
 
-    move-result v2
+    move-result v1
+
+    const/4 v2, 0x0
 
     const/4 v3, 0x1
 
-    if-eqz v2, :cond_2
+    if-eqz v1, :cond_0
 
     const-string p0, "LockSettingsService"
 
-    const-string v2, "CE storage for user %d is already unlocked"
+    const-string v1, "CE storage for user %d is already unlocked"
 
     new-array v3, v3, [Ljava/lang/Object;
 
@@ -17503,51 +16218,24 @@
 
     move-result-object p1
 
-    aput-object p1, v3, v1
+    aput-object p1, v3, v2
 
-    invoke-static {p0, v2, v3}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {p0, v1, v3}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     monitor-exit v0
 
     return-void
 
-    :cond_2
+    :cond_0
     invoke-virtual {p0, p1}, Lcom/android/server/locksettings/LockSettingsService;->isUserSecure(I)Z
 
-    move-result v2
-
-    if-eqz v2, :cond_3
-
-    const-string p0, "LockSettingsService"
-
-    const-string v2, "Not unlocking CE storage for user %d yet because user is secured"
-
-    new-array v3, v3, [Ljava/lang/Object;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    aput-object p1, v3, v1
-
-    invoke-static {p0, v2, v3}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
-
-    monitor-exit v0
-
-    return-void
-
-    :cond_3
-    iget-object v2, p0, Lcom/android/server/locksettings/LockSettingsService;->mDualDarLockSettings:Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;
-
-    invoke-virtual {v2, p1}, Lcom/android/server/locksettings/LockSettingsService$DualDarLockSettings;->unlockDualDarUserKeyIfUnsecured(I)Z
-
-    move-result v2
+    move-result v1
 
-    if-nez v2, :cond_4
+    if-eqz v1, :cond_1
 
     const-string p0, "LockSettingsService"
 
-    const-string/jumbo v2, "unlocking CE storage for dualdar user %d is failed"
+    const-string v1, "Not unlocking CE storage for user %d yet because user is secured"
 
     new-array v3, v3, [Ljava/lang/Object;
 
@@ -17555,16 +16243,16 @@
 
     move-result-object p1
 
-    aput-object p1, v3, v1
+    aput-object p1, v3, v2
 
-    invoke-static {p0, v2, v3}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {p0, v1, v3}, Lcom/android/server/utils/Slogf;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     monitor-exit v0
 
     return-void
 
-    :cond_4
-    const-string v2, "LockSettingsService"
+    :cond_1
+    const-string v1, "LockSettingsService"
 
     const-string v4, "Unwrapping synthetic password for unsecured user %d"
 
@@ -17574,9 +16262,9 @@
 
     move-result-object v6
 
-    aput-object v6, v5, v1
+    aput-object v6, v5, v2
 
-    invoke-static {v2, v4, v5}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {v1, v4, v5}, Lcom/android/server/utils/Slogf;->i(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     iget-object v7, p0, Lcom/android/server/locksettings/LockSettingsService;->mSpManager:Lcom/android/server/locksettings/SyntheticPasswordManager;
 
@@ -17598,15 +16286,15 @@
 
     invoke-virtual/range {v7 .. v13}, Lcom/android/server/locksettings/SyntheticPasswordManager;->unlockLskfBasedProtector(Landroid/service/gatekeeper/IGateKeeperService;JLcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;)Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;
 
-    move-result-object v2
+    move-result-object v1
 
-    iget-object v4, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    iget-object v4, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
-    if-nez v4, :cond_5
+    if-nez v4, :cond_2
 
     const-string p0, "LockSettingsService"
 
-    const-string v2, "Failed to unwrap synthetic password for unsecured user %d"
+    const-string v1, "Failed to unwrap synthetic password for unsecured user %d"
 
     new-array v3, v3, [Ljava/lang/Object;
 
@@ -17614,18 +16302,18 @@
 
     move-result-object p1
 
-    aput-object p1, v3, v1
+    aput-object p1, v3, v2
 
-    invoke-static {p0, v2, v3}, Lcom/android/server/utils/Slogf;->wtf(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
+    invoke-static {p0, v1, v3}, Lcom/android/server/utils/Slogf;->wtf(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)V
 
     monitor-exit v0
 
     return-void
 
-    :cond_5
+    :cond_2
     invoke-virtual {p0, p1, v4}, Lcom/android/server/locksettings/LockSettingsService;->onSyntheticPasswordUnlocked(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
 
-    iget-object v1, v2, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
+    iget-object v1, v1, Lcom/android/server/locksettings/SyntheticPasswordManager$AuthenticationResult;->syntheticPassword:Lcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;
 
     invoke-virtual {p0, p1, v1}, Lcom/android/server/locksettings/LockSettingsService;->unlockUserKey(ILcom/android/server/locksettings/SyntheticPasswordManager$SyntheticPassword;)V
 
@@ -17633,12 +16321,12 @@
 
     return-void
 
-    :catchall_1
+    :catchall_0
     move-exception p0
 
     monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     throw p0
 .end method
@@ -18068,7 +16756,7 @@
     :cond_1
     const/4 v0, 0x0
 
-    const-string/jumbo v1, "lockscreen.passwordhistory"
+    const-string v1, "lockscreen.passwordhistory"
 
     invoke-virtual {p0, v1, v0, p2}, Lcom/android/server/locksettings/LockSettingsService;->getString(Ljava/lang/String;Ljava/lang/String;I)Ljava/lang/String;
 
@@ -18406,38 +17094,21 @@
 
     move-result-wide v0
 
-    :try_start_0
-    invoke-virtual {p0, p2}, Lcom/android/server/locksettings/LockSettingsService;->isEnterpriseUser(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_2
+    const/4 v2, 0x0
 
-    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredentialForEnterpriseUser(Lcom/android/internal/widget/LockscreenCredential;II)Lcom/android/internal/widget/VerifyCredentialResponse;
+    :try_start_0
+    invoke-virtual {p0, p1, p2, v2, p3}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
 
     move-result-object p1
     :try_end_0
     .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
-    :goto_1
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsService;->scheduleGc()V
 
     return-object p1
 
-    :cond_2
-    const/4 v2, 0x0
-
-    :try_start_1
-    invoke-virtual {p0, p1, p2, v2, p3}, Lcom/android/server/locksettings/LockSettingsService;->doVerifyCredential(Lcom/android/internal/widget/LockscreenCredential;ILcom/android/internal/widget/ICheckCredentialProgressCallback;I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p1
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    goto :goto_1
-
     :catchall_0
     move-exception p1
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsShellCommand.smali b/smali_classes2/com/android/server/locksettings/LockSettingsShellCommand.smali
index 6aa56ad0..7f1d2362 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsShellCommand.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsShellCommand.smali
@@ -494,7 +494,7 @@
 
     move-result p1
 
-    if-eqz p1, :cond_5
+    if-eqz p1, :cond_4
 
     iget p1, p0, Lcom/android/server/locksettings/LockSettingsShellCommand;->mCurrentUserId:I
 
@@ -515,23 +515,6 @@
     return v2
 
     :cond_4
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_5
-
-    invoke-virtual {p0}, Landroid/os/ShellCommand;->getOutPrintWriter()Ljava/io/PrintWriter;
-
-    move-result-object p0
-
-    const-string p1, "New credential doesn\'t satisfy admin policies: password null does not meet DualDAR on Device Owner Enabled"
-
-    invoke-virtual {p0, p1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
-
-    return v2
-
-    :cond_5
     return v3
 .end method
 
@@ -841,7 +824,7 @@
     goto :goto_5
 
     :sswitch_d
-    const-string/jumbo v1, "lock"
+    const-string v1, "lock"
 
     invoke-virtual {p1, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
@@ -1088,6 +1071,8 @@
 
     return v0
 
+    nop
+
     :sswitch_data_0
     .sparse-switch
         -0x57d6f0ed -> :sswitch_3
@@ -1145,7 +1130,7 @@
     move-result-object p0
 
     :try_start_0
-    const-string/jumbo v1, "lockSettings service commands:"
+    const-string v1, "lockSettings service commands:"
 
     invoke-virtual {p0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
 
@@ -1557,7 +1542,7 @@
     return-void
 
     :cond_0
-    const-string/jumbo v0, "lock"
+    const-string v0, "lock"
 
     iget-object v1, p0, Lcom/android/server/locksettings/LockSettingsShellCommand;->mType:Ljava/lang/String;
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsStorage$DatabaseHelper.smali b/smali_classes2/com/android/server/locksettings/LockSettingsStorage$DatabaseHelper.smali
index d5a6c6d3..cf8b31bd 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsStorage$DatabaseHelper.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsStorage$DatabaseHelper.smali
@@ -15,7 +15,7 @@
 
     const/4 v1, 0x3
 
-    const-string/jumbo v2, "locksettings.db"
+    const-string v2, "locksettings.db"
 
     invoke-direct {p0, p1, v2, v0, v1}, Landroid/database/sqlite/SQLiteOpenHelper;-><init>(Landroid/content/Context;Ljava/lang/String;Landroid/database/sqlite/SQLiteDatabase$CursorFactory;I)V
 
diff --git a/smali_classes2/com/android/server/locksettings/LockSettingsStorage.smali b/smali_classes2/com/android/server/locksettings/LockSettingsStorage.smali
index c573850e..941070e9 100644
--- a/smali_classes2/com/android/server/locksettings/LockSettingsStorage.smali
+++ b/smali_classes2/com/android/server/locksettings/LockSettingsStorage.smali
@@ -73,13 +73,13 @@
 
     sput-object v0, Lcom/android/server/locksettings/LockSettingsStorage;->DEFAULT:Ljava/lang/Object;
 
-    const-string/jumbo v0, "lock_pattern_visible_pattern"
+    const-string v0, "lock_pattern_visible_pattern"
 
-    const-string/jumbo v1, "lockscreen.power_button_instantly_locks"
+    const-string v1, "lockscreen.power_button_instantly_locks"
 
-    const-string/jumbo v2, "lock_screen_owner_info_enabled"
+    const-string v2, "lock_screen_owner_info_enabled"
 
-    const-string/jumbo v3, "lock_screen_owner_info"
+    const-string v3, "lock_screen_owner_info"
 
     filled-new-array {v2, v3, v0, v1}, [Ljava/lang/String;
 
@@ -99,19 +99,19 @@
 
     sput-object v0, Lcom/android/server/locksettings/LockSettingsStorage;->ivParamSpec:Ljavax/crypto/spec/IvParameterSpec;
 
-    const-string/jumbo v2, "lockscreen.samsung_biometric"
+    const-string v2, "lockscreen.samsung_biometric"
 
-    const-string/jumbo v3, "lockscreen.lockout_biometric_attempt_deadline"
+    const-string v3, "lockscreen.lockout_biometric_attempt_deadline"
 
-    const-string/jumbo v4, "lockscreen.lockoutattemptdeadline"
+    const-string v4, "lockscreen.lockoutattemptdeadline"
 
-    const-string/jumbo v5, "lock_screen_owner_info_enabled"
+    const-string v5, "lock_screen_owner_info_enabled"
 
-    const-string/jumbo v6, "lock_screen_owner_info"
+    const-string v6, "lock_screen_owner_info"
 
-    const-string/jumbo v7, "lockscreen.device_owner_info"
+    const-string v7, "lockscreen.device_owner_info"
 
-    const-string/jumbo v8, "lockscreen.disabled"
+    const-string v8, "lockscreen.disabled"
 
     filled-new-array/range {v2 .. v8}, [Ljava/lang/String;
 
@@ -129,6 +129,8 @@
 
     return-void
 
+    nop
+
     :array_0
     .array-data 4
         0x10
@@ -1382,93 +1384,16 @@
 .end method
 
 .method public getSyntheticPasswordDirectoryForUser(I)Ljava/io/File;
-    .locals 4
-
-    const-string/jumbo v0, "spblob/"
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/LockSettingsStorage;->mContext:Landroid/content/Context;
-
-    const-string/jumbo v1, "user"
-
-    invoke-virtual {p0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/os/UserManager;
-
-    invoke-virtual {p0, p1}, Landroid/os/UserManager;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    invoke-virtual {p0}, Landroid/content/pm/UserInfo;->isVirtualUser()Z
-
-    move-result p0
-
-    if-eqz p0, :cond_0
-
-    invoke-static {}, Landroid/os/Environment;->getDataSystemDirectory()Ljava/io/File;
-
-    move-result-object p0
-
-    const/4 v1, 0x3
-
-    new-array v1, v1, [Ljava/lang/String;
-
-    const-string/jumbo v2, "users"
-
-    const/4 v3, 0x0
-
-    aput-object v2, v1, v3
-
-    invoke-static {p1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;
-
-    move-result-object v2
-
-    const/4 v3, 0x1
-
-    aput-object v2, v1, v3
-
-    const/4 v2, 0x2
-
-    aput-object v0, v1, v2
-
-    invoke-static {p0, v1}, Landroid/os/Environment;->buildPath(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;
-
-    move-result-object p0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object p0
-
-    :catch_0
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "Unexpected error while get sp path for user "
-
-    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string v1, "LockSettingsStorage"
-
-    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    .locals 1
 
-    :cond_0
     new-instance p0, Ljava/io/File;
 
     invoke-static {p1}, Landroid/os/Environment;->getDataSystemDeDirectory(I)Ljava/io/File;
 
     move-result-object p1
 
+    const-string/jumbo v0, "spblob/"
+
     invoke-direct {p0, p1, v0}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
 
     return-object p0
@@ -1502,20 +1427,6 @@
     return-object p3
 .end method
 
-.method public final getVirtualUsers()[I
-    .locals 0
-
-    new-instance p0, Lcom/samsung/android/knox/dar/VirtualLockUtils;
-
-    invoke-direct {p0}, Lcom/samsung/android/knox/dar/VirtualLockUtils;-><init>()V
-
-    invoke-virtual {p0}, Lcom/samsung/android/knox/dar/VirtualLockUtils;->getVirtualUsers()[I
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public hasCarrierPassword(I)Z
     .locals 0
 
@@ -1669,7 +1580,7 @@
 .method public isAutoPinConfirmSettingEnabled(I)Z
     .locals 2
 
-    const-string/jumbo v0, "lockscreen.auto_pin_confirm"
+    const-string v0, "lockscreen.auto_pin_confirm"
 
     const/4 v1, 0x0
 
@@ -1730,7 +1641,7 @@
 .end method
 
 .method public listSyntheticPasswordProtectorsForAllUsers(Ljava/lang/String;)Ljava/util/Map;
-    .locals 6
+    .locals 4
 
     new-instance v0, Landroid/util/ArrayMap;
 
@@ -1780,34 +1691,6 @@
     goto :goto_0
 
     :cond_0
-    invoke-virtual {p0}, Lcom/android/server/locksettings/LockSettingsStorage;->getVirtualUsers()[I
-
-    move-result-object v1
-
-    array-length v2, v1
-
-    const/4 v3, 0x0
-
-    :goto_1
-    if-ge v3, v2, :cond_1
-
-    aget v4, v1, v3
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v5
-
-    invoke-virtual {p0, p1, v4}, Lcom/android/server/locksettings/LockSettingsStorage;->listSyntheticPasswordProtectorsForUser(Ljava/lang/String;I)Ljava/util/List;
-
-    move-result-object v4
-
-    invoke-interface {v0, v5, v4}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
-
-    add-int/lit8 v3, v3, 0x1
-
-    goto :goto_1
-
-    :cond_1
     return-object v0
 .end method
 
@@ -1971,7 +1854,7 @@
 
     move-result-object v2
 
-    const-string/jumbo v3, "locksettings"
+    const-string v3, "locksettings"
 
     sget-object v4, Lcom/android/server/locksettings/LockSettingsStorage;->COLUMNS_FOR_PREFETCH:[Ljava/lang/String;
 
@@ -2409,7 +2292,7 @@
 
     move-result-object v3
 
-    const-string/jumbo v4, "locksettings"
+    const-string v4, "locksettings"
 
     sget-object v5, Lcom/android/server/locksettings/LockSettingsStorage;->COLUMNS_FOR_QUERY:[Ljava/lang/String;
 
@@ -2605,7 +2488,7 @@
     invoke-virtual {p1}, Landroid/database/sqlite/SQLiteDatabase;->beginTransaction()V
 
     :try_start_0
-    const-string/jumbo v0, "locksettings"
+    const-string v0, "locksettings"
 
     const-string/jumbo v1, "name=? AND user=?"
 
@@ -2729,7 +2612,7 @@
     :try_start_0
     invoke-virtual {v0}, Landroid/database/sqlite/SQLiteDatabase;->beginTransaction()V
 
-    const-string/jumbo v2, "locksettings"
+    const-string v2, "locksettings"
 
     new-instance v3, Ljava/lang/StringBuilder;
 
@@ -3303,7 +3186,7 @@
 .method public writeKeyValue(Landroid/database/sqlite/SQLiteDatabase;Ljava/lang/String;Ljava/lang/String;I)V
     .locals 6
 
-    const-string/jumbo v0, "locksettings"
+    const-string v0, "locksettings"
 
     new-instance v1, Landroid/content/ContentValues;
 
diff --git a/smali_classes2/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager.smali b/smali_classes2/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager.smali
index 4a9b469a..a7025bec 100644
--- a/smali_classes2/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager.smali
+++ b/smali_classes2/com/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager.smali
@@ -361,53 +361,11 @@
 .end method
 
 .method public final isDualDarUser(I)Z
-    .locals 2
-
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$SdpSyntheticPasswordManager;->this$0:Lcom/android/server/locksettings/SyntheticPasswordManager;
-
-    invoke-static {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->-$$Nest$mgetUserManagerInternal(Lcom/android/server/locksettings/SyntheticPasswordManager;)Lcom/android/server/pm/UserManagerInternal;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerInternal;->getUserInfo(I)Landroid/content/pm/UserInfo;
-
-    move-result-object p0
-
-    if-eqz p0, :cond_0
-
-    iget p0, p0, Landroid/content/pm/UserInfo;->flags:I
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    const/high16 p1, 0x6000000
-
-    and-int/2addr p0, p1
-
-    if-eqz p0, :cond_0
-
-    const/4 p0, 0x1
-
-    goto :goto_0
+    .locals 0
 
-    :cond_0
     const/4 p0, 0x0
 
-    :goto_0
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
     return p0
-
-    :catchall_0
-    move-exception p0
-
-    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
 .end method
 
 .method public final isNeedToEnableSdpMdfppModeForSystem(I)Z
diff --git a/smali_classes2/com/android/server/locksettings/SyntheticPasswordManager.smali b/smali_classes2/com/android/server/locksettings/SyntheticPasswordManager.smali
index c88641b2..2f45c507 100644
--- a/smali_classes2/com/android/server/locksettings/SyntheticPasswordManager.smali
+++ b/smali_classes2/com/android/server/locksettings/SyntheticPasswordManager.smali
@@ -110,16 +110,6 @@
     return-object p0
 .end method
 
-.method public static bridge synthetic -$$Nest$mgetUserManagerInternal(Lcom/android/server/locksettings/SyntheticPasswordManager;)Lcom/android/server/pm/UserManagerInternal;
-    .locals 0
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getUserManagerInternal()Lcom/android/server/pm/UserManagerInternal;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public static bridge synthetic -$$Nest$sfgetDEBUG()Z
     .locals 1
 
@@ -729,136 +719,6 @@
     return-wide v0
 .end method
 
-.method public checkWeaverStatus()V
-    .locals 4
-
-    :try_start_0
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->isWeaverAvailable()Z
-
-    move-result v0
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_0
-
-    :catch_0
-    move-exception v0
-
-    const-string v1, "Unexpected exception while check weaver availability"
-
-    invoke-static {v1, v0}, Lcom/android/server/knox/dar/sdp/SDPLog;->e(Ljava/lang/String;Ljava/lang/Exception;)V
-
-    const/4 v0, 0x0
-
-    :goto_0
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->isWeaverSupported()Z
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    const-string p0, "SyntheticPasswordManager.SDP"
-
-    const-string v0, "Device does not support weaver"
-
-    invoke-static {p0, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return-void
-
-    :cond_0
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "Weaver is "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    if-eqz v0, :cond_1
-
-    const-string/jumbo v2, "now"
-
-    goto :goto_1
-
-    :cond_1
-    const-string v2, "NOT"
-
-    :goto_1
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    const-string v2, " available"
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v1
-
-    sget-boolean v2, Lcom/android/server/locksettings/SyntheticPasswordManager;->DEBUG:Z
-
-    if-eqz v2, :cond_2
-
-    if-eqz v0, :cond_2
-
-    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;
-
-    iget-object v2, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mWeaverConfig:Landroid/hardware/weaver/WeaverConfig;
-
-    iget v2, v2, Landroid/hardware/weaver/WeaverConfig;->slots:I
-
-    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v2
-
-    iget-object v3, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mWeaverConfig:Landroid/hardware/weaver/WeaverConfig;
-
-    iget v3, v3, Landroid/hardware/weaver/WeaverConfig;->keySize:I
-
-    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v3
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mWeaverConfig:Landroid/hardware/weaver/WeaverConfig;
-
-    iget p0, p0, Landroid/hardware/weaver/WeaverConfig;->valueSize:I
-
-    invoke-static {p0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p0
-
-    filled-new-array {v2, v3, p0}, [Ljava/lang/Object;
-
-    move-result-object p0
-
-    const-string v2, " with slots(%d), kSize(%d) and vSize(%d)"
-
-    invoke-static {v0, v2, p0}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
-
-    move-result-object p0
-
-    goto :goto_2
-
-    :cond_2
-    const-string p0, "!"
-
-    :goto_2
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {p0}, Lcom/android/server/knox/dar/sdp/SDPLog;->d(Ljava/lang/String;)V
-
-    return-void
-.end method
-
 .method public clearSidForUser(I)V
     .locals 3
 
@@ -1052,7 +912,7 @@
     :goto_3
     iget-object v6, v0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mStorage:Lcom/android/server/locksettings/LockSettingsStorage;
 
-    const-string/jumbo v7, "lockscreen.pwdata.ver"
+    const-string v7, "lockscreen.pwdata.ver"
 
     sget-object v15, Lcom/android/server/locksettings/LockSettingsServiceLog;->SECURITY_LOG_VERSION:Ljava/lang/String;
 
@@ -2195,16 +2055,6 @@
     return-void
 .end method
 
-.method public getActiveTokenForDualDar(I[B)[B
-    .locals 0
-
-    invoke-static {p2}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->deriveResetTokenForDualDAR([B)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public getCredentialType(JI)I
     .locals 1
 
@@ -2407,83 +2257,6 @@
     return-object p0
 .end method
 
-.method public getPendingTokenForDualDar(IJ)[B
-    .locals 2
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z
-
-    move-result v0
-
-    if-nez v0, :cond_0
-
-    const/4 p0, 0x0
-
-    return-object p0
-
-    :cond_0
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object v1
-
-    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/util/ArrayMap;
-
-    invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object v1
-
-    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;
-
-    iget-object v0, v0, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->aggregatedSecret:[B
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->tokenMap:Landroid/util/ArrayMap;
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Landroid/util/ArrayMap;
-
-    invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;
-
-    move-result-object p1
-
-    invoke-virtual {p0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;
-
-    iget-object p0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager$TokenData;->aggregatedSecret:[B
-
-    array-length p0, p0
-
-    invoke-static {v0, p0}, Ljava/util/Arrays;->copyOf([BI)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public getPendingTokensForUser(I)Ljava/util/Set;
     .locals 2
 
@@ -2818,20 +2591,6 @@
     return-object v1
 .end method
 
-.method public final getUserManagerInternal()Lcom/android/server/pm/UserManagerInternal;
-    .locals 0
-
-    const-class p0, Lcom/android/server/pm/UserManagerInternal;
-
-    invoke-static {p0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/pm/UserManagerInternal;
-
-    return-object p0
-.end method
-
 .method public getWeaverHidlService()Landroid/hardware/weaver/V1_0/IWeaver;
     .locals 3
 
@@ -4334,20 +4093,6 @@
     return-object p0
 .end method
 
-.method public refreshActiveSlots()V
-    .locals 1
-
-    iget-object v0, p0, Lcom/android/server/locksettings/SyntheticPasswordManager;->mPasswordSlotManager:Lcom/android/server/locksettings/PasswordSlotManager;
-
-    invoke-virtual {p0}, Lcom/android/server/locksettings/SyntheticPasswordManager;->getUsedWeaverSlots()Ljava/util/Set;
-
-    move-result-object p0
-
-    invoke-virtual {v0, p0}, Lcom/android/server/locksettings/PasswordSlotManager;->refreshActiveSlots(Ljava/util/Set;)V
-
-    return-void
-.end method
-
 .method public refreshPinLengthOnDisk(Landroid/app/admin/PasswordMetrics;JI)Z
     .locals 11
 
diff --git a/smali_classes2/com/android/server/locksettings/SyntheticPasswordMdfpp.smali b/smali_classes2/com/android/server/locksettings/SyntheticPasswordMdfpp.smali
index 8211a5a6..089468ee 100644
--- a/smali_classes2/com/android/server/locksettings/SyntheticPasswordMdfpp.smali
+++ b/smali_classes2/com/android/server/locksettings/SyntheticPasswordMdfpp.smali
@@ -56,53 +56,6 @@
     throw p0
 .end method
 
-.method public static deriveResetTokenForDualDAR([B)[B
-    .locals 2
-
-    if-eqz p0, :cond_1
-
-    array-length v0, p0
-
-    if-nez v0, :cond_0
-
-    goto :goto_0
-
-    :cond_0
-    const-string v0, "KeyEncryptionKey"
-
-    invoke-virtual {v0}, Ljava/lang/String;->getBytes()[B
-
-    move-result-object v0
-
-    const-string v1, "ForResetPasswordToken"
-
-    invoke-virtual {v1}, Ljava/lang/String;->getBytes()[B
-
-    move-result-object v1
-
-    invoke-static {p0, v0, v1}, Lcom/android/server/locksettings/SyntheticPasswordMdfpp;->doSp800Derivation([B[B[B)[B
-
-    move-result-object p0
-
-    :cond_1
-    :goto_0
-    return-object p0
-.end method
-
-.method public static doSp800Derivation([B[B[B)[B
-    .locals 1
-
-    new-instance v0, Lcom/android/server/locksettings/SP800Derive;
-
-    invoke-direct {v0, p0}, Lcom/android/server/locksettings/SP800Derive;-><init>([B)V
-
-    invoke-virtual {v0, p1, p2}, Lcom/android/server/locksettings/SP800Derive;->withContext([B[B)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public static getSecureMode(I)I
     .locals 4
 
diff --git a/smali_classes3/com/android/server/pm/ComputerEngine.smali b/smali_classes3/com/android/server/pm/ComputerEngine.smali
index 4991a688..25b8daf3 100644
--- a/smali_classes3/com/android/server/pm/ComputerEngine.smali
+++ b/smali_classes3/com/android/server/pm/ComputerEngine.smali
@@ -12349,13 +12349,13 @@
 
     move-result-object v1
 
-    if-eqz v1, :cond_6
+    if-eqz v1, :cond_4
 
     invoke-virtual {p0, v1, p3, p4}, Lcom/android/server/pm/ComputerEngine;->shouldFilterApplication(Lcom/android/server/pm/pkg/PackageStateInternal;II)Z
 
     move-result p3
 
-    if-nez p3, :cond_6
+    if-nez p3, :cond_4
 
     invoke-interface {v1, p4}, Lcom/android/server/pm/pkg/PackageStateInternal;->getUserStateOrDefault(I)Lcom/android/server/pm/pkg/PackageUserStateInternal;
 
@@ -12367,7 +12367,7 @@
 
     if-nez p3, :cond_0
 
-    goto :goto_1
+    goto :goto_0
 
     :cond_0
     if-eqz p1, :cond_1
@@ -12383,13 +12383,13 @@
     return p0
 
     :cond_1
-    iget-object p1, p0, Lcom/android/server/pm/ComputerEngine;->mFrozenPackages:Lcom/android/server/utils/WatchedArrayMap;
+    iget-object p0, p0, Lcom/android/server/pm/ComputerEngine;->mFrozenPackages:Lcom/android/server/utils/WatchedArrayMap;
 
-    invoke-virtual {p1, p2}, Lcom/android/server/utils/WatchedArrayMap;->containsKey(Ljava/lang/Object;)Z
+    invoke-virtual {p0, p2}, Lcom/android/server/utils/WatchedArrayMap;->containsKey(Ljava/lang/Object;)Z
 
-    move-result p1
+    move-result p0
 
-    if-eqz p1, :cond_2
+    if-eqz p0, :cond_2
 
     const/4 p0, 0x3
 
@@ -12400,66 +12400,25 @@
 
     invoke-interface {v1}, Lcom/android/server/pm/pkg/PackageStateInternal;->getPkg()Lcom/android/server/pm/parsing/pkg/AndroidPackageInternal;
 
-    move-result-object p1
+    move-result-object p0
 
-    invoke-static {p1}, Lcom/android/server/pm/parsing/pkg/AndroidPackageUtils;->isEncryptionAware(Lcom/android/server/pm/pkg/AndroidPackage;)Z
+    invoke-static {p0}, Lcom/android/server/pm/parsing/pkg/AndroidPackageUtils;->isEncryptionAware(Lcom/android/server/pm/pkg/AndroidPackage;)Z
 
-    move-result p1
+    move-result p0
 
-    if-nez p1, :cond_3
+    if-nez p0, :cond_3
 
     const/4 p0, 0x4
 
     return p0
 
     :cond_3
-    invoke-static {p4}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncrypted(I)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_5
-
-    invoke-static {p4}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result p1
-
-    if-eqz p1, :cond_4
-
-    invoke-static {p4}, Lcom/samsung/android/knox/SemPersonaManager;->isDoEnabled(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_4
-
-    const-string p0, "PackageManager"
-
-    const-string p1, "DualDAR at DO provisioning not completed"
-
-    invoke-static {p0, p1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
-
-    goto :goto_0
-
-    :cond_4
-    iget-object p0, p0, Lcom/android/server/pm/ComputerEngine;->mContext:Landroid/content/Context;
-
-    invoke-static {p0, p2, p4}, Lcom/android/server/pm/PersonaServiceHelper;->isPackageAllowlistedForDualDAR(Landroid/content/Context;Ljava/lang/String;I)Z
-
-    move-result p0
-
-    if-nez p0, :cond_5
-
-    const/4 p0, 0x5
-
-    return p0
-
-    :cond_5
-    :goto_0
     const/4 p0, 0x0
 
     return p0
 
-    :cond_6
-    :goto_1
+    :cond_4
+    :goto_0
     const/4 p0, 0x1
 
     return p0
diff --git a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali b/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali
index 6e68f55c..98ee8014 100644
--- a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali
+++ b/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0.smali
@@ -30,7 +30,7 @@
 
     check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
 
-    invoke-static {p0, p1}, Lcom/android/server/pm/PersonaServiceHelper;->$r8$lambda$qU_p9quRIJmlKkLEasxCBMhTQXM(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
+    invoke-static {p0, p1}, Lcom/android/server/pm/PersonaServiceHelper;->$r8$lambda$MH9Iqr1iFx0CM4kQSRv9V3xmUd4(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
 
     move-result-object p0
 
diff --git a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1.smali b/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1.smali
index 8556299e..08f5825b 100644
--- a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1.smali
+++ b/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1.smali
@@ -28,7 +28,7 @@
 
     iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1;->f$0:I
 
-    invoke-static {p0}, Lcom/android/server/pm/PersonaServiceHelper;->$r8$lambda$9JLEddoXPSNrrsHg1ZEjzNbfnsQ(I)Landroid/os/Bundle;
+    invoke-static {p0}, Lcom/android/server/pm/PersonaServiceHelper;->$r8$lambda$ZNttXnj5F3kdBemd2rS9F48iP6A(I)Landroid/os/Bundle;
 
     move-result-object p0
 
diff --git a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali b/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali
index 89458c1f..a1bdbdef 100644
--- a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali
+++ b/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2.smali
@@ -30,7 +30,7 @@
 
     check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
 
-    invoke-static {p0, p1}, Lcom/android/server/pm/PersonaServiceHelper;->$r8$lambda$MH9Iqr1iFx0CM4kQSRv9V3xmUd4(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
+    invoke-static {p0, p1}, Lcom/android/server/pm/PersonaServiceHelper;->$r8$lambda$3EAV4Y8Jm7u4BSgx8C9nm5bE4DY(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Ljava/lang/Boolean;
 
     move-result-object p0
 
diff --git a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali b/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali
deleted file mode 100644
index 0c52f0ce..00000000
--- a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3.smali
+++ /dev/null
@@ -1,36 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3;
-.super Ljava/lang/Object;
-.source "R8$$SyntheticClass"
-
-# interfaces
-.implements Ljava/util/function/Supplier;
-
-
-# instance fields
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(I)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput p1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3;->f$0:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final get()Ljava/lang/Object;
-    .locals 0
-
-    iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3;->f$0:I
-
-    invoke-static {p0}, Lcom/android/server/pm/PersonaServiceHelper;->$r8$lambda$ZNttXnj5F3kdBemd2rS9F48iP6A(I)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    return-object p0
-.end method
diff --git a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali b/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali
deleted file mode 100644
index ad30f267..00000000
--- a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4.smali
+++ /dev/null
@@ -1,38 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;
-.super Ljava/lang/Object;
-.source "R8$$SyntheticClass"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(I)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput p1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;->f$0:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 0
-
-    iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;->f$0:I
-
-    check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    invoke-static {p0, p1}, Lcom/android/server/pm/PersonaServiceHelper;->$r8$lambda$3EAV4Y8Jm7u4BSgx8C9nm5bE4DY(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Ljava/lang/Boolean;
-
-    move-result-object p0
-
-    return-object p0
-.end method
diff --git a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda5.smali b/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda5.smali
deleted file mode 100644
index ae73d760..00000000
--- a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda5.smali
+++ /dev/null
@@ -1,38 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda5;
-.super Ljava/lang/Object;
-.source "R8$$SyntheticClass"
-
-# interfaces
-.implements Ljava/util/function/Function;
-
-
-# instance fields
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(I)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput p1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda5;->f$0:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final apply(Ljava/lang/Object;)Ljava/lang/Object;
-    .locals 0
-
-    iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda5;->f$0:I
-
-    check-cast p1, Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    invoke-static {p0, p1}, Lcom/android/server/pm/PersonaServiceHelper;->$r8$lambda$KEzuO-1HRRqetgLN7L9YGFUFa5w(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    return-object p0
-.end method
diff --git a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda6.smali b/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda6.smali
deleted file mode 100644
index 009c8eae..00000000
--- a/smali_classes3/com/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda6.smali
+++ /dev/null
@@ -1,36 +0,0 @@
-.class public final synthetic Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda6;
-.super Ljava/lang/Object;
-.source "R8$$SyntheticClass"
-
-# interfaces
-.implements Ljava/util/function/Supplier;
-
-
-# instance fields
-.field public final synthetic f$0:I
-
-
-# direct methods
-.method public synthetic constructor <init>(I)V
-    .locals 0
-
-    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
-
-    iput p1, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda6;->f$0:I
-
-    return-void
-.end method
-
-
-# virtual methods
-.method public final get()Ljava/lang/Object;
-    .locals 0
-
-    iget p0, p0, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda6;->f$0:I
-
-    invoke-static {p0}, Lcom/android/server/pm/PersonaServiceHelper;->$r8$lambda$vYfkS8C7ZttYcJallIhcdZjzJHI(I)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    return-object p0
-.end method
diff --git a/smali_classes3/com/android/server/pm/PersonaServiceHelper.smali b/smali_classes3/com/android/server/pm/PersonaServiceHelper.smali
index 396d529c..5d1e5ae3 100644
--- a/smali_classes3/com/android/server/pm/PersonaServiceHelper.smali
+++ b/smali_classes3/com/android/server/pm/PersonaServiceHelper.smali
@@ -36,26 +36,6 @@
     return-object p0
 .end method
 
-.method public static synthetic $r8$lambda$9JLEddoXPSNrrsHg1ZEjzNbfnsQ(I)Landroid/os/Bundle;
-    .locals 0
-
-    invoke-static {p0}, Lcom/android/server/pm/PersonaServiceHelper;->lambda$isPackageAllowlistedForDualDAR$4(I)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public static synthetic $r8$lambda$KEzuO-1HRRqetgLN7L9YGFUFa5w(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
-    .locals 0
-
-    invoke-static {p0, p1}, Lcom/android/server/pm/PersonaServiceHelper;->lambda$isPackageAllowlistedForDEAccessForDualDAR$5(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public static synthetic $r8$lambda$MH9Iqr1iFx0CM4kQSRv9V3xmUd4(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
     .locals 0
 
@@ -76,26 +56,6 @@
     return-object p0
 .end method
 
-.method public static synthetic $r8$lambda$qU_p9quRIJmlKkLEasxCBMhTQXM(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
-    .locals 0
-
-    invoke-static {p0, p1}, Lcom/android/server/pm/PersonaServiceHelper;->lambda$isPackageAllowlistedForDualDAR$3(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
-.method public static synthetic $r8$lambda$vYfkS8C7ZttYcJallIhcdZjzJHI(I)Landroid/os/Bundle;
-    .locals 0
-
-    invoke-static {p0}, Lcom/android/server/pm/PersonaServiceHelper;->lambda$isPackageAllowlistedForDEAccessForDualDAR$6(I)Landroid/os/Bundle;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public static bridge synthetic -$$Nest$smgetApplicationPolicyService()Lcom/samsung/android/knox/application/IApplicationPolicy;
     .locals 1
 
@@ -230,52 +190,6 @@
     return-void
 .end method
 
-.method public static bytesToHex([B)Ljava/lang/String;
-    .locals 5
-
-    new-instance v0, Ljava/lang/StringBuffer;
-
-    invoke-direct {v0}, Ljava/lang/StringBuffer;-><init>()V
-
-    array-length v1, p0
-
-    const/4 v2, 0x0
-
-    :goto_0
-    if-ge v2, v1, :cond_0
-
-    aget-byte v3, p0, v2
-
-    and-int/lit16 v3, v3, 0xff
-
-    add-int/lit16 v3, v3, 0x100
-
-    const/16 v4, 0x10
-
-    invoke-static {v3, v4}, Ljava/lang/Integer;->toString(II)Ljava/lang/String;
-
-    move-result-object v3
-
-    const/4 v4, 0x1
-
-    invoke-virtual {v3, v4}, Ljava/lang/String;->substring(I)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {v0, v3}, Ljava/lang/StringBuffer;->append(Ljava/lang/String;)Ljava/lang/StringBuffer;
-
-    add-int/lit8 v2, v2, 0x1
-
-    goto :goto_0
-
-    :cond_0
-    invoke-virtual {v0}, Ljava/lang/StringBuffer;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public static canAddMoreManagedProfiles(Landroid/content/Context;ZILjava/util/List;)Z
     .locals 4
 
@@ -375,176 +289,6 @@
     return v2
 .end method
 
-.method public static comparePackageSignature(Landroid/content/Context;Ljava/lang/String;Ljava/lang/String;I)Z
-    .locals 5
-
-    const-string v0, "PersonaServiceHelper"
-
-    const/4 v1, 0x0
-
-    if-eqz p2, :cond_4
-
-    if-eqz p1, :cond_4
-
-    if-nez p3, :cond_0
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result v2
-
-    if-nez v2, :cond_0
-
-    goto :goto_3
-
-    :cond_0
-    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
-
-    move-result-wide v2
-
-    :try_start_0
-    invoke-virtual {p0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
-
-    move-result-object p0
-
-    const/high16 v4, 0x8000000
-
-    invoke-virtual {p0, p1, v4, p3}, Landroid/content/pm/PackageManager;->getPackageInfoAsUser(Ljava/lang/String;II)Landroid/content/pm/PackageInfo;
-
-    move-result-object p0
-    :try_end_0
-    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_0 .. :try_end_0} :catch_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    goto :goto_2
-
-    :catch_0
-    move-exception p0
-
-    :try_start_1
-    invoke-virtual {p0}, Landroid/content/pm/PackageManager$NameNotFoundException;->printStackTrace()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    const/4 p0, 0x0
-
-    :goto_0
-    if-eqz p0, :cond_3
-
-    iget-object p0, p0, Landroid/content/pm/PackageInfo;->signingInfo:Landroid/content/pm/SigningInfo;
-
-    if-eqz p0, :cond_3
-
-    invoke-virtual {p0}, Landroid/content/pm/SigningInfo;->getApkContentsSigners()[Landroid/content/pm/Signature;
-
-    move-result-object p0
-
-    array-length p1, p0
-
-    move p3, v1
-
-    :goto_1
-    if-ge p3, p1, :cond_3
-
-    aget-object v2, p0, p3
-
-    if-eqz v2, :cond_2
-
-    invoke-virtual {v2}, Landroid/content/pm/Signature;->toByteArray()[B
-
-    move-result-object v3
-
-    invoke-static {v3}, Lcom/android/server/pm/PersonaServiceHelper;->computeSha256DigestBytes([B)[B
-
-    move-result-object v3
-
-    invoke-static {v3}, Lcom/android/server/pm/PersonaServiceHelper;->bytesToHex([B)Ljava/lang/String;
-
-    move-result-object v3
-
-    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v3
-
-    const/4 v4, 0x1
-
-    if-eqz v3, :cond_1
-
-    return v4
-
-    :cond_1
-    invoke-virtual {v2}, Landroid/content/pm/Signature;->toCharsString()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {p2, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_2
-
-    return v4
-
-    :cond_2
-    add-int/lit8 p3, p3, 0x1
-
-    goto :goto_1
-
-    :cond_3
-    const-string p0, "FAIL to verify Pkg Signature"
-
-    invoke-static {v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-
-    :goto_2
-    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    throw p0
-
-    :cond_4
-    :goto_3
-    const-string p0, "Invalid arguments"
-
-    invoke-static {v0, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v1
-.end method
-
-.method public static computeSha256DigestBytes([B)[B
-    .locals 1
-
-    :try_start_0
-    const-string v0, "SHA256"
-
-    invoke-static {v0}, Ljava/security/MessageDigest;->getInstance(Ljava/lang/String;)Ljava/security/MessageDigest;
-
-    move-result-object v0
-    :try_end_0
-    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_0 .. :try_end_0} :catch_0
-
-    invoke-virtual {v0, p0}, Ljava/security/MessageDigest;->update([B)V
-
-    invoke-virtual {v0}, Ljava/security/MessageDigest;->digest()[B
-
-    move-result-object p0
-
-    return-object p0
-
-    :catch_0
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
 .method public static containsPackage(Ljava/lang/String;ZLandroid/content/pm/UserInfo;)Z
     .locals 2
 
@@ -902,23 +646,6 @@
 
     sget-object v0, Lcom/android/server/pm/PersonaServiceHelper;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
 
-    if-nez v0, :cond_0
-
-    const-string v0, "DualDARPolicy"
-
-    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
-
-    move-result-object v0
-
-    invoke-static {v0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy$Stub;->asInterface(Landroid/os/IBinder;)Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    move-result-object v0
-
-    sput-object v0, Lcom/android/server/pm/PersonaServiceHelper;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
-    :cond_0
-    sget-object v0, Lcom/android/server/pm/PersonaServiceHelper;->mDualDARPolicyService:Lcom/samsung/android/knox/ddar/IDualDARPolicy;
-
     invoke-static {v0}, Ljava/util/Optional;->ofNullable(Ljava/lang/Object;)Ljava/util/Optional;
 
     move-result-object v0
@@ -981,50 +708,10 @@
 .end method
 
 .method public static getDualDARUser()I
-    .locals 3
+    .locals 1
 
     invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getUserManager()Lcom/android/server/pm/UserManagerService;
 
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    invoke-virtual {v0, v1}, Lcom/android/server/pm/UserManagerService;->getUsers(Z)Ljava/util/List;
-
-    move-result-object v0
-
-    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v0
-
-    :cond_0
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_1
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/content/pm/UserInfo;
-
-    if-eqz v1, :cond_0
-
-    iget v2, v1, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {v2}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_0
-
-    iget v0, v1, Landroid/content/pm/UserInfo;->id:I
-
-    return v0
-
-    :cond_1
     const/4 v0, -0x1
 
     return v0
@@ -1544,9 +1231,9 @@
 
     move-result-object v0
 
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;
+    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
 
-    invoke-direct {v1, p0}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda4;-><init>(I)V
+    invoke-direct {v1, p0}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;-><init>(I)V
 
     invoke-virtual {v0, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
@@ -1581,17 +1268,17 @@
 
     move-result-object v1
 
-    new-instance v2, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;
+    new-instance v2, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
 
-    invoke-direct {v2, p0}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda2;-><init>(I)V
+    invoke-direct {v2, p0}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;-><init>(I)V
 
     invoke-virtual {v1, v2}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
 
     move-result-object v1
 
-    new-instance v2, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3;
+    new-instance v2, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1;
 
-    invoke-direct {v2, p0}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda3;-><init>(I)V
+    invoke-direct {v2, p0}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1;-><init>(I)V
 
     invoke-virtual {v1, v2}, Ljava/util/Optional;->orElseGet(Ljava/util/function/Supplier;)Ljava/lang/Object;
 
@@ -1842,53 +1529,15 @@
 .method public static isDualDAREnabled()Z
     .locals 3
 
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getUserManager()Lcom/android/server/pm/UserManagerService;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    invoke-virtual {v0, v1}, Lcom/android/server/pm/UserManagerService;->getUsers(Z)Ljava/util/List;
-
-    move-result-object v0
-
-    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object v0
-
-    :cond_0
-    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_1
-
-    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Landroid/content/pm/UserInfo;
-
-    if-eqz v2, :cond_0
-
-    iget v2, v2, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {v2}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_0
-
-    const/4 v1, 0x1
-
-    :cond_1
     new-instance v0, Ljava/lang/StringBuilder;
 
     invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
 
-    const-string v2, "isDualDAREnabled result : "
+    const-string v1, "isDualDAREnabled result : "
 
-    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    const/4 v1, 0x0
 
     invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
 
@@ -1935,315 +1584,66 @@
 .method public static isLastChosenActivity(Lcom/android/server/pm/Computer;Landroid/content/Intent;Ljava/lang/String;ILcom/android/server/pm/WatchedIntentFilter;ILandroid/content/ComponentName;Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PreferredActivityHelper;)Z
     .locals 13
 
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isForKnoxNFC()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const-string v0, "com.samsung.sec.knox.EXTRA_KNOX_ARRAY"
-
-    move-object v2, p1
-
-    invoke-virtual {p1, v0}, Landroid/content/Intent;->getIntegerArrayListExtra(Ljava/lang/String;)Ljava/util/ArrayList;
-
-    move-result-object v9
-
-    if-eqz v9, :cond_0
-
-    const-string v0, "Set last chosen activity with user list."
-
-    const-string v12, "PersonaServiceHelper"
-
-    invoke-static {v12, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    move/from16 v0, p3
-
-    int-to-long v4, v0
-
-    move-object v1, p0
-
-    move-object v2, p1
-
-    move-object v3, p2
-
-    move-object/from16 v6, p4
-
-    move/from16 v7, p5
-
-    move-object/from16 v8, p6
-
-    move-object/from16 v10, p7
-
-    move-object/from16 v11, p8
-
-    invoke-static/range {v1 .. v11}, Lcom/android/server/pm/PersonaServiceHelper;->setLastChosenActivityForKnox(Lcom/android/server/pm/Computer;Landroid/content/Intent;Ljava/lang/String;JLcom/android/server/pm/WatchedIntentFilter;ILandroid/content/ComponentName;Ljava/util/List;Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PreferredActivityHelper;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    const-string/jumbo v0, "set last chosen activity has been handled by Knox logic"
-
-    invoke-static {v12, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 v0, 0x1
-
-    return v0
-
-    :cond_0
-    const/4 v0, 0x0
-
-    return v0
-.end method
-
-.method public static isPackageAllowlistedForDEAccessForDualDAR(Landroid/content/Context;Ljava/lang/String;I)Z
-    .locals 5
-
-    invoke-static {p2, p1}, Lcom/android/server/pm/PersonaServiceHelper;->isSystemApp(ILjava/lang/String;)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo p2, "system app allowed - "
-
-    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string p1, "PersonaServiceHelper"
-
-    invoke-static {p1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x1
-
-    return p0
-
-    :cond_0
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARPolicyService()Ljava/util/Optional;
-
-    move-result-object v0
-
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda5;
-
-    invoke-direct {v1, p2}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda5;-><init>(I)V
-
-    invoke-virtual {v0, v1}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v0
-
-    new-instance v1, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda6;
-
-    invoke-direct {v1, p2}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda6;-><init>(I)V
-
-    invoke-virtual {v0, v1}, Ljava/util/Optional;->orElseGet(Ljava/util/function/Supplier;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/os/Bundle;
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_2
-
-    new-instance v2, Ljava/util/ArrayList;
-
-    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V
-
-    const-string v3, "dualdar-config-datalock-whitelistpackages"
-
-    invoke-virtual {v0, v3}, Landroid/os/Bundle;->getParcelableArray(Ljava/lang/String;)[Landroid/os/Parcelable;
-
-    move-result-object v0
-
-    array-length v3, v0
-
-    :goto_0
-    if-ge v1, v3, :cond_1
-
-    aget-object v4, v0, v1
-
-    check-cast v4, Lcom/samsung/android/knox/AppIdentity;
-
-    invoke-interface {v2, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z
-
-    add-int/lit8 v1, v1, 0x1
-
-    goto :goto_0
-
-    :cond_1
-    invoke-static {p0, p2, p1, v2}, Lcom/android/server/pm/PersonaServiceHelper;->verifyPackageForDualDAR(Landroid/content/Context;ILjava/lang/String;Ljava/util/List;)Z
-
-    move-result p0
-
-    return p0
-
-    :cond_2
-    return v1
-.end method
-
-.method public static isPackageAllowlistedForDualDAR(Landroid/content/Context;Ljava/lang/String;I)Z
-    .locals 8
-
-    invoke-static {p2, p1}, Lcom/android/server/pm/PersonaServiceHelper;->isSystemApp(ILjava/lang/String;)Z
-
-    move-result v0
-
-    const-string v1, "PersonaServiceHelper"
-
-    const/4 v2, 0x1
-
-    if-eqz v0, :cond_0
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo p2, "system app allowed - "
-
-    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    return v2
-
-    :cond_0
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARPolicyService()Ljava/util/Optional;
-
-    move-result-object v0
-
-    new-instance v3, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;
-
-    invoke-direct {v3, p2}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda0;-><init>(I)V
-
-    invoke-virtual {v0, v3}, Ljava/util/Optional;->map(Ljava/util/function/Function;)Ljava/util/Optional;
-
-    move-result-object v0
-
-    new-instance v3, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1;
-
-    invoke-direct {v3, p2}, Lcom/android/server/pm/PersonaServiceHelper$$ExternalSyntheticLambda1;-><init>(I)V
-
-    invoke-virtual {v0, v3}, Ljava/util/Optional;->orElseGet(Ljava/util/function/Supplier;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Landroid/os/Bundle;
-
-    const/4 v3, 0x0
-
-    if-eqz v0, :cond_3
-
-    new-instance v4, Ljava/util/ArrayList;
-
-    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V
-
-    const-string v5, "dualdar-config-datalock-whitelistpackages"
-
-    invoke-virtual {v0, v5}, Landroid/os/Bundle;->getParcelableArray(Ljava/lang/String;)[Landroid/os/Parcelable;
-
-    move-result-object v0
-
-    array-length v5, v0
-
-    move v6, v3
-
-    :goto_0
-    if-ge v6, v5, :cond_1
-
-    aget-object v7, v0, v6
-
-    check-cast v7, Lcom/samsung/android/knox/AppIdentity;
-
-    invoke-interface {v4, v7}, Ljava/util/List;->add(Ljava/lang/Object;)Z
-
-    add-int/lit8 v6, v6, 0x1
-
-    goto :goto_0
-
-    :cond_1
-    :try_start_0
-    invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
+    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isForKnoxNFC()Z
 
-    move-result-object v0
+    move-result v0
 
-    const-wide/16 v5, 0x80
+    if-eqz v0, :cond_0
 
-    invoke-interface {v0, p1, v5, v6, p2}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;JI)Landroid/content/pm/ApplicationInfo;
+    const-string v0, "com.samsung.sec.knox.EXTRA_KNOX_ARRAY"
 
-    move-result-object v0
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
+    move-object v2, p1
 
-    goto :goto_1
+    invoke-virtual {p1, v0}, Landroid/content/Intent;->getIntegerArrayListExtra(Ljava/lang/String;)Ljava/util/ArrayList;
 
-    :catch_0
-    move-exception v0
+    move-result-object v9
 
-    invoke-virtual {v0}, Landroid/os/RemoteException;->printStackTrace()V
+    if-eqz v9, :cond_0
 
-    const/4 v0, 0x0
+    const-string v0, "Set last chosen activity with user list."
 
-    :goto_1
-    if-eqz v0, :cond_3
+    const-string v12, "PersonaServiceHelper"
 
-    invoke-virtual {v0}, Landroid/content/pm/ApplicationInfo;->isDirectBootAware()Z
+    invoke-static {v12, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result v5
+    move/from16 v0, p3
 
-    if-nez v5, :cond_2
+    int-to-long v4, v0
 
-    invoke-virtual {v0}, Landroid/content/pm/ApplicationInfo;->isPartiallyDirectBootAware()Z
+    move-object v1, p0
 
-    move-result v0
+    move-object v2, p1
 
-    if-eqz v0, :cond_3
+    move-object v3, p2
 
-    :cond_2
-    invoke-static {p0, p2, p1, v4}, Lcom/android/server/pm/PersonaServiceHelper;->verifyPackageForDualDAR(Landroid/content/Context;ILjava/lang/String;Ljava/util/List;)Z
+    move-object/from16 v6, p4
 
-    move-result p0
+    move/from16 v7, p5
 
-    if-eqz p0, :cond_3
+    move-object/from16 v8, p6
 
-    new-instance p0, Ljava/lang/StringBuilder;
+    move-object/from16 v10, p7
 
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
+    move-object/from16 v11, p8
 
-    const-string p2, "checkPackageStartable direct boot aware and whitelisted allowed: "
+    invoke-static/range {v1 .. v11}, Lcom/android/server/pm/PersonaServiceHelper;->setLastChosenActivityForKnox(Lcom/android/server/pm/Computer;Landroid/content/Intent;Ljava/lang/String;JLcom/android/server/pm/WatchedIntentFilter;ILandroid/content/ComponentName;Ljava/util/List;Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PreferredActivityHelper;)Z
 
-    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    move-result v0
 
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    if-eqz v0, :cond_0
 
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    const-string/jumbo v0, "set last chosen activity has been handled by Knox logic"
 
-    move-result-object p0
+    invoke-static {v12, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {v1, p0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    const/4 v0, 0x1
 
-    goto :goto_2
+    return v0
 
-    :cond_3
-    move v2, v3
+    :cond_0
+    const/4 v0, 0x0
 
-    :goto_2
-    return v2
+    return v0
 .end method
 
 .method public static isRequiredAppForKnox(Landroid/os/Bundle;ILjava/lang/String;)Z
@@ -2720,118 +2120,6 @@
     return-object p0
 .end method
 
-.method public static synthetic lambda$isPackageAllowlistedForDEAccessForDualDAR$5(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
-    .locals 2
-
-    :try_start_0
-    new-instance v0, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v1
-
-    invoke-direct {v0, v1, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object p0
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
-.method public static synthetic lambda$isPackageAllowlistedForDEAccessForDualDAR$6(I)Landroid/os/Bundle;
-    .locals 2
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "checkPackageStartable failed to acquire dualDARPolicy for user: "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string v0, "PersonaServiceHelper"
-
-    invoke-static {v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
-.method public static synthetic lambda$isPackageAllowlistedForDualDAR$3(ILcom/samsung/android/knox/ddar/IDualDARPolicy;)Landroid/os/Bundle;
-    .locals 2
-
-    :try_start_0
-    new-instance v0, Lcom/samsung/android/knox/ContextInfo;
-
-    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
-
-    move-result v1
-
-    invoke-direct {v0, v1, p0}, Lcom/samsung/android/knox/ContextInfo;-><init>(II)V
-
-    invoke-interface {p1, v0}, Lcom/samsung/android/knox/ddar/IDualDARPolicy;->getConfig(Lcom/samsung/android/knox/ContextInfo;)Landroid/os/Bundle;
-
-    move-result-object p0
-    :try_end_0
-    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
-
-    return-object p0
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Landroid/os/RemoteException;->printStackTrace()V
-
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
-.method public static synthetic lambda$isPackageAllowlistedForDualDAR$4(I)Landroid/os/Bundle;
-    .locals 2
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "checkPackageStartable failed to acquire dualDARPolicy for user: "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    const-string v0, "PersonaServiceHelper"
-
-    invoke-static {v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
 .method public static setLastChosenActivityForKnox(Lcom/android/server/pm/Computer;Landroid/content/Intent;Ljava/lang/String;JLcom/android/server/pm/WatchedIntentFilter;ILandroid/content/ComponentName;Ljava/util/List;Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PreferredActivityHelper;)Z
     .locals 24
 
@@ -4002,116 +3290,3 @@
 
     throw p0
 .end method
-
-.method public static verifyPackageForDualDAR(Landroid/content/Context;ILjava/lang/String;Ljava/util/List;)Z
-    .locals 3
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v1, "verifyPackageForDualDAR package: "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const-string v1, "PersonaServiceHelper"
-
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-interface {p3}, Ljava/util/List;->iterator()Ljava/util/Iterator;
-
-    move-result-object p3
-
-    :cond_0
-    invoke-interface {p3}, Ljava/util/Iterator;->hasNext()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    invoke-interface {p3}, Ljava/util/Iterator;->next()Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/samsung/android/knox/AppIdentity;
-
-    invoke-virtual {v0}, Lcom/samsung/android/knox/AppIdentity;->getPackageName()Ljava/lang/String;
-
-    move-result-object v2
-
-    invoke-virtual {p2, v2}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I
-
-    move-result v2
-
-    if-nez v2, :cond_0
-
-    goto :goto_0
-
-    :cond_1
-    const/4 v0, 0x0
-
-    :goto_0
-    if-nez v0, :cond_2
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string p1, "Package not whitelisted: "
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    invoke-static {v1, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    const/4 p0, 0x0
-
-    return p0
-
-    :cond_2
-    invoke-virtual {v0}, Lcom/samsung/android/knox/AppIdentity;->getSignature()Ljava/lang/String;
-
-    move-result-object p2
-
-    if-eqz p2, :cond_3
-
-    invoke-virtual {v0}, Lcom/samsung/android/knox/AppIdentity;->getSignature()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-virtual {p2}, Ljava/lang/String;->length()I
-
-    move-result p2
-
-    if-lez p2, :cond_3
-
-    invoke-virtual {v0}, Lcom/samsung/android/knox/AppIdentity;->getPackageName()Ljava/lang/String;
-
-    move-result-object p2
-
-    invoke-virtual {v0}, Lcom/samsung/android/knox/AppIdentity;->getSignature()Ljava/lang/String;
-
-    move-result-object p3
-
-    invoke-static {p0, p2, p3, p1}, Lcom/android/server/pm/PersonaServiceHelper;->comparePackageSignature(Landroid/content/Context;Ljava/lang/String;Ljava/lang/String;I)Z
-
-    move-result p0
-
-    return p0
-
-    :cond_3
-    const/4 p0, 0x1
-
-    return p0
-.end method
diff --git a/smali_classes3/com/android/server/pm/UserManagerService$LocalService.smali b/smali_classes3/com/android/server/pm/UserManagerService$LocalService.smali
index 6ab64711..0e33a7a3 100644
--- a/smali_classes3/com/android/server/pm/UserManagerService$LocalService.smali
+++ b/smali_classes3/com/android/server/pm/UserManagerService$LocalService.smali
@@ -1252,19 +1252,8 @@
 .end method
 
 .method public isUserUnlocked(I)Z
-    .locals 3
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncrypted(I)Z
-
-    move-result v0
-
-    const/4 v1, 0x0
-
-    if-eqz v0, :cond_0
-
-    return v1
+    .locals 2
 
-    :cond_0
     iget-object v0, p0, Lcom/android/server/pm/UserManagerService$LocalService;->this$0:Lcom/android/server/pm/UserManagerService;
 
     invoke-static {v0}, Lcom/android/server/pm/UserManagerService;->-$$Nest$fgetmUserStates(Lcom/android/server/pm/UserManagerService;)Lcom/android/server/pm/UserManagerService$WatchedUserStates;
@@ -1280,9 +1269,9 @@
 
     move-result-object p0
 
-    const/4 v2, -0x1
+    const/4 v1, -0x1
 
-    invoke-virtual {p0, p1, v2}, Lcom/android/server/pm/UserManagerService$WatchedUserStates;->get(II)I
+    invoke-virtual {p0, p1, v1}, Lcom/android/server/pm/UserManagerService$WatchedUserStates;->get(II)I
 
     move-result p0
 
@@ -1292,26 +1281,31 @@
 
     const/4 v0, 0x4
 
-    if-eq p0, v0, :cond_3
+    if-eq p0, v0, :cond_2
 
     const/4 v0, 0x5
 
-    if-ne p0, v0, :cond_1
+    if-ne p0, v0, :cond_0
 
-    goto :goto_0
+    goto :goto_1
 
-    :cond_1
+    :cond_0
     const/4 p1, 0x3
 
-    if-ne p0, p1, :cond_2
+    if-ne p0, p1, :cond_1
 
-    const/4 v1, 0x1
+    const/4 p0, 0x1
 
-    :cond_2
-    return v1
+    goto :goto_0
+
+    :cond_1
+    const/4 p0, 0x0
 
-    :cond_3
     :goto_0
+    return p0
+
+    :cond_2
+    :goto_1
     invoke-static {p1}, Landroid/os/storage/StorageManager;->isUserKeyUnlocked(I)Z
 
     move-result p0
diff --git a/smali_classes3/com/android/server/pm/UserManagerService.smali b/smali_classes3/com/android/server/pm/UserManagerService.smali
index 6a90d300..e8571460 100644
--- a/smali_classes3/com/android/server/pm/UserManagerService.smali
+++ b/smali_classes3/com/android/server/pm/UserManagerService.smali
@@ -4843,7 +4843,7 @@
 .end method
 
 .method public final createUserInternalUncheckedNoTracing(Ljava/lang/String;Ljava/lang/String;IIZ[Ljava/lang/String;Lcom/android/server/utils/TimingsTraceAndSlog;Ljava/lang/Object;)Landroid/content/pm/UserInfo;
-    .locals 29
+    .locals 26
 
     move-object/from16 v1, p0
 
@@ -5175,76 +5175,32 @@
     const/4 v11, 0x0
 
     :goto_3
-    const/high16 v14, 0x4000000
+    if-eqz v20, :cond_e
 
-    and-int/2addr v14, v7
-
-    if-eqz v14, :cond_d
-
-    move v14, v13
+    if-eqz v19, :cond_d
 
     goto :goto_4
 
     :cond_d
-    const/4 v14, 0x0
-
-    :goto_4
-    const/high16 v21, 0x2000000
-
-    and-int v21, v7, v21
-
-    if-eqz v21, :cond_e
-
-    move/from16 v21, v13
+    move v14, v13
 
     goto :goto_5
 
     :cond_e
-    const/16 v21, 0x0
+    :goto_4
+    const/4 v14, 0x0
 
     :goto_5
-    if-nez v14, :cond_10
+    if-eqz v12, :cond_f
 
-    if-eqz v21, :cond_f
+    const/high16 v21, 0x40000
 
-    goto :goto_6
+    or-int v7, v7, v21
 
     :cond_f
-    const/16 v22, 0x0
-
-    goto :goto_7
-
-    :cond_10
-    :goto_6
-    move/from16 v22, v13
-
-    :goto_7
-    if-eqz v20, :cond_11
-
-    if-eqz v19, :cond_12
-
-    :cond_11
-    if-eqz v22, :cond_13
-
-    :cond_12
-    move/from16 v22, v13
-
-    goto :goto_8
-
-    :cond_13
-    const/16 v22, 0x0
-
-    :goto_8
-    if-eqz v12, :cond_14
-
-    const/high16 v23, 0x40000
-
-    or-int v7, v7, v23
-
-    :cond_14
     invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
 
-    move-result-wide v23
+    move-result-wide v21
 
     :try_start_1
     iget-object v10, v1, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
@@ -5255,7 +5211,7 @@
 
     const/16 v13, -0x2710
 
-    if-eq v2, v13, :cond_16
+    if-eq v2, v13, :cond_11
 
     :try_start_2
     iget-object v13, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
@@ -5267,13 +5223,13 @@
     :try_start_3
     invoke-virtual {v1, v2}, Lcom/android/server/pm/UserManagerService;->getUserDataLU(I)Lcom/android/server/pm/UserManagerService$UserData;
 
-    move-result-object v25
+    move-result-object v23
 
     monitor-exit v13
     :try_end_3
     .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
-    if-nez v25, :cond_15
+    if-nez v23, :cond_10
 
     :try_start_4
     new-instance v13, Ljava/lang/StringBuilder;
@@ -5296,10 +5252,10 @@
     :try_end_4
     .catchall {:try_start_4 .. :try_end_4} :catchall_1
 
-    :cond_15
-    move-object/from16 v5, v25
+    :cond_10
+    move-object/from16 v5, v23
 
-    goto :goto_a
+    goto :goto_7
 
     :catchall_0
     move-exception v0
@@ -5315,240 +5271,233 @@
     :catchall_1
     move-exception v0
 
-    move-object/from16 v27, v10
+    move-object/from16 v25, v10
 
     const/4 v9, 0x0
 
-    :goto_9
+    :goto_6
     const/4 v12, 0x0
 
-    goto/16 :goto_1e
+    goto/16 :goto_1a
 
-    :cond_16
+    :cond_11
     const/4 v5, 0x0
 
-    :goto_a
-    if-nez v3, :cond_17
+    :goto_7
+    if-nez v3, :cond_12
 
     invoke-virtual {v1, v6}, Lcom/android/server/pm/UserManagerService;->canAddMoreUsersOfType(Lcom/android/server/pm/UserTypeDetails;)Z
 
     move-result v13
 
-    if-nez v13, :cond_17
+    if-nez v13, :cond_12
 
-    if-nez v15, :cond_17
+    if-nez v15, :cond_12
 
     new-instance v13, Ljava/lang/StringBuilder;
 
     invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V
 
-    move/from16 v25, v14
-
-    const-string v14, "Cannot add more users of type "
+    const-string v4, "Cannot add more users of type "
 
-    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v13, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v13, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v14, ". Maximum number of that type already exists."
+    const-string v4, ". Maximum number of that type already exists."
 
-    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v13, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v13
-
-    const/4 v14, 0x6
-
-    invoke-virtual {v1, v13, v14}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(Ljava/lang/String;I)V
+    move-result-object v4
 
-    goto :goto_b
+    const/4 v13, 0x6
 
-    :cond_17
-    move/from16 v25, v14
+    invoke-virtual {v1, v4, v13}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(Ljava/lang/String;I)V
 
-    :goto_b
-    if-nez v17, :cond_18
+    :cond_12
+    if-nez v17, :cond_13
 
-    if-nez v20, :cond_18
+    if-nez v20, :cond_13
 
-    if-nez v8, :cond_18
+    if-nez v8, :cond_13
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/UserManagerService;->isUserLimitReached()Z
 
-    move-result v8
+    move-result v4
 
-    if-eqz v8, :cond_18
+    if-eqz v4, :cond_13
 
-    if-nez v15, :cond_18
+    if-nez v15, :cond_13
 
-    if-nez v11, :cond_18
+    if-nez v11, :cond_13
 
-    if-nez v19, :cond_18
+    if-nez v19, :cond_13
 
-    const-string v8, "Cannot add user. Maximum user limit is reached."
+    const-string v4, "Cannot add user. Maximum user limit is reached."
 
-    const/4 v13, 0x6
+    const/4 v8, 0x6
 
-    invoke-virtual {v1, v8, v13}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(Ljava/lang/String;I)V
+    invoke-virtual {v1, v4, v8}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(Ljava/lang/String;I)V
     :try_end_6
     .catchall {:try_start_6 .. :try_end_6} :catchall_1
 
-    :cond_18
-    if-eqz v16, :cond_19
+    :cond_13
+    if-eqz v16, :cond_14
 
-    const/4 v8, 0x0
+    const/4 v4, 0x0
 
     :try_start_7
-    invoke-virtual {v1, v0, v2, v8, v7}, Lcom/android/server/pm/UserManagerService;->canAddMoreProfilesToUser(Ljava/lang/String;IZI)Z
+    invoke-virtual {v1, v0, v2, v4, v7}, Lcom/android/server/pm/UserManagerService;->canAddMoreProfilesToUser(Ljava/lang/String;IZI)Z
 
-    move-result v13
+    move-result v8
     :try_end_7
     .catchall {:try_start_7 .. :try_end_7} :catchall_2
 
-    if-nez v13, :cond_19
+    if-nez v8, :cond_14
 
     :try_start_8
-    new-instance v8, Ljava/lang/StringBuilder;
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    const-string v13, "Cannot add more profiles of type "
+    const-string v8, "Cannot add more profiles of type "
 
-    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v8, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    const-string v13, " for user "
+    const-string v8, " for user "
 
-    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v8, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v8
+    move-result-object v4
 
-    const/4 v13, 0x6
+    const/4 v8, 0x6
 
-    invoke-virtual {v1, v8, v13}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(Ljava/lang/String;I)V
+    invoke-virtual {v1, v4, v8}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(Ljava/lang/String;I)V
     :try_end_8
     .catchall {:try_start_8 .. :try_end_8} :catchall_1
 
-    goto :goto_c
+    goto :goto_8
 
     :catchall_2
     move-exception v0
 
-    move v9, v8
+    move v9, v4
 
-    move-object/from16 v27, v10
+    move-object/from16 v25, v10
 
-    goto :goto_9
+    goto :goto_6
 
-    :cond_19
-    :goto_c
+    :cond_14
+    :goto_8
     :try_start_9
-    sget-boolean v8, Lcom/samsung/android/rune/PMRune;->UM_BMODE:Z
+    sget-boolean v4, Lcom/samsung/android/rune/PMRune;->UM_BMODE:Z
     :try_end_9
     .catchall {:try_start_9 .. :try_end_9} :catchall_16
 
-    if-eqz v8, :cond_1b
+    if-eqz v4, :cond_16
 
-    if-eqz v19, :cond_1b
+    if-eqz v19, :cond_16
 
-    const/4 v8, 0x1
+    const/4 v4, 0x1
 
     :try_start_a
-    invoke-virtual {v1, v8}, Lcom/android/server/pm/UserManagerService;->getUsers(Z)Ljava/util/List;
+    invoke-virtual {v1, v4}, Lcom/android/server/pm/UserManagerService;->getUsers(Z)Ljava/util/List;
 
-    move-result-object v13
+    move-result-object v8
 
-    invoke-static {v13}, Lcom/samsung/android/server/pm/user/BmodeUtils;->getBmodeUser(Ljava/util/List;)Landroid/content/pm/UserInfo;
+    invoke-static {v8}, Lcom/samsung/android/server/pm/user/BmodeUtils;->getBmodeUser(Ljava/util/List;)Landroid/content/pm/UserInfo;
 
-    move-result-object v8
+    move-result-object v4
 
-    if-eqz v8, :cond_1b
+    if-eqz v4, :cond_16
 
     monitor-exit v10
     :try_end_a
     .catchall {:try_start_a .. :try_end_a} :catchall_3
 
-    const/4 v13, 0x0
+    const/4 v4, 0x0
 
-    if-eqz v15, :cond_1a
+    if-eqz v15, :cond_15
 
-    invoke-virtual {v1, v13}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
+    invoke-virtual {v1, v4}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_1a
-    invoke-static/range {v23 .. v24}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_15
+    invoke-static/range {v21 .. v22}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return-object v13
+    return-object v4
 
     :catchall_3
     move-exception v0
 
-    const/4 v13, 0x0
+    const/4 v4, 0x0
 
-    :goto_d
-    move-object/from16 v27, v10
+    :goto_9
+    move-object v12, v4
 
-    move-object v12, v13
+    move-object/from16 v25, v10
 
-    :goto_e
+    :goto_a
     const/4 v9, 0x0
 
-    goto/16 :goto_1e
+    goto/16 :goto_1a
 
-    :cond_1b
-    const/4 v13, 0x0
+    :cond_16
+    const/4 v4, 0x0
 
-    if-eqz v18, :cond_1c
+    if-eqz v18, :cond_17
 
-    if-eqz v2, :cond_1c
+    if-eqz v2, :cond_17
 
     :try_start_b
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/UserManagerService;->isCreationOverrideEnabled()Z
 
     move-result v8
 
-    if-nez v8, :cond_1c
+    if-nez v8, :cond_17
 
     const-string v8, "Cannot add restricted profile - parent user must be system"
 
-    const/4 v14, 0x1
+    const/4 v13, 0x1
 
-    invoke-virtual {v1, v8, v14}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(Ljava/lang/String;I)V
+    invoke-virtual {v1, v8, v13}, Lcom/android/server/pm/UserManagerService;->throwCheckedUserOperationException(Ljava/lang/String;I)V
     :try_end_b
     .catchall {:try_start_b .. :try_end_b} :catchall_4
 
-    goto :goto_f
+    goto :goto_b
 
     :catchall_4
     move-exception v0
 
-    goto :goto_d
+    goto :goto_9
 
-    :cond_1c
-    :goto_f
-    if-eqz v15, :cond_1d
+    :cond_17
+    :goto_b
+    if-eqz v15, :cond_18
 
     const/16 v8, 0x4d
 
-    :goto_10
-    move v14, v8
+    :goto_c
+    move v13, v8
 
-    goto :goto_11
+    goto :goto_d
 
-    :cond_1d
+    :cond_18
     :try_start_c
     invoke-virtual {v1, v12, v11}, Lcom/android/server/pm/UserManagerService;->getNextAvailableId(ZZ)I
 
     move-result v8
 
-    goto :goto_10
+    goto :goto_c
 
-    :goto_11
+    :goto_d
     const-string v8, "UserManagerService"
 
     new-instance v11, Ljava/lang/StringBuilder;
@@ -5558,37 +5507,37 @@
     .catchall {:try_start_c .. :try_end_c} :catchall_15
 
     :try_start_d
-    const-string v13, "Creating user "
+    const-string v4, "Creating user "
 
-    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v11, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v11, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    const-string v13, " of type "
+    const-string v4, " of type "
 
-    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v11, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v11, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v11
+    move-result-object v4
 
-    invoke-static {v8, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v8, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {v14}, Landroid/os/Environment;->getUserSystemDirectory(I)Ljava/io/File;
+    invoke-static {v13}, Landroid/os/Environment;->getUserSystemDirectory(I)Ljava/io/File;
 
-    move-result-object v8
+    move-result-object v4
 
-    invoke-virtual {v8}, Ljava/io/File;->mkdirs()Z
+    invoke-virtual {v4}, Ljava/io/File;->mkdirs()Z
 
-    iget-object v13, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
-    monitor-enter v13
+    monitor-enter v4
     :try_end_d
     .catchall {:try_start_d .. :try_end_d} :catchall_16
 
-    if-eqz v5, :cond_1e
+    if-eqz v5, :cond_19
 
     :try_start_e
     iget-object v8, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
@@ -5599,63 +5548,58 @@
     :try_end_e
     .catchall {:try_start_e .. :try_end_e} :catchall_5
 
-    if-eqz v8, :cond_1e
+    if-eqz v8, :cond_19
 
     or-int/lit16 v7, v7, 0x100
 
-    goto :goto_12
+    goto :goto_f
 
     :catchall_5
     move-exception v0
 
-    move-object/from16 v27, v10
+    move-object/from16 v25, v10
 
+    :goto_e
     const/4 v9, 0x0
 
     const/4 v12, 0x0
 
-    goto/16 :goto_1c
+    goto/16 :goto_18
 
-    :cond_1e
-    :goto_12
-    if-eqz v3, :cond_1f
+    :cond_19
+    :goto_f
+    if-eqz v3, :cond_1a
 
     and-int/lit16 v7, v7, -0x101
 
-    :cond_1f
+    :cond_1a
     and-int/lit16 v8, v7, 0x100
 
-    if-eqz v8, :cond_20
+    if-eqz v8, :cond_1b
 
     or-int/lit16 v7, v7, 0x2000
 
-    :cond_20
-    move v8, v7
+    :cond_1b
+    move v11, v7
 
     :try_start_f
-    new-instance v11, Landroid/content/pm/UserInfo;
+    new-instance v8, Landroid/content/pm/UserInfo;
     :try_end_f
     .catchall {:try_start_f .. :try_end_f} :catchall_13
 
-    const/16 v26, 0x0
-
-    move-object v7, v11
-
-    move/from16 p3, v8
-
-    move v8, v14
+    const/16 v23, 0x0
 
-    move-object/from16 v27, v10
+    move-object v7, v8
 
-    move-object/from16 v10, v26
+    move-object/from16 v24, v8
 
-    move-object/from16 v28, v11
+    move v8, v13
 
-    move/from16 v11, p3
+    move-object/from16 v25, v10
 
-    move/from16 v26, v12
+    move-object/from16 v10, v23
 
-    const/4 v4, 0x0
+    move/from16 v23, v12
 
     move-object v12, v0
 
@@ -5664,12 +5608,12 @@
     :try_end_10
     .catchall {:try_start_10 .. :try_end_10} :catchall_12
 
-    if-eqz v16, :cond_21
+    if-eqz v16, :cond_1c
 
-    move-object/from16 v7, v28
+    move-object/from16 v7, v24
 
     :try_start_11
-    iput v14, v7, Landroid/content/pm/UserInfo;->serialNumber:I
+    iput v13, v7, Landroid/content/pm/UserInfo;->serialNumber:I
 
     iget v8, v1, Lcom/android/server/pm/UserManagerService;->mNextSerialNumber:I
 
@@ -5681,20 +5625,15 @@
     :try_end_11
     .catchall {:try_start_11 .. :try_end_11} :catchall_6
 
-    goto :goto_14
+    goto :goto_10
 
     :catchall_6
     move-exception v0
 
-    move-object v12, v4
-
-    :goto_13
-    const/4 v9, 0x0
-
-    goto/16 :goto_1c
+    goto :goto_e
 
-    :cond_21
-    move-object/from16 v7, v28
+    :cond_1c
+    move-object/from16 v7, v24
 
     :try_start_12
     iget v8, v1, Lcom/android/server/pm/UserManagerService;->mNextSerialNumber:I
@@ -5705,7 +5644,7 @@
 
     iput v8, v7, Landroid/content/pm/UserInfo;->serialNumber:I
 
-    :goto_14
+    :goto_10
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/UserManagerService;->getCreationTime()J
 
     move-result-wide v8
@@ -5728,11 +5667,11 @@
     :try_end_12
     .catchall {:try_start_12 .. :try_end_12} :catchall_12
 
-    if-eqz v8, :cond_22
+    if-eqz v8, :cond_1d
 
     const/16 v8, -0x2710
 
-    if-eq v2, v8, :cond_22
+    if-eq v2, v8, :cond_1d
 
     :try_start_13
     invoke-virtual {v1, v2, v0}, Lcom/android/server/pm/UserManagerService;->getFreeProfileBadgeLU(ILjava/lang/String;)I
@@ -5743,7 +5682,7 @@
     :try_end_13
     .catchall {:try_start_13 .. :try_end_13} :catchall_6
 
-    :cond_22
+    :cond_1d
     :try_start_14
     new-instance v12, Lcom/android/server/pm/UserManagerService$UserData;
 
@@ -5766,9 +5705,9 @@
 
     iget-object v8, v1, Lcom/android/server/pm/UserManagerService;->mUsers:Landroid/util/SparseArray;
 
-    invoke-virtual {v8, v14, v12}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
+    invoke-virtual {v8, v13, v12}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
 
-    monitor-exit v13
+    monitor-exit v4
     :try_end_15
     .catchall {:try_start_15 .. :try_end_15} :catchall_11
 
@@ -5777,71 +5716,71 @@
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/UserManagerService;->writeUserListLP()V
 
-    if-eqz v5, :cond_26
+    if-eqz v5, :cond_21
 
-    if-eqz v16, :cond_24
+    if-eqz v16, :cond_1f
 
-    iget-object v8, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+    iget-object v4, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
-    iget v9, v8, Landroid/content/pm/UserInfo;->profileGroupId:I
+    iget v8, v4, Landroid/content/pm/UserInfo;->profileGroupId:I
 
-    const/16 v10, -0x2710
+    const/16 v9, -0x2710
 
-    if-ne v9, v10, :cond_23
+    if-ne v8, v9, :cond_1e
 
-    iget v9, v8, Landroid/content/pm/UserInfo;->id:I
+    iget v8, v4, Landroid/content/pm/UserInfo;->id:I
 
-    iput v9, v8, Landroid/content/pm/UserInfo;->profileGroupId:I
+    iput v8, v4, Landroid/content/pm/UserInfo;->profileGroupId:I
 
     invoke-virtual {v1, v5}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_23
-    iget-object v5, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+    :cond_1e
+    iget-object v4, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
-    iget v5, v5, Landroid/content/pm/UserInfo;->profileGroupId:I
+    iget v4, v4, Landroid/content/pm/UserInfo;->profileGroupId:I
 
-    iput v5, v7, Landroid/content/pm/UserInfo;->profileGroupId:I
+    iput v4, v7, Landroid/content/pm/UserInfo;->profileGroupId:I
 
-    goto :goto_15
+    goto :goto_11
 
-    :cond_24
-    if-eqz v18, :cond_26
+    :cond_1f
+    if-eqz v18, :cond_21
 
-    iget-object v8, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+    iget-object v4, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
-    iget v9, v8, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
+    iget v8, v4, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
 
-    const/16 v10, -0x2710
+    const/16 v9, -0x2710
 
-    if-ne v9, v10, :cond_25
+    if-ne v8, v9, :cond_20
 
-    iget v9, v8, Landroid/content/pm/UserInfo;->id:I
+    iget v8, v4, Landroid/content/pm/UserInfo;->id:I
 
-    iput v9, v8, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
+    iput v8, v4, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
 
     invoke-virtual {v1, v5}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_25
-    iget-object v5, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
+    :cond_20
+    iget-object v4, v5, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
 
-    iget v5, v5, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
+    iget v4, v4, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
 
-    iput v5, v7, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
+    iput v4, v7, Landroid/content/pm/UserInfo;->restrictedProfileParentId:I
 
-    :cond_26
-    :goto_15
-    monitor-exit v27
+    :cond_21
+    :goto_11
+    monitor-exit v25
     :try_end_16
     .catchall {:try_start_16 .. :try_end_16} :catchall_10
 
-    if-eqz v22, :cond_2a
+    if-eqz v14, :cond_25
 
     :try_start_17
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/UserManagerService;->verifyDeviceIntegrity()Z
 
-    move-result v5
+    move-result v4
 
-    if-nez v5, :cond_28
+    if-nez v4, :cond_23
 
     const-string v0, "UserManagerService"
 
@@ -5851,22 +5790,26 @@
     :try_end_17
     .catchall {:try_start_17 .. :try_end_17} :catchall_7
 
-    if-eqz v15, :cond_27
+    if-eqz v15, :cond_22
 
     invoke-virtual {v1, v12}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_27
-    invoke-static/range {v23 .. v24}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_22
+    invoke-static/range {v21 .. v22}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return-object v4
+    const/4 v5, 0x0
+
+    return-object v5
+
+    :cond_23
+    const/4 v5, 0x0
 
-    :cond_28
     :try_start_18
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/UserManagerService;->isDeviceRootKeyInstalled()Z
 
-    move-result v5
+    move-result v4
 
-    if-nez v5, :cond_2a
+    if-nez v4, :cond_26
 
     const-string v0, "UserManagerService"
 
@@ -5876,53 +5819,54 @@
     :try_end_18
     .catchall {:try_start_18 .. :try_end_18} :catchall_7
 
-    if-eqz v15, :cond_29
+    if-eqz v15, :cond_24
 
     invoke-virtual {v1, v12}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_29
-    invoke-static/range {v23 .. v24}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_24
+    invoke-static/range {v21 .. v22}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
-    return-object v4
+    return-object v5
 
     :catchall_7
     move-exception v0
 
     const/4 v14, 0x0
 
-    goto/16 :goto_20
+    goto/16 :goto_1c
 
-    :cond_2a
-    if-eqz v16, :cond_2b
+    :cond_25
+    const/4 v5, 0x0
 
-    if-nez v3, :cond_2b
+    :cond_26
+    if-eqz v16, :cond_27
+
+    if-nez v3, :cond_27
 
     :try_start_19
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->sPersonaManager:Lcom/android/server/pm/PersonaManagerService;
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->sPersonaManager:Lcom/android/server/pm/PersonaManagerService;
 
-    invoke-virtual {v5, v14}, Lcom/android/server/pm/PersonaManagerService;->clearStorageForUser(I)V
+    invoke-virtual {v4, v13}, Lcom/android/server/pm/PersonaManagerService;->clearStorageForUser(I)V
     :try_end_19
     .catchall {:try_start_19 .. :try_end_19} :catchall_7
 
-    :cond_2b
+    :cond_27
     :try_start_1a
-    const-string v5, "createUserKey"
-
-    move-object v8, v4
+    const-string v4, "createUserKey"
 
-    move-object/from16 v4, p7
+    move-object/from16 v8, p7
 
-    invoke-virtual {v4, v5}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    invoke-virtual {v8, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
 
     const-class v9, Landroid/os/storage/StorageManager;
 
-    invoke-virtual {v5, v9}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-virtual {v4, v9}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object v5
+    move-result-object v4
 
-    check-cast v5, Landroid/os/storage/StorageManager;
+    check-cast v4, Landroid/os/storage/StorageManager;
 
     iget v9, v7, Landroid/content/pm/UserInfo;->serialNumber:I
 
@@ -5930,246 +5874,173 @@
 
     move-result v10
 
-    invoke-virtual {v5, v14, v9, v10}, Landroid/os/storage/StorageManager;->createUserKey(IIZ)V
+    invoke-virtual {v4, v13, v9, v10}, Landroid/os/storage/StorageManager;->createUserKey(IIZ)V
 
     invoke-virtual/range {p7 .. p7}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
-    const-string/jumbo v5, "prepareUserData"
+    const-string/jumbo v4, "prepareUserData"
 
-    invoke-virtual {v4, v5}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    invoke-virtual {v8, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mUserDataPreparer:Lcom/android/server/pm/UserDataPreparer;
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mUserDataPreparer:Lcom/android/server/pm/UserDataPreparer;
 
     iget v9, v7, Landroid/content/pm/UserInfo;->serialNumber:I
 
     const/4 v10, 0x1
 
-    invoke-virtual {v5, v14, v9, v10}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(III)V
+    invoke-virtual {v4, v13, v9, v10}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(III)V
 
     invoke-virtual/range {p7 .. p7}, Landroid/util/TimingsTraceLog;->traceEnd()V
-    :try_end_1a
-    .catchall {:try_start_1a .. :try_end_1a} :catchall_f
-
-    if-eqz v20, :cond_2f
 
-    if-nez v25, :cond_2c
+    const-string v4, "LSS.createNewUser"
 
-    if-eqz v21, :cond_2f
-
-    :cond_2c
-    :try_start_1b
-    const-string v5, "UserManagerService"
-
-    new-instance v9, Ljava/lang/StringBuilder;
-
-    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v10, "Apply policies and setup dualdar for user "
-
-    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v9, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v9
+    invoke-virtual {v8, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    invoke-static {v5, v9}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v5}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v5
-
-    invoke-virtual {v5, v14}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->handleWorkspaceCreation(I)Z
-
-    move-result v5
-
-    if-nez v5, :cond_2e
-
-    const-string v0, "UserManagerService"
-
-    const-string v2, "DualDAR Setup failed during workspace creation"
-
-    invoke-static {v0, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_1b
-    .catchall {:try_start_1b .. :try_end_1b} :catchall_7
-
-    if-eqz v15, :cond_2d
-
-    invoke-virtual {v1, v12}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
-
-    :cond_2d
-    invoke-static/range {v23 .. v24}, Landroid/os/Binder;->restoreCallingIdentity(J)V
-
-    return-object v8
-
-    :cond_2e
-    :try_start_1c
-    sget-object v5, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_CREATED:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v14, v5}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mLocalService:Lcom/android/server/pm/UserManagerService$LocalService;
-
-    move/from16 v9, p3
-
-    invoke-virtual {v5, v14, v9}, Lcom/android/server/pm/UserManagerService$LocalService;->setDualDarInfo(II)Z
-    :try_end_1c
-    .catchall {:try_start_1c .. :try_end_1c} :catchall_7
-
-    :cond_2f
-    :try_start_1d
-    const-string v5, "LSS.createNewUser"
-
-    invoke-virtual {v4, v5}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
-
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
     iget v9, v7, Landroid/content/pm/UserInfo;->serialNumber:I
 
-    invoke-virtual {v5, v14, v9}, Lcom/android/internal/widget/LockPatternUtils;->createNewUser(II)V
+    invoke-virtual {v4, v13, v9}, Lcom/android/internal/widget/LockPatternUtils;->createNewUser(II)V
 
     invoke-virtual/range {p7 .. p7}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mSystemPackageInstaller:Lcom/android/server/pm/UserSystemPackageInstaller;
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mSystemPackageInstaller:Lcom/android/server/pm/UserSystemPackageInstaller;
 
-    invoke-virtual {v5, v0}, Lcom/android/server/pm/UserSystemPackageInstaller;->getInstallablePackagesForUserType(Ljava/lang/String;)Ljava/util/Set;
+    invoke-virtual {v4, v0}, Lcom/android/server/pm/UserSystemPackageInstaller;->getInstallablePackagesForUserType(Ljava/lang/String;)Ljava/util/Set;
 
     move-result-object v0
 
-    const-string v5, "PM.createNewUser"
+    const-string v4, "PM.createNewUser"
 
-    invoke-virtual {v4, v5}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    invoke-virtual {v8, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
 
     move-object/from16 v9, p6
 
-    invoke-virtual {v5, v14, v0, v9}, Lcom/android/server/pm/PackageManagerService;->createNewUser(ILjava/util/Set;[Ljava/lang/String;)V
+    invoke-virtual {v4, v13, v0, v9}, Lcom/android/server/pm/PackageManagerService;->createNewUser(ILjava/util/Set;[Ljava/lang/String;)V
 
     invoke-virtual/range {p7 .. p7}, Landroid/util/TimingsTraceLog;->traceEnd()V
-    :try_end_1d
-    .catchall {:try_start_1d .. :try_end_1d} :catchall_f
+    :try_end_1a
+    .catchall {:try_start_1a .. :try_end_1a} :catchall_f
 
-    const/4 v5, 0x0
+    const/4 v4, 0x0
 
-    :try_start_1e
-    iput-boolean v5, v7, Landroid/content/pm/UserInfo;->partial:Z
-    :try_end_1e
-    .catchall {:try_start_1e .. :try_end_1e} :catchall_e
+    :try_start_1b
+    iput-boolean v4, v7, Landroid/content/pm/UserInfo;->partial:Z
+    :try_end_1b
+    .catchall {:try_start_1b .. :try_end_1b} :catchall_e
 
-    :try_start_1f
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
+    :try_start_1c
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
 
-    monitor-enter v5
-    :try_end_1f
-    .catchall {:try_start_1f .. :try_end_1f} :catchall_f
+    monitor-enter v4
+    :try_end_1c
+    .catchall {:try_start_1c .. :try_end_1c} :catchall_f
 
-    :try_start_20
+    :try_start_1d
     invoke-virtual {v1, v12}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    monitor-exit v5
-    :try_end_20
-    .catchall {:try_start_20 .. :try_end_20} :catchall_c
+    monitor-exit v4
+    :try_end_1d
+    .catchall {:try_start_1d .. :try_end_1d} :catchall_c
 
-    :try_start_21
+    :try_start_1e
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/UserManagerService;->updateUserIds()V
 
     new-instance v0, Landroid/os/Bundle;
 
     invoke-direct {v0}, Landroid/os/Bundle;-><init>()V
-    :try_end_21
-    .catchall {:try_start_21 .. :try_end_21} :catchall_f
+    :try_end_1e
+    .catchall {:try_start_1e .. :try_end_1e} :catchall_f
 
-    if-eqz v17, :cond_30
+    if-eqz v17, :cond_28
 
-    :try_start_22
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mGuestRestrictions:Landroid/os/Bundle;
+    :try_start_1f
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mGuestRestrictions:Landroid/os/Bundle;
 
-    monitor-enter v5
-    :try_end_22
-    .catchall {:try_start_22 .. :try_end_22} :catchall_7
+    monitor-enter v4
+    :try_end_1f
+    .catchall {:try_start_1f .. :try_end_1f} :catchall_7
 
-    :try_start_23
+    :try_start_20
     iget-object v9, v1, Lcom/android/server/pm/UserManagerService;->mGuestRestrictions:Landroid/os/Bundle;
 
     invoke-virtual {v0, v9}, Landroid/os/Bundle;->putAll(Landroid/os/Bundle;)V
 
-    monitor-exit v5
+    monitor-exit v4
 
-    goto :goto_16
+    goto :goto_12
 
     :catchall_8
     move-exception v0
 
-    monitor-exit v5
-    :try_end_23
-    .catchall {:try_start_23 .. :try_end_23} :catchall_8
+    monitor-exit v4
+    :try_end_20
+    .catchall {:try_start_20 .. :try_end_20} :catchall_8
 
-    :try_start_24
+    :try_start_21
     throw v0
-    :try_end_24
-    .catchall {:try_start_24 .. :try_end_24} :catchall_7
+    :try_end_21
+    .catchall {:try_start_21 .. :try_end_21} :catchall_7
 
-    :cond_30
-    :try_start_25
+    :cond_28
+    :try_start_22
     invoke-virtual {v6, v0}, Lcom/android/server/pm/UserTypeDetails;->addDefaultRestrictionsTo(Landroid/os/Bundle;)V
 
-    :goto_16
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mRestrictionsLock:Ljava/lang/Object;
+    :goto_12
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mRestrictionsLock:Ljava/lang/Object;
 
-    monitor-enter v5
-    :try_end_25
-    .catchall {:try_start_25 .. :try_end_25} :catchall_f
+    monitor-enter v4
+    :try_end_22
+    .catchall {:try_start_22 .. :try_end_22} :catchall_f
 
-    :try_start_26
+    :try_start_23
     iget-object v9, v1, Lcom/android/server/pm/UserManagerService;->mBaseUserRestrictions:Lcom/android/server/pm/RestrictionsSet;
 
-    invoke-virtual {v9, v14, v0}, Lcom/android/server/pm/RestrictionsSet;->updateRestrictions(ILandroid/os/Bundle;)Z
+    invoke-virtual {v9, v13, v0}, Lcom/android/server/pm/RestrictionsSet;->updateRestrictions(ILandroid/os/Bundle;)Z
 
-    monitor-exit v5
-    :try_end_26
-    .catchall {:try_start_26 .. :try_end_26} :catchall_a
+    monitor-exit v4
+    :try_end_23
+    .catchall {:try_start_23 .. :try_end_23} :catchall_a
 
-    :try_start_27
-    new-instance v5, Ljava/lang/StringBuilder;
+    :try_start_24
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
     const-string v9, "PM.onNewUserCreated-"
 
-    invoke-virtual {v5, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v5, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v4, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v5
+    move-result-object v4
 
-    invoke-virtual {v4, v5}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    invoke-virtual {v8, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    iget-object v5, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
-    :try_end_27
-    .catchall {:try_start_27 .. :try_end_27} :catchall_f
+    iget-object v4, v1, Lcom/android/server/pm/UserManagerService;->mPm:Lcom/android/server/pm/PackageManagerService;
+    :try_end_24
+    .catchall {:try_start_24 .. :try_end_24} :catchall_f
 
     const/4 v9, 0x0
 
-    :try_start_28
-    invoke-virtual {v5, v14, v9}, Lcom/android/server/pm/PackageManagerService;->onNewUserCreated(IZ)V
+    :try_start_25
+    invoke-virtual {v4, v13, v9}, Lcom/android/server/pm/PackageManagerService;->onNewUserCreated(IZ)V
 
     invoke-virtual/range {p7 .. p7}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
-    invoke-virtual {v1, v6, v14}, Lcom/android/server/pm/UserManagerService;->applyDefaultUserSettings(Lcom/android/server/pm/UserTypeDetails;I)V
+    invoke-virtual {v1, v6, v13}, Lcom/android/server/pm/UserManagerService;->applyDefaultUserSettings(Lcom/android/server/pm/UserTypeDetails;I)V
 
-    invoke-virtual {v1, v14, v6, v0, v2}, Lcom/android/server/pm/UserManagerService;->setDefaultCrossProfileIntentFilters(ILcom/android/server/pm/UserTypeDetails;Landroid/os/Bundle;I)V
-    :try_end_28
-    .catchall {:try_start_28 .. :try_end_28} :catchall_17
+    invoke-virtual {v1, v13, v6, v0, v2}, Lcom/android/server/pm/UserManagerService;->setDefaultCrossProfileIntentFilters(ILcom/android/server/pm/UserTypeDetails;Landroid/os/Bundle;I)V
+    :try_end_25
+    .catchall {:try_start_25 .. :try_end_25} :catchall_17
 
-    if-eqz v3, :cond_31
+    if-eqz v3, :cond_29
 
-    :try_start_29
+    :try_start_26
     const-string v0, "UserManagerService"
 
     new-instance v2, Ljava/lang/StringBuilder;
@@ -6195,23 +6066,23 @@
     invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;
 
     move-result-object v0
-    :try_end_29
-    .catchall {:try_start_29 .. :try_end_29} :catchall_9
+    :try_end_26
+    .catchall {:try_start_26 .. :try_end_26} :catchall_9
 
-    :try_start_2a
-    invoke-interface {v0, v14}, Landroid/app/IActivityManager;->startUserInBackground(I)Z
-    :try_end_2a
-    .catch Landroid/os/RemoteException; {:try_start_2a .. :try_end_2a} :catch_0
-    .catchall {:try_start_2a .. :try_end_2a} :catchall_9
+    :try_start_27
+    invoke-interface {v0, v13}, Landroid/app/IActivityManager;->startUserInBackground(I)Z
+    :try_end_27
+    .catch Landroid/os/RemoteException; {:try_start_27 .. :try_end_27} :catch_0
+    .catchall {:try_start_27 .. :try_end_27} :catchall_9
 
-    goto :goto_17
+    goto :goto_13
 
     :catch_0
     move-exception v0
 
     move-object v2, v0
 
-    :try_start_2b
+    :try_start_28
     const-string v0, "UserManagerService"
 
     new-instance v3, Ljava/lang/StringBuilder;
@@ -6222,7 +6093,7 @@
 
     invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v3, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v3, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -6230,25 +6101,25 @@
 
     invoke-static {v0, v3, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    goto :goto_17
+    goto :goto_13
 
-    :cond_31
+    :cond_29
     move-object/from16 v0, p8
 
     invoke-virtual {v1, v7, v0}, Lcom/android/server/pm/UserManagerService;->dispatchUserAdded(Landroid/content/pm/UserInfo;Ljava/lang/Object;)V
 
-    :goto_17
-    if-eqz v20, :cond_33
+    :goto_13
+    if-eqz v20, :cond_2b
 
-    if-nez v19, :cond_33
+    if-nez v19, :cond_2b
 
-    if-eqz v26, :cond_32
+    if-eqz v23, :cond_2a
 
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mLockPatternUtils:Lcom/android/internal/widget/LockPatternUtils;
 
     const/4 v2, 0x1
 
-    invoke-virtual {v0, v14, v2, v8}, Lcom/android/internal/widget/LockPatternUtils;->setSeparateProfileChallengeEnabled(IZLcom/android/internal/widget/LockscreenCredential;)V
+    invoke-virtual {v0, v13, v2, v5}, Lcom/android/internal/widget/LockPatternUtils;->setSeparateProfileChallengeEnabled(IZLcom/android/internal/widget/LockscreenCredential;)V
 
     const-string v0, "UserManagerService.DAR"
 
@@ -6260,7 +6131,7 @@
 
     invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v2, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v2, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
     invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
@@ -6268,30 +6139,30 @@
 
     invoke-static {v0, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_32
+    :cond_2a
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->sPersonaManager:Lcom/android/server/pm/PersonaManagerService;
 
     invoke-virtual {v0, v7}, Lcom/android/server/pm/PersonaManagerService;->onNewUserCreated(Landroid/content/pm/UserInfo;)V
-    :try_end_2b
-    .catchall {:try_start_2b .. :try_end_2b} :catchall_9
+    :try_end_28
+    .catchall {:try_start_28 .. :try_end_28} :catchall_9
 
-    :cond_33
-    if-eqz v15, :cond_35
+    :cond_2b
+    if-eqz v15, :cond_2d
 
-    if-eqz v15, :cond_34
+    if-eqz v15, :cond_2c
 
     iget-object v0, v1, Lcom/android/server/pm/UserManagerService;->mMaintenanceModeManager:Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;
 
     invoke-virtual {v0}, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;->finishUserCreation()V
 
-    goto :goto_18
+    goto :goto_14
 
-    :cond_34
+    :cond_2c
     invoke-virtual {v1, v12}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_35
-    :goto_18
-    invoke-static/range {v23 .. v24}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_2d
+    :goto_14
+    invoke-static/range {v21 .. v22}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return-object v7
 
@@ -6300,187 +6171,187 @@
 
     move v14, v15
 
-    goto :goto_20
+    goto :goto_1c
 
     :catchall_a
     move-exception v0
 
     const/4 v9, 0x0
 
-    :goto_19
-    :try_start_2c
-    monitor-exit v5
-    :try_end_2c
-    .catchall {:try_start_2c .. :try_end_2c} :catchall_b
+    :goto_15
+    :try_start_29
+    monitor-exit v4
+    :try_end_29
+    .catchall {:try_start_29 .. :try_end_29} :catchall_b
 
-    :try_start_2d
+    :try_start_2a
     throw v0
-    :try_end_2d
-    .catchall {:try_start_2d .. :try_end_2d} :catchall_17
+    :try_end_2a
+    .catchall {:try_start_2a .. :try_end_2a} :catchall_17
 
     :catchall_b
     move-exception v0
 
-    goto :goto_19
+    goto :goto_15
 
     :catchall_c
     move-exception v0
 
     const/4 v9, 0x0
 
-    :goto_1a
-    :try_start_2e
-    monitor-exit v5
-    :try_end_2e
-    .catchall {:try_start_2e .. :try_end_2e} :catchall_d
+    :goto_16
+    :try_start_2b
+    monitor-exit v4
+    :try_end_2b
+    .catchall {:try_start_2b .. :try_end_2b} :catchall_d
 
-    :try_start_2f
+    :try_start_2c
     throw v0
-    :try_end_2f
-    .catchall {:try_start_2f .. :try_end_2f} :catchall_17
+    :try_end_2c
+    .catchall {:try_start_2c .. :try_end_2c} :catchall_17
 
     :catchall_d
     move-exception v0
 
-    goto :goto_1a
+    goto :goto_16
 
     :catchall_e
     move-exception v0
 
-    move v9, v5
+    move v9, v4
 
-    goto :goto_1f
+    goto :goto_1b
 
     :catchall_f
     move-exception v0
 
     const/4 v9, 0x0
 
-    goto :goto_1f
+    goto :goto_1b
 
     :catchall_10
     move-exception v0
 
-    goto/16 :goto_e
+    goto/16 :goto_a
 
     :catchall_11
     move-exception v0
 
-    goto/16 :goto_13
+    const/4 v9, 0x0
+
+    goto :goto_18
 
     :catchall_12
     move-exception v0
 
-    move-object v8, v4
-
-    goto :goto_1b
+    goto :goto_17
 
     :catchall_13
     move-exception v0
 
-    move-object/from16 v27, v10
+    move-object/from16 v25, v10
 
-    const/4 v8, 0x0
+    :goto_17
+    const/4 v5, 0x0
 
-    :goto_1b
     const/4 v9, 0x0
 
-    move-object v12, v8
+    move-object v12, v5
 
-    :goto_1c
-    :try_start_30
-    monitor-exit v13
-    :try_end_30
-    .catchall {:try_start_30 .. :try_end_30} :catchall_14
+    :goto_18
+    :try_start_2d
+    monitor-exit v4
+    :try_end_2d
+    .catchall {:try_start_2d .. :try_end_2d} :catchall_14
 
-    :try_start_31
+    :try_start_2e
     throw v0
 
     :catchall_14
     move-exception v0
 
-    goto :goto_1c
+    goto :goto_18
 
     :catchall_15
     move-exception v0
 
-    move-object/from16 v27, v10
+    move-object v5, v4
 
-    move-object v8, v13
+    move-object/from16 v25, v10
 
-    goto :goto_1d
+    goto :goto_19
 
     :catchall_16
     move-exception v0
 
-    move-object/from16 v27, v10
+    move-object/from16 v25, v10
 
-    const/4 v8, 0x0
+    const/4 v5, 0x0
 
-    :goto_1d
+    :goto_19
     const/4 v9, 0x0
 
-    move-object v12, v8
+    move-object v12, v5
 
-    :goto_1e
-    monitor-exit v27
-    :try_end_31
-    .catchall {:try_start_31 .. :try_end_31} :catchall_18
+    :goto_1a
+    monitor-exit v25
+    :try_end_2e
+    .catchall {:try_start_2e .. :try_end_2e} :catchall_18
 
-    :try_start_32
+    :try_start_2f
     throw v0
-    :try_end_32
-    .catchall {:try_start_32 .. :try_end_32} :catchall_17
+    :try_end_2f
+    .catchall {:try_start_2f .. :try_end_2f} :catchall_17
 
     :catchall_17
     move-exception v0
 
-    goto :goto_1f
+    goto :goto_1b
 
     :catchall_18
     move-exception v0
 
-    goto :goto_1e
+    goto :goto_1a
 
     :catchall_19
     move-exception v0
 
-    const/4 v8, 0x0
+    const/4 v5, 0x0
 
     const/4 v9, 0x0
 
-    move-object v12, v8
+    move-object v12, v5
 
-    :goto_1f
+    :goto_1b
     move v14, v9
 
-    :goto_20
-    if-eqz v15, :cond_37
+    :goto_1c
+    if-eqz v15, :cond_2f
 
-    if-eqz v14, :cond_36
+    if-eqz v14, :cond_2e
 
     iget-object v1, v1, Lcom/android/server/pm/UserManagerService;->mMaintenanceModeManager:Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;
 
     invoke-virtual {v1}, Lcom/samsung/android/server/pm/mm/MaintenanceModeManager;->finishUserCreation()V
 
-    goto :goto_21
+    goto :goto_1d
 
-    :cond_36
+    :cond_2e
     invoke-virtual {v1, v12}, Lcom/android/server/pm/UserManagerService;->cleanUpMaintenanceModeUserDebris(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    :cond_37
-    :goto_21
-    invoke-static/range {v23 .. v24}, Landroid/os/Binder;->restoreCallingIdentity(J)V
+    :cond_2f
+    :goto_1d
+    invoke-static/range {v21 .. v22}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     throw v0
 
     :catchall_1a
     move-exception v0
 
-    :try_start_33
+    :try_start_30
     monitor-exit v8
-    :try_end_33
-    .catchall {:try_start_33 .. :try_end_33} :catchall_1a
+    :try_end_30
+    .catchall {:try_start_30 .. :try_end_30} :catchall_1a
 
     throw v0
 .end method
@@ -8510,67 +8381,6 @@
     invoke-virtual {p1}, Ljava/io/PrintWriter;->println()V
 
     :cond_10
-    iget v0, v9, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 v1, 0x6000000
-
-    and-int/2addr v1, v0
-
-    if-eqz v1, :cond_13
-
-    const/high16 v1, 0x4000000
-
-    and-int/2addr v0, v1
-
-    if-eqz v0, :cond_11
-
-    const-string v0, " <DUALDAR CUSTOM CRYPTO>"
-
-    invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
-
-    :cond_11
-    iget v0, v9, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 v1, 0x2000000
-
-    and-int/2addr v0, v1
-
-    if-eqz v0, :cond_12
-
-    const-string v0, " <DUALDAR NATIVE CRYPTO>"
-
-    invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
-
-    :cond_12
-    iget v0, v9, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->getCurrentState(I)Lcom/samsung/android/knox/dar/ddar/fsm/State;
-
-    move-result-object v0
-
-    if-eqz v0, :cond_13
-
-    new-instance v1, Ljava/lang/StringBuilder;
-
-    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, " - "
-
-    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Lcom/samsung/android/knox/dar/ddar/fsm/State;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
-
-    :cond_13
     return-void
 
     :catchall_0
@@ -10568,55 +10378,6 @@
     return-object p0
 .end method
 
-.method public final getLegacyDualDarUser()Landroid/content/pm/UserInfo;
-    .locals 3
-
-    const/4 v0, 0x1
-
-    invoke-virtual {p0, v0, v0, v0}, Lcom/android/server/pm/UserManagerService;->getUsersInternal(ZZZ)Ljava/util/List;
-
-    move-result-object p0
-
-    const/4 v0, 0x0
-
-    :goto_0
-    invoke-interface {p0}, Ljava/util/List;->size()I
-
-    move-result v1
-
-    if-ge v0, v1, :cond_1
-
-    invoke-interface {p0, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
-
-    move-result-object v1
-
-    check-cast v1, Landroid/content/pm/UserInfo;
-
-    invoke-virtual {v1}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
-
-    move-result v2
-
-    if-eqz v2, :cond_0
-
-    iget v2, v1, Landroid/content/pm/UserInfo;->flags:I
-
-    and-int/lit16 v2, v2, 0x6000
-
-    if-eqz v2, :cond_0
-
-    return-object v1
-
-    :cond_0
-    add-int/lit8 v0, v0, 0x1
-
-    goto :goto_0
-
-    :cond_1
-    const/4 p0, 0x0
-
-    return-object p0
-.end method
-
 .method public getMainDisplayIdAssignedToUser()I
     .locals 1
 
@@ -16949,147 +16710,36 @@
     iput v2, v1, Landroid/content/pm/UserInfo;->flags:I
 
     invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
-
-    monitor-exit v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_1
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_3
-    monitor-exit v1
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :try_start_4
-    throw p0
-
-    :catchall_1
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_1
-
-    throw p0
-
-    :cond_0
-    :goto_0
-    return-void
-.end method
-
-.method public final migrateDualDarUserInfo(I)V
-    .locals 3
-
-    const-string/jumbo v0, "ro.product.first_api_level"
-
-    const/4 v1, 0x0
-
-    invoke-static {v0, v1}, Landroid/os/SemSystemProperties;->getInt(Ljava/lang/String;I)I
-
-    move-result v0
-
-    const/16 v2, 0x22
-
-    if-lt v0, v2, :cond_0
-
-    return-void
-
-    :cond_0
-    const-string/jumbo v0, "persist.sys.dualdarinfo.update"
-
-    invoke-static {v0, v1}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I
-
-    move-result v0
-
-    if-lez v0, :cond_1
-
-    return-void
-
-    :cond_1
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService;->mUsers:Landroid/util/SparseArray;
-
-    invoke-virtual {p0, p1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
-
-    move-result-object p0
-
-    check-cast p0, Lcom/android/server/pm/UserManagerService$UserData;
-
-    if-nez p0, :cond_2
-
-    const-string p0, "UserManagerService"
-
-    const-string/jumbo p1, "migrate DualDar user info failed! : cannot get UserData"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    monitor-exit v0
-
-    return-void
-
-    :cond_2
-    iget-object p0, p0, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
-
-    iget p1, p0, Landroid/content/pm/UserInfo;->flags:I
-
-    and-int/lit16 v1, p1, 0x2000
-
-    if-eqz v1, :cond_3
-
-    xor-int/lit16 p1, p1, 0x2000
-
-    const/high16 v1, 0x2000000
-
-    or-int/2addr p1, v1
-
-    iput p1, p0, Landroid/content/pm/UserInfo;->flags:I
-
-    goto :goto_0
-
-    :cond_3
-    and-int/lit16 v1, p1, 0x4000
-
-    if-eqz v1, :cond_4
-
-    xor-int/lit16 p1, p1, 0x4000
-
-    const/high16 v1, 0x4000000
-
-    or-int/2addr p1, v1
-
-    iput p1, p0, Landroid/content/pm/UserInfo;->flags:I
-
-    :cond_4
-    :goto_0
+
     monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_1
 
-    const-string/jumbo p0, "persist.sys.dualdarinfo.update"
+    goto :goto_0
 
-    const-string p1, "1"
+    :catchall_0
+    move-exception p0
 
-    invoke-static {p0, p1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V
+    :try_start_3
+    monitor-exit v1
+    :try_end_3
+    .catchall {:try_start_3 .. :try_end_3} :catchall_0
 
-    return-void
+    :try_start_4
+    throw p0
 
-    :catchall_0
+    :catchall_1
     move-exception p0
 
-    :try_start_1
     monitor-exit v0
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_1
 
     throw p0
+
+    :cond_0
+    :goto_0
+    return-void
 .end method
 
 .method public onBeforeStartUser(I)V
@@ -17199,7 +16849,7 @@
 .end method
 
 .method public onBeforeUnlockUser(I)V
-    .locals 6
+    .locals 5
 
     invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->getUserInfo(I)Landroid/content/pm/UserInfo;
 
@@ -17214,128 +16864,75 @@
 
     sget-object v2, Landroid/content/pm/PackagePartitions;->FINGERPRINT:Ljava/lang/String;
 
-    iget-object v3, v0, Landroid/content/pm/UserInfo;->lastLoggedInFingerprint:Ljava/lang/String;
-
-    invoke-virtual {v2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
-
-    move-result v2
-
-    xor-int/lit8 v2, v2, 0x1
-
-    new-instance v3, Lcom/android/server/utils/TimingsTraceAndSlog;
-
-    invoke-direct {v3}, Lcom/android/server/utils/TimingsTraceAndSlog;-><init>()V
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v5, "prepareUserData-"
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    invoke-virtual {v3, v4}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
-
-    iget-object v4, p0, Lcom/android/server/pm/UserManagerService;->mUserDataPreparer:Lcom/android/server/pm/UserDataPreparer;
-
-    const/4 v5, 0x2
-
-    invoke-virtual {v4, p1, v1, v5}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(III)V
-
-    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
-
-    invoke-virtual {v0}, Landroid/content/pm/UserInfo;->isManagedProfile()Z
-
-    move-result v1
-
-    if-eqz v1, :cond_1
-
-    iget v0, v0, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 v1, 0x6000000
-
-    and-int/2addr v0, v1
-
-    if-lez v0, :cond_1
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
+    iget-object v0, v0, Landroid/content/pm/UserInfo;->lastLoggedInFingerprint:Ljava/lang/String;
 
-    const-string v1, "Apply policies on CE storage for dualdar user "
+    invoke-virtual {v2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    move-result v0
 
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    xor-int/lit8 v0, v0, 0x1
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    new-instance v2, Lcom/android/server/utils/TimingsTraceAndSlog;
 
-    move-result-object v0
+    invoke-direct {v2}, Lcom/android/server/utils/TimingsTraceAndSlog;-><init>()V
 
-    const-string v1, "UserManagerService"
+    new-instance v3, Ljava/lang/StringBuilder;
 
-    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V
 
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
+    const-string/jumbo v4, "prepareUserData-"
 
-    invoke-static {v0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
+    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v0
+    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->handleBeforeUnlockUser(I)Z
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result v0
+    move-result-object v3
 
-    if-nez v0, :cond_1
+    invoke-virtual {v2, v3}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
-    const-string v0, "To set DualDAR Policy on CE storage was failed."
+    iget-object v3, p0, Lcom/android/server/pm/UserManagerService;->mUserDataPreparer:Lcom/android/server/pm/UserDataPreparer;
 
-    invoke-static {v1, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+    const/4 v4, 0x2
 
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->removeInvalidEnterpriseUser(I)V
+    invoke-virtual {v3, p1, v1, v4}, Lcom/android/server/pm/UserDataPreparer;->prepareUserData(III)V
 
-    return-void
+    invoke-virtual {v2}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
-    :cond_1
-    const-class v0, Landroid/os/storage/StorageManagerInternal;
+    const-class v1, Landroid/os/storage/StorageManagerInternal;
 
-    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
+    invoke-static {v1}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
 
-    move-result-object v0
+    move-result-object v1
 
-    check-cast v0, Landroid/os/storage/StorageManagerInternal;
+    check-cast v1, Landroid/os/storage/StorageManagerInternal;
 
-    invoke-virtual {v0, p1}, Landroid/os/storage/StorageManagerInternal;->markCeStoragePrepared(I)V
+    invoke-virtual {v1, p1}, Landroid/os/storage/StorageManagerInternal;->markCeStoragePrepared(I)V
 
-    new-instance v0, Ljava/lang/StringBuilder;
+    new-instance v1, Ljava/lang/StringBuilder;
 
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
+    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
 
-    const-string/jumbo v1, "reconcileAppsData-"
+    const-string/jumbo v3, "reconcileAppsData-"
 
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result-object v0
+    move-result-object v1
 
-    invoke-virtual {v3, v0}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
+    invoke-virtual {v2, v1}, Lcom/android/server/utils/TimingsTraceAndSlog;->traceBegin(Ljava/lang/String;)V
 
     invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->getPackageManagerInternal()Landroid/content/pm/PackageManagerInternal;
 
     move-result-object p0
 
-    invoke-virtual {p0, p1, v5, v2}, Landroid/content/pm/PackageManagerInternal;->reconcileAppsData(IIZ)V
+    invoke-virtual {p0, p1, v4, v0}, Landroid/content/pm/PackageManagerInternal;->reconcileAppsData(IIZ)V
 
-    invoke-virtual {v3}, Landroid/util/TimingsTraceLog;->traceEnd()V
+    invoke-virtual {v2}, Landroid/util/TimingsTraceLog;->traceEnd()V
 
     return-void
 .end method
@@ -19309,61 +18906,6 @@
     throw p0
 .end method
 
-.method public final removeInvalidEnterpriseUser(I)V
-    .locals 4
-
-    iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mPackagesLock:Ljava/lang/Object;
-
-    monitor-enter v0
-
-    :try_start_0
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->getUserDataNoChecks(I)Lcom/android/server/pm/UserManagerService$UserData;
-
-    move-result-object v1
-
-    if-nez v1, :cond_0
-
-    const-string p0, "UserManagerService"
-
-    const-string p1, "Failed to remove invalid enterprise user - Couldn\'t get UserData"
-
-    invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-
-    monitor-exit v0
-
-    return-void
-
-    :cond_0
-    iget-object v2, v1, Lcom/android/server/pm/UserManagerService$UserData;->info:Landroid/content/pm/UserInfo;
-
-    const/4 v3, 0x1
-
-    iput-boolean v3, v2, Landroid/content/pm/UserInfo;->partial:Z
-
-    iget v3, v2, Landroid/content/pm/UserInfo;->flags:I
-
-    or-int/lit8 v3, v3, 0x40
-
-    iput v3, v2, Landroid/content/pm/UserInfo;->flags:I
-
-    invoke-virtual {p0, v1}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
-
-    invoke-virtual {p0, p1}, Lcom/android/server/pm/UserManagerService;->removeUser(I)Z
-
-    monitor-exit v0
-
-    return-void
-
-    :catchall_0
-    move-exception p0
-
-    monitor-exit v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    throw p0
-.end method
-
 .method public final removeMaintenanceModeUser(Lcom/android/server/pm/UserManagerService$UserData;)Z
     .locals 1
 
@@ -19661,25 +19203,6 @@
     const/4 v0, 0x0
 
     :goto_1
-    if-eqz v0, :cond_1
-
-    iget v1, v0, Landroid/content/pm/UserInfo;->flags:I
-
-    const/high16 v2, 0x6000000
-
-    and-int/2addr v1, v2
-
-    if-eqz v1, :cond_1
-
-    iget-object v1, p0, Lcom/android/server/pm/UserManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object v1
-
-    invoke-virtual {v1, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onUserRemoved(I)V
-
-    :cond_1
     iget-object v1, p0, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
     monitor-enter v1
@@ -19733,11 +19256,11 @@
 
     move-result v2
 
-    if-eqz v2, :cond_2
+    if-eqz v2, :cond_1
 
     invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->applyUserRestrictionsForAllUsersLR()V
 
-    :cond_2
+    :cond_1
     monitor-exit v1
     :try_end_4
     .catchall {:try_start_4 .. :try_end_4} :catchall_2
@@ -19761,13 +19284,13 @@
 
     invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->updateUserIds()V
 
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_3
 
     invoke-virtual {v0}, Landroid/content/pm/UserInfo;->isDualAppProfile()Z
 
     move-result v0
 
-    if-eqz v0, :cond_4
+    if-eqz v0, :cond_3
 
     iget-object v0, p0, Lcom/android/server/pm/UserManagerService;->mUsers:Landroid/util/SparseArray;
 
@@ -19775,12 +19298,12 @@
 
     const/16 v1, 0x63
 
-    if-ne p1, v1, :cond_3
+    if-ne p1, v1, :cond_2
 
     const/16 p1, 0x5f
 
     :goto_2
-    if-gt p1, v1, :cond_3
+    if-gt p1, v1, :cond_2
 
     :try_start_6
     iget-object v2, p0, Lcom/android/server/pm/UserManagerService;->mRemovingUserIds:Landroid/util/SparseBooleanArray;
@@ -19791,7 +19314,7 @@
 
     goto :goto_2
 
-    :cond_3
+    :cond_2
     monitor-exit v0
 
     goto :goto_3
@@ -19805,7 +19328,7 @@
 
     throw p0
 
-    :cond_4
+    :cond_3
     :goto_3
     return-void
 
@@ -25452,62 +24975,25 @@
 
     :cond_18
     :goto_a
-    if-ge p1, v2, :cond_1d
-
-    invoke-static {}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwnerEnabled()Z
-
-    move-result p1
-
-    if-eqz p1, :cond_19
-
-    invoke-virtual {p0, v4}, Lcom/android/server/pm/UserManagerService;->migrateDualDarUserInfo(I)V
-
-    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-interface {v0, p1}, Ljava/util/Set;->add(Ljava/lang/Object;)Z
+    if-ge p1, v2, :cond_1b
 
-    goto :goto_b
-
-    :cond_19
-    invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->getLegacyDualDarUser()Landroid/content/pm/UserInfo;
-
-    move-result-object p1
-
-    if-eqz p1, :cond_1a
-
-    iget v5, p1, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-virtual {p0, v5}, Lcom/android/server/pm/UserManagerService;->migrateDualDarUserInfo(I)V
-
-    iget p1, p1, Landroid/content/pm/UserInfo;->id:I
-
-    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;
-
-    move-result-object p1
-
-    invoke-interface {v0, p1}, Ljava/util/Set;->add(Ljava/lang/Object;)Z
-
-    :cond_1a
-    :goto_b
     invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->isHeadlessSystemUserMode()Z
 
     move-result p1
 
-    if-eqz p1, :cond_1b
+    if-eqz p1, :cond_19
 
     invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->isMainUserPermanentAdmin()Z
 
     move-result p1
 
-    if-eqz p1, :cond_1c
+    if-eqz p1, :cond_1a
 
     invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->getEarliestCreatedFullUser()Landroid/content/pm/UserInfo;
 
     move-result-object p1
 
-    if-eqz p1, :cond_1c
+    if-eqz p1, :cond_1a
 
     iget v4, p1, Landroid/content/pm/UserInfo;->flags:I
 
@@ -25523,9 +25009,9 @@
 
     invoke-interface {v0, p1}, Ljava/util/Set;->add(Ljava/lang/Object;)Z
 
-    goto :goto_c
+    goto :goto_b
 
-    :cond_1b
+    :cond_19
     iget-object v5, p0, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
     monitor-enter v5
@@ -25557,11 +25043,11 @@
 
     monitor-exit v5
 
-    :cond_1c
-    :goto_c
+    :cond_1a
+    :goto_b
     move p1, v2
 
-    goto :goto_d
+    goto :goto_c
 
     :catchall_5
     move-exception p0
@@ -25572,13 +25058,13 @@
 
     throw p0
 
-    :cond_1d
-    :goto_d
+    :cond_1b
+    :goto_c
     invoke-static {}, Lcom/android/server/pm/UserTypeFactory;->getUserTypeVersion()I
 
     move-result v4
 
-    if-le v4, p2, :cond_1e
+    if-le v4, p2, :cond_1c
 
     iget-object v5, p0, Lcom/android/server/pm/UserManagerService;->mUsersLock:Ljava/lang/Object;
 
@@ -25595,7 +25081,7 @@
 
     monitor-exit v5
 
-    goto :goto_e
+    goto :goto_d
 
     :catchall_6
     move-exception p0
@@ -25606,9 +25092,9 @@
 
     throw p0
 
-    :cond_1e
-    :goto_e
-    if-ge p1, v2, :cond_1f
+    :cond_1c
+    :goto_d
+    if-ge p1, v2, :cond_1d
 
     const-string p1, "UserManagerService"
 
@@ -25636,10 +25122,10 @@
 
     invoke-static {p1, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_10
+    goto :goto_f
 
-    :cond_1f
-    if-le p1, v2, :cond_20
+    :cond_1d
+    if-le p1, v2, :cond_1e
 
     const-string p2, "UserManagerService"
 
@@ -25671,27 +25157,27 @@
 
     invoke-static {p2, v2}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_20
+    :cond_1e
     iput p1, p0, Lcom/android/server/pm/UserManagerService;->mUserVersion:I
 
     iput v4, p0, Lcom/android/server/pm/UserManagerService;->mUserTypeVersion:I
 
-    if-lt v1, p1, :cond_21
+    if-lt v1, p1, :cond_1f
 
-    if-ge v3, v4, :cond_24
+    if-ge v3, v4, :cond_22
 
-    :cond_21
+    :cond_1f
     invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;
 
     move-result-object p1
 
-    :cond_22
-    :goto_f
+    :cond_20
+    :goto_e
     invoke-interface {p1}, Ljava/util/Iterator;->hasNext()Z
 
     move-result p2
 
-    if-eqz p2, :cond_23
+    if-eqz p2, :cond_21
 
     invoke-interface {p1}, Ljava/util/Iterator;->next()Ljava/lang/Object;
 
@@ -25707,17 +25193,17 @@
 
     move-result-object p2
 
-    if-eqz p2, :cond_22
+    if-eqz p2, :cond_20
 
     invoke-virtual {p0, p2}, Lcom/android/server/pm/UserManagerService;->writeUserLP(Lcom/android/server/pm/UserManagerService$UserData;)V
 
-    goto :goto_f
+    goto :goto_e
 
-    :cond_23
+    :cond_21
     invoke-virtual {p0}, Lcom/android/server/pm/UserManagerService;->writeUserListLP()V
 
-    :cond_24
-    :goto_10
+    :cond_22
+    :goto_f
     return-void
 .end method
 
diff --git a/smali_classes3/com/android/server/trust/TrustManagerService$1.smali b/smali_classes3/com/android/server/trust/TrustManagerService$1.smali
index 0e190597..391388fa 100644
--- a/smali_classes3/com/android/server/trust/TrustManagerService$1.smali
+++ b/smali_classes3/com/android/server/trust/TrustManagerService$1.smali
@@ -1232,96 +1232,6 @@
     move-result-wide v0
 
     :try_start_0
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v2
-
-    const/4 v3, 0x0
-
-    if-eqz v2, :cond_0
-
-    iget-object v2, p0, Lcom/android/server/trust/TrustManagerService$1;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    invoke-static {v2}, Lcom/android/server/trust/TrustManagerService;->-$$Nest$fgetmDeviceLockedForUser(Lcom/android/server/trust/TrustManagerService;)Landroid/util/SparseBooleanArray;
-
-    move-result-object v2
-
-    monitor-enter v2
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_2
-
-    :try_start_1
-    iget-object v4, p0, Lcom/android/server/trust/TrustManagerService$1;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    invoke-static {v4}, Lcom/android/server/trust/TrustManagerService;->-$$Nest$fgetmDeviceLockedForUser(Lcom/android/server/trust/TrustManagerService;)Landroid/util/SparseBooleanArray;
-
-    move-result-object v4
-
-    invoke-virtual {v4, p1, p2}, Landroid/util/SparseBooleanArray;->put(IZ)V
-
-    monitor-exit v2
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
-
-    :try_start_2
-    const-string v2, "TrustManagerService"
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v5, "setDeviceLocked for DualDAR DO. locked state : "
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    new-array v3, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, v4, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    iget-object v2, p0, Lcom/android/server/trust/TrustManagerService$1;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    invoke-static {v2, p1, p2}, Lcom/android/server/trust/TrustManagerService;->-$$Nest$mhandleDualDARDeviceLockedChangedForUser(Lcom/android/server/trust/TrustManagerService;IZ)V
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_2
-
-    goto :goto_0
-
-    :catchall_0
-    move-exception p0
-
-    :try_start_3
-    monitor-exit v2
-    :try_end_3
-    .catchall {:try_start_3 .. :try_end_3} :catchall_0
-
-    :try_start_4
-    throw p0
-
-    :cond_0
-    if-nez p1, :cond_1
-
-    if-nez p2, :cond_1
-
-    const-string v2, "TrustManagerService"
-
-    const-string/jumbo v4, "setDeviceLocked false and update DualDAR user state"
-
-    new-array v3, v3, [Ljava/lang/Object;
-
-    invoke-static {v2, v4, v3}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    iget-object v2, p0, Lcom/android/server/trust/TrustManagerService$1;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    invoke-static {v2, p1}, Lcom/android/server/trust/TrustManagerService;->-$$Nest$mupdateDualDARStateAndUnlockIfNeeded(Lcom/android/server/trust/TrustManagerService;I)V
-
-    :cond_1
-    :goto_0
     iget-object v2, p0, Lcom/android/server/trust/TrustManagerService$1;->this$0:Lcom/android/server/trust/TrustManagerService;
 
     invoke-static {v2}, Lcom/android/server/trust/TrustManagerService;->-$$Nest$fgetmLockPatternUtils(Lcom/android/server/trust/TrustManagerService;)Lcom/android/internal/widget/LockPatternUtils;
@@ -1332,7 +1242,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_4
+    if-eqz v2, :cond_2
 
     iget-object v2, p0, Lcom/android/server/trust/TrustManagerService$1;->this$0:Lcom/android/server/trust/TrustManagerService;
 
@@ -1344,7 +1254,7 @@
 
     move-result v2
 
-    if-eqz v2, :cond_4
+    if-eqz v2, :cond_2
 
     iget-object v2, p0, Lcom/android/server/trust/TrustManagerService$1;->this$0:Lcom/android/server/trust/TrustManagerService;
 
@@ -1353,10 +1263,10 @@
     move-result-object v2
 
     monitor-enter v2
-    :try_end_4
-    .catchall {:try_start_4 .. :try_end_4} :catchall_2
+    :try_end_0
+    .catchall {:try_start_0 .. :try_end_0} :catchall_1
 
-    :try_start_5
+    :try_start_1
     iget-object v3, p0, Lcom/android/server/trust/TrustManagerService$1;->this$0:Lcom/android/server/trust/TrustManagerService;
 
     invoke-static {v3}, Lcom/android/server/trust/TrustManagerService;->-$$Nest$fgetmDeviceLockedForUser(Lcom/android/server/trust/TrustManagerService;)Landroid/util/SparseBooleanArray;
@@ -1366,10 +1276,10 @@
     invoke-virtual {v3, p1, p2}, Landroid/util/SparseBooleanArray;->put(IZ)V
 
     monitor-exit v2
-    :try_end_5
-    .catchall {:try_start_5 .. :try_end_5} :catchall_1
+    :try_end_1
+    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
-    :try_start_6
+    :try_start_2
     iget-object v2, p0, Lcom/android/server/trust/TrustManagerService$1;->this$0:Lcom/android/server/trust/TrustManagerService;
 
     invoke-static {v2, p1}, Lcom/android/server/trust/TrustManagerService;->-$$Nest$mgetBiometricSids(Lcom/android/server/trust/TrustManagerService;I)[J
@@ -1379,24 +1289,24 @@
     const/4 v3, 0x0
 
     invoke-static {p2, p1, v3, v2}, Landroid/security/Authorization;->onLockScreenEvent(ZI[B[J)I
-    :try_end_6
-    .catchall {:try_start_6 .. :try_end_6} :catchall_2
+    :try_end_2
+    .catchall {:try_start_2 .. :try_end_2} :catchall_1
 
-    if-eqz p2, :cond_2
+    if-eqz p2, :cond_0
 
-    :try_start_7
+    :try_start_3
     invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;
 
     move-result-object p2
 
     invoke-interface {p2, p1}, Landroid/app/IActivityManager;->notifyLockedProfile(I)V
-    :try_end_7
-    .catch Landroid/os/RemoteException; {:try_start_7 .. :try_end_7} :catch_0
-    .catchall {:try_start_7 .. :try_end_7} :catchall_2
+    :try_end_3
+    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0
+    .catchall {:try_start_3 .. :try_end_3} :catchall_1
 
     :catch_0
-    :cond_2
-    :try_start_8
+    :cond_0
+    :try_start_4
     new-instance p2, Landroid/content/Intent;
 
     const-string v2, "android.intent.action.DEVICE_LOCKED_CHANGED"
@@ -1429,7 +1339,7 @@
 
     move-result-object p2
 
-    if-eqz p2, :cond_3
+    if-eqz p2, :cond_1
 
     iget-object p0, p0, Lcom/android/server/trust/TrustManagerService$1;->this$0:Lcom/android/server/trust/TrustManagerService;
 
@@ -1439,39 +1349,39 @@
 
     invoke-virtual {p0, p1}, Lcom/samsung/android/knox/PersonaManagerInternal;->onDeviceLockedChanged(I)V
 
-    goto :goto_1
+    goto :goto_0
 
-    :cond_3
+    :cond_1
     const-string p0, "TrustManagerService"
 
     const-string/jumbo p1, "onDeviceLockedChanged() - Service is not yet ready..."
 
     invoke-static {p0, p1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_8
-    .catchall {:try_start_8 .. :try_end_8} :catchall_2
+    :try_end_4
+    .catchall {:try_start_4 .. :try_end_4} :catchall_1
 
-    goto :goto_1
+    goto :goto_0
 
-    :catchall_1
+    :catchall_0
     move-exception p0
 
-    :try_start_9
+    :try_start_5
     monitor-exit v2
-    :try_end_9
-    .catchall {:try_start_9 .. :try_end_9} :catchall_1
+    :try_end_5
+    .catchall {:try_start_5 .. :try_end_5} :catchall_0
 
-    :try_start_a
+    :try_start_6
     throw p0
-    :try_end_a
-    .catchall {:try_start_a .. :try_end_a} :catchall_2
+    :try_end_6
+    .catchall {:try_start_6 .. :try_end_6} :catchall_1
 
-    :cond_4
-    :goto_1
+    :cond_2
+    :goto_0
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
 
     return-void
 
-    :catchall_2
+    :catchall_1
     move-exception p0
 
     invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V
diff --git a/smali_classes3/com/android/server/trust/TrustManagerService$2.smali b/smali_classes3/com/android/server/trust/TrustManagerService$2.smali
index f8d425f7..4d43469c 100644
--- a/smali_classes3/com/android/server/trust/TrustManagerService$2.smali
+++ b/smali_classes3/com/android/server/trust/TrustManagerService$2.smali
@@ -268,23 +268,11 @@
     goto :goto_2
 
     :pswitch_a
-    iget-object v0, p0, Lcom/android/server/trust/TrustManagerService$2;->this$0:Lcom/android/server/trust/TrustManagerService;
-
-    iget v1, p1, Landroid/os/Message;->arg1:I
-
-    invoke-virtual {v0, v1}, Lcom/android/server/trust/TrustManagerService;->refreshAgentList(I)V
-
-    iget v0, p1, Landroid/os/Message;->what:I
-
-    const/16 v1, 0xb
-
-    if-ne v0, v1, :cond_6
-
     iget-object p0, p0, Lcom/android/server/trust/TrustManagerService$2;->this$0:Lcom/android/server/trust/TrustManagerService;
 
     iget p1, p1, Landroid/os/Message;->arg1:I
 
-    invoke-static {p0, p1}, Lcom/android/server/trust/TrustManagerService;->-$$Nest$mupdateDualDARStateAndUnlockIfNeeded(Lcom/android/server/trust/TrustManagerService;I)V
+    invoke-virtual {p0, p1}, Lcom/android/server/trust/TrustManagerService;->refreshAgentList(I)V
 
     goto :goto_2
 
@@ -360,6 +348,8 @@
     :goto_2
     return-void
 
+    nop
+
     :pswitch_data_0
     .packed-switch 0x1
         :pswitch_f
diff --git a/smali_classes3/com/android/server/trust/TrustManagerService.smali b/smali_classes3/com/android/server/trust/TrustManagerService.smali
index 1433c12d..044cca3c 100644
--- a/smali_classes3/com/android/server/trust/TrustManagerService.smali
+++ b/smali_classes3/com/android/server/trust/TrustManagerService.smali
@@ -388,14 +388,6 @@
     return-object p0
 .end method
 
-.method public static bridge synthetic -$$Nest$mhandleDualDARDeviceLockedChangedForUser(Lcom/android/server/trust/TrustManagerService;IZ)V
-    .locals 0
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->handleDualDARDeviceLockedChangedForUser(IZ)V
-
-    return-void
-.end method
-
 .method public static bridge synthetic -$$Nest$mhandleScheduleTrustTimeout(Lcom/android/server/trust/TrustManagerService;ZLcom/android/server/trust/TrustManagerService$TimeoutType;)V
     .locals 0
 
@@ -488,14 +480,6 @@
     return-void
 .end method
 
-.method public static bridge synthetic -$$Nest$mupdateDualDARStateAndUnlockIfNeeded(Lcom/android/server/trust/TrustManagerService;I)V
-    .locals 0
-
-    invoke-virtual {p0, p1}, Lcom/android/server/trust/TrustManagerService;->updateDualDARStateAndUnlockIfNeeded(I)V
-
-    return-void
-.end method
-
 .method public static bridge synthetic -$$Nest$mupdateTrust(Lcom/android/server/trust/TrustManagerService;IIZLcom/android/internal/infra/AndroidFuture;)V
     .locals 0
 
@@ -2200,32 +2184,6 @@
     return-void
 .end method
 
-.method public final fetchOuterLayerKey(I)[B
-    .locals 3
-
-    const/4 v0, 0x0
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    const-string v1, "TrustManagerService"
-
-    const-string v2, "fetchOuterLayerKey()"
-
-    invoke-static {v1, v2, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    iget-object p0, p0, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    invoke-virtual {p0, p1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->fetchOuterLayerKey(I)[B
-
-    move-result-object p0
-
-    return-object p0
-.end method
-
 .method public final getBiometricSids(I)[J
     .locals 1
 
@@ -2713,69 +2671,6 @@
     return-object v0
 .end method
 
-.method public final handleDualDARDeviceLockedChangedForUser(IZ)V
-    .locals 3
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isDualDAREnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_1
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "handleDualDARDeviceLockedChangedForUser() - userId : "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string v1, ", locked : "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    new-array v1, v1, [Ljava/lang/Object;
-
-    const-string v2, "TrustManagerService"
-
-    invoke-static {v2, v0, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    if-nez p1, :cond_1
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARUser()I
-
-    move-result v0
-
-    const/4 v1, -0x1
-
-    if-eq v0, v1, :cond_1
-
-    if-eqz p2, :cond_0
-
-    sget-object p0, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_LOCKED:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v0, p0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    goto :goto_0
-
-    :cond_0
-    invoke-virtual {p0, p1}, Lcom/android/server/trust/TrustManagerService;->updateDualDARStateAndUnlockIfNeeded(I)V
-
-    :cond_1
-    :goto_0
-    return-void
-.end method
-
 .method public final handleScheduleTrustTimeout(ZLcom/android/server/trust/TrustManagerService$TimeoutType;)V
     .locals 2
 
@@ -3580,88 +3475,6 @@
     return-void
 .end method
 
-.method public final onPassword2Auth(I)Lcom/android/internal/widget/VerifyCredentialResponse;
-    .locals 4
-
-    const/4 v0, 0x0
-
-    new-array v1, v0, [Ljava/lang/Object;
-
-    const-string v2, "TrustManagerService"
-
-    const-string/jumbo v3, "onPassword2Auth()"
-
-    invoke-static {v2, v3, v1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncryptionEnabled(I)Z
-
-    move-result v1
-
-    if-nez v1, :cond_0
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v1, "User is not DualDAR eligible. so no need to verify DualDAR Passwords"
-
-    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v0, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_0
-    iget-object p0, p0, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {p0}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDARController;
-
-    move-result-object p0
-
-    const/4 v1, 0x0
-
-    invoke-virtual {p0, p1, v1}, Lcom/samsung/android/knox/dar/ddar/DualDARController;->onPassword2Auth(I[B)Z
-
-    move-result p0
-
-    if-nez p0, :cond_1
-
-    const-string p0, "Authentication Failure by dual dar client"
-
-    new-array p1, v0, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->ERROR:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-
-    :cond_1
-    const-string/jumbo p0, "onPassword2Auth completed successfully"
-
-    new-array v0, v0, [Ljava/lang/Object;
-
-    invoke-static {v2, p0, v0}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    sget-object p0, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DDAR_WORKSPACE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {p1, p0}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    sget-object p0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    return-object p0
-.end method
-
 .method public onStart()V
     .locals 2
 
@@ -5456,30 +5269,11 @@
 
     if-nez v1, :cond_2
 
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_2
-
-    const-string v0, "TrustManagerService"
-
-    const-string/jumbo v3, "setDeviceLockedForUser - locked state is not changed though"
-
-    invoke-static {v0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
-
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->handleDualDARDeviceLockedChangedForUser(IZ)V
-
-    :cond_2
-    if-nez v1, :cond_3
-
     iget-boolean v0, p0, Lcom/android/server/trust/TrustManagerService;->mIsUnlockedByFP:Z
 
-    if-eqz v0, :cond_5
-
-    :cond_3
-    invoke-virtual {p0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->handleDualDARDeviceLockedChangedForUser(IZ)V
+    if-eqz v0, :cond_4
 
+    :cond_2
     invoke-virtual {p0, p1, p2}, Lcom/android/server/trust/TrustManagerService;->dispatchDeviceLocked(IZ)V
 
     invoke-virtual {p0, p1}, Lcom/android/server/trust/TrustManagerService;->getBiometricSids(I)[J
@@ -5499,7 +5293,7 @@
     array-length v0, p1
 
     :goto_1
-    if-ge v2, v0, :cond_5
+    if-ge v2, v0, :cond_4
 
     aget v3, p1, v2
 
@@ -5509,7 +5303,7 @@
 
     move-result v4
 
-    if-eqz v4, :cond_4
+    if-eqz v4, :cond_3
 
     invoke-virtual {p0, v3}, Lcom/android/server/trust/TrustManagerService;->getBiometricSids(I)[J
 
@@ -5517,12 +5311,12 @@
 
     invoke-static {p2, v3, v1, v4}, Landroid/security/Authorization;->onLockScreenEvent(ZI[B[J)I
 
-    :cond_4
+    :cond_3
     add-int/lit8 v2, v2, 0x1
 
     goto :goto_1
 
-    :cond_5
+    :cond_4
     return-void
 
     :catchall_0
@@ -5795,330 +5589,6 @@
     return-void
 .end method
 
-.method public final updateDualDARStateAndUnlockIfNeeded(I)V
-    .locals 6
-
-    new-instance v0, Ljava/lang/StringBuilder;
-
-    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string/jumbo v1, "updateDualDARStateAndUnlockIfNeeded() - userId : "
-
-    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v0
-
-    const/4 v1, 0x0
-
-    new-array v2, v1, [Ljava/lang/Object;
-
-    const-string v3, "TrustManagerService"
-
-    invoke-static {v3, v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->isDualDAREnabled()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_7
-
-    const-class v0, Lcom/android/server/SystemServiceManager;
-
-    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;
-
-    move-result-object v0
-
-    check-cast v0, Lcom/android/server/SystemServiceManager;
-
-    invoke-virtual {v0}, Lcom/android/server/SystemServiceManager;->isBootCompleted()Z
-
-    move-result v0
-
-    if-eqz v0, :cond_0
-
-    invoke-static {p1}, Landroid/os/storage/StorageManager;->isUserKeyUnlocked(I)Z
-
-    move-result v0
-
-    if-nez v0, :cond_1
-
-    :cond_0
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v0
-
-    if-eqz v0, :cond_7
-
-    const-string v0, "Update dualdar state early for DO"
-
-    new-array v2, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, v0, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    :cond_1
-    if-nez p1, :cond_7
-
-    invoke-static {}, Lcom/android/server/pm/PersonaServiceHelper;->getDualDARUser()I
-
-    move-result v0
-
-    const/4 v2, -0x1
-
-    if-eq v0, v2, :cond_7
-
-    sget-object v2, Lcom/samsung/android/knox/dar/ddar/fsm/Event;->DEVICE_AUTH_SUCCESS:Lcom/samsung/android/knox/dar/ddar/fsm/Event;
-
-    invoke-static {v0, v2}, Lcom/samsung/android/knox/dar/ddar/fsm/StateMachine;->processEvent(ILcom/samsung/android/knox/dar/ddar/fsm/Event;)Z
-
-    iget-object v2, p0, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
-
-    const-string v4, "keyguard"
-
-    invoke-virtual {v2, v4}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
-
-    move-result-object v2
-
-    check-cast v2, Landroid/app/KeyguardManager;
-
-    new-instance v4, Ljava/lang/StringBuilder;
-
-    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v5, "Trying to unlock DualDAR user (TMS), isSecure? "
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v2, v0}, Landroid/app/KeyguardManager;->isDeviceSecure(I)Z
-
-    move-result v5
-
-    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;
-
-    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object v4
-
-    new-array v5, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-static {p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isOnDeviceOwner(I)Z
-
-    move-result v4
-
-    if-eqz v4, :cond_5
-
-    const-string v4, "DualDAR on DO is enabled"
-
-    new-array v5, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, v4, v5}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-virtual {v2, v0}, Landroid/app/KeyguardManager;->isDeviceSecure(I)Z
-
-    move-result v2
-
-    if-nez v2, :cond_4
-
-    iget-object v2, p0, Lcom/android/server/trust/TrustManagerService;->mContext:Landroid/content/Context;
-
-    invoke-static {v2}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->getInstance(Landroid/content/Context;)Lcom/samsung/android/knox/dar/ddar/DualDarManager;
-
-    move-result-object v2
-
-    invoke-virtual {v2, p1}, Lcom/samsung/android/knox/dar/ddar/DualDarManager;->isInnerLayerUnlocked(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_2
-
-    invoke-static {p1}, Lcom/samsung/android/knox/SemPersonaManager;->isDarDualEncrypted(I)Z
-
-    move-result v2
-
-    if-eqz v2, :cond_4
-
-    :cond_2
-    invoke-virtual {p0, v0}, Lcom/android/server/trust/TrustManagerService;->onPassword2Auth(I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p0
-
-    sget-object v0, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    if-ne p0, v0, :cond_3
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v0, "Inner layer for user "
-
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    const-string p1, " authenticated"
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    goto :goto_0
-
-    :cond_3
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v0, "Failed in inner layer authentication for user "
-
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    :cond_4
-    :goto_0
-    return-void
-
-    :cond_5
-    invoke-virtual {v2, v0}, Landroid/app/KeyguardManager;->isDeviceSecure(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_7
-
-    iget-object p1, p0, Lcom/android/server/trust/TrustManagerService;->mUserManager:Landroid/os/UserManager;
-
-    invoke-virtual {p1, v0}, Landroid/os/UserManager;->isUserUnlockingOrUnlocked(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_7
-
-    invoke-virtual {v2, v1}, Landroid/app/KeyguardManager;->isDeviceLocked(I)Z
-
-    move-result p1
-
-    if-nez p1, :cond_7
-
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "Trying to unlock DualDAR user "
-
-    invoke-virtual {p1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v2, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, p1, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-virtual {p0, v0}, Lcom/android/server/trust/TrustManagerService;->onPassword2Auth(I)Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    move-result-object p1
-
-    sget-object v2, Lcom/android/internal/widget/VerifyCredentialResponse;->OK:Lcom/android/internal/widget/VerifyCredentialResponse;
-
-    if-ne p1, v2, :cond_6
-
-    :try_start_0
-    new-instance p1, Ljava/lang/StringBuilder;
-
-    invoke-direct {p1}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string v2, "fetch outer layer key and unlock DualDAR user "
-
-    invoke-virtual {p1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p1
-
-    new-array v2, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, p1, v2}, Lcom/android/server/knox/dar/ddar/DDLog;->d(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    invoke-virtual {p0, v0}, Lcom/android/server/trust/TrustManagerService;->fetchOuterLayerKey(I)[B
-
-    move-result-object p0
-
-    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;
-
-    move-result-object p1
-
-    const/4 v2, 0x0
-
-    invoke-interface {p1, v0, v2, p0, v2}, Landroid/app/IActivityManager;->unlockUser(I[B[BLandroid/os/IProgressListener;)Z
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    goto :goto_1
-
-    :catch_0
-    move-exception p0
-
-    invoke-virtual {p0}, Ljava/lang/Exception;->printStackTrace()V
-
-    new-instance p0, Ljava/lang/StringBuilder;
-
-    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V
-
-    const-string p1, "Failed to unlock DualDAR user !"
-
-    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
-
-    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
-
-    move-result-object p0
-
-    new-array p1, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    goto :goto_1
-
-    :cond_6
-    const-string p0, "Default Authentication Failure by DualDAR client"
-
-    new-array p1, v1, [Ljava/lang/Object;
-
-    invoke-static {v3, p0, p1}, Lcom/android/server/knox/dar/ddar/DDLog;->e(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)I
-
-    nop
-
-    :cond_7
-    :goto_1
-    return-void
-.end method
-
 .method public updateTrust(II)V
     .locals 1
 
-- 
2.48.1

